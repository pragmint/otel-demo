/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","react","@grafana/runtime","rxjs","@grafana/ui","@emotion/css"],(e,t,r,a,n,s)=>(()=>{var o={40:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t)=>new a(e,t).major},110:(e,t,r)=>{"use strict";const a=r(2717),n=r(3274),{ANY:s}=n,o=r(3376),i=r(4774),l=[new n(">=0.0.0-0")],c=[new n(">=0.0.0")],u=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===s){if(1===t.length&&t[0].semver===s)return!0;e=r.includePrerelease?l:c}if(1===t.length&&t[0].semver===s){if(r.includePrerelease)return!0;t=c}const a=new Set;let n,u,h,m,f,v,g;for(const t of e)">"===t.operator||">="===t.operator?n=d(n,t,r):"<"===t.operator||"<="===t.operator?u=p(u,t,r):a.add(t.semver);if(a.size>1)return null;if(n&&u){if(h=i(n.semver,u.semver,r),h>0)return null;if(0===h&&(">="!==n.operator||"<="!==u.operator))return null}for(const e of a){if(n&&!o(e,String(n),r))return null;if(u&&!o(e,String(u),r))return null;for(const a of t)if(!o(e,String(a),r))return!1;return!0}let y=!(!u||r.includePrerelease||!u.semver.prerelease.length)&&u.semver,_=!(!n||r.includePrerelease||!n.semver.prerelease.length)&&n.semver;y&&1===y.prerelease.length&&"<"===u.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,v=v||"<"===e.operator||"<="===e.operator,n)if(_&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===_.major&&e.semver.minor===_.minor&&e.semver.patch===_.patch&&(_=!1),">"===e.operator||">="===e.operator){if(m=d(n,e,r),m===e&&m!==n)return!1}else if(">="===n.operator&&!o(n.semver,String(e),r))return!1;if(u)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(f=p(u,e,r),f===e&&f!==u)return!1}else if("<="===u.operator&&!o(u.semver,String(e),r))return!1;if(!e.operator&&(u||n)&&0!==h)return!1}return!(n&&v&&!u&&0!==h||u&&g&&!n&&0!==h||_||y)},d=(e,t,r)=>{if(!e)return t;const a=i(e.semver,t.semver,r);return a>0?e:a<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,r)=>{if(!e)return t;const a=i(e.semver,t.semver,r);return a<0?e:a>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new a(e,r),t=new a(t,r);let n=!1;e:for(const a of e.set){for(const e of t.set){const t=u(a,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0}},143:(e,t,r)=>{"use strict";const a=r(1680),n=r(7628),s=r(6262),o=r(9525),i=r(7738),l=r(3263),c=r(3344),u=r(9489),d=r(6390),p=r(40),h=r(4084),m=r(8187),f=r(5179),v=r(4774),g=r(5104),y=r(6413),_=r(887),b=r(5513),E=r(3399),w=r(1694),P=r(7665),x=r(3623),S=r(5477),O=r(8327),k=r(2658),C=r(5373),I=r(4768),$=r(3274),A=r(2717),R=r(3376),T=r(205),j=r(7170),L=r(1896),F=r(2259),N=r(724),D=r(2033),M=r(6761),z=r(8432),U=r(1114),q=r(1039),V=r(110);e.exports={parse:i,valid:l,clean:c,inc:u,diff:d,major:p,minor:h,patch:m,prerelease:f,compare:v,rcompare:g,compareLoose:y,compareBuild:_,sort:b,rsort:E,gt:w,lt:P,eq:x,neq:S,gte:O,lte:k,cmp:C,coerce:I,Comparator:$,Range:A,satisfies:R,toComparators:T,maxSatisfying:j,minSatisfying:L,minVersion:F,validRange:N,outside:D,gtr:M,ltr:z,intersects:U,simplifyRange:q,subset:V,SemVer:s,re:a.re,src:a.src,tokens:a.t,SEMVER_SPEC_VERSION:n.SEMVER_SPEC_VERSION,RELEASE_TYPES:n.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},202:e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},205:(e,t,r)=>{"use strict";const a=r(2717);e.exports=(e,t)=>new a(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},252:e=>{"use strict";e.exports=function(e,t,r){var a,n,s=" ",o=e.level,i=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(i||""),p="valid"+o;if("#"==l||"#/"==l)e.isRoot?(a=e.async,n="validate"):(a=!0===e.root.schema.$async,n="root.refVal[0]");else{var h=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===h){var m=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(m),(y=y||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(s+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(s+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var f=s;s=y.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+f+"]); ":s+=" validate.errors = ["+f+"]; return false; ":s+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(s+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,m);e.logger.warn(m),u&&(s+=" if (true) { ")}}else if(h.inline){var v=e.util.copy(e);v.level++;var g="valid"+v.level;v.schema=h.schema,v.schemaPath="",v.errSchemaPath=l,s+=" "+e.validate(v).replace(/validate\.schema/g,h.code)+" ",u&&(s+=" if ("+g+") { ")}else a=!0===h.$async||e.async&&!1!==h.$async,n=h.code}if(n){var y;(y=y||[]).push(s),s="",e.opts.passContext?s+=" "+n+".call(this, ":s+=" "+n+"( ",s+=" "+d+", (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var _=s+=" , "+(i?"data"+(i-1||""):"parentData")+" , "+(i?e.dataPathArr[i]:"parentDataProperty")+", rootData)  ";if(s=y.pop(),a){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(s+=" var "+p+"; "),s+=" try { await "+_+"; ",u&&(s+=" "+p+" = true; "),s+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(s+=" "+p+" = false; "),s+=" } ",u&&(s+=" if ("+p+") { ")}else s+=" if (!"+_+") { if (vErrors === null) vErrors = "+n+".errors; else vErrors = vErrors.concat("+n+".errors); errors = vErrors.length; } ",u&&(s+=" else { ")}return s}},320:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p="valid"+s,h=e.opts.$data&&i&&i.$data;if(h?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i,(i||h)&&!1!==e.opts.uniqueItems){h&&(n+=" var "+p+"; if ("+a+" === false || "+a+" === undefined) "+p+" = true; else if (typeof "+a+" != 'boolean') "+p+" = false; else { "),n+=" var i = "+d+".length , "+p+" = true , j; if (i > 1) { ";var m=e.schema.items&&e.schema.items.type,f=Array.isArray(m);if(!m||"object"==m||"array"==m||f&&(m.indexOf("object")>=0||m.indexOf("array")>=0))n+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+d+"[i], "+d+"[j])) { "+p+" = false; break outer; } } } ";else{n+=" var itemIndices = {}, item; for (;i--;) { var item = "+d+"[i]; ";var v="checkDataType"+(f?"s":"");n+=" if ("+e.util[v](m,"item",e.opts.strictNumbers,!0)+") continue; ",f&&(n+=" if (typeof item == 'string') item = '\"' + item; "),n+=" if (typeof itemIndices[item] == 'number') { "+p+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}n+=" } ",h&&(n+="  }  "),n+=" if (!"+p+") {   ";var g=g||[];g.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+i,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var y=n;n=g.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { ")}else u&&(n+=" if (true) { ");return n}},453:function(e,t){!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var a=t.length-1,n=1;n<a;++n)t[n]=t[n].slice(1,-1);return t[a]=t[a].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function a(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function n(e){return e.toUpperCase()}function s(e){var a="[A-Za-z]",n="[0-9]",s=t(n,"[A-Fa-f]"),o=r(r("%[EFef]"+s+"%"+s+s+"%"+s+s)+"|"+r("%[89A-Fa-f]"+s+"%"+s+s)+"|"+r("%"+s+s)),i="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=t("[\\:\\/\\?\\#\\[\\]\\@]",i),c=e?"[\\uE000-\\uF8FF]":"[]",u=t(a,n,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),d=r(a+t(a,n,"[\\+\\-\\.]")+"*"),p=r(r(o+"|"+t(u,i,"[\\:]"))+"*"),h=(r(r("25[0-5]")+"|"+r("2[0-4]"+n)+"|"+r("1"+n+n)+"|"+r("[1-9]"+n)+"|"+n),r(r("25[0-5]")+"|"+r("2[0-4]"+n)+"|"+r("1"+n+n)+"|"+r("0?[1-9]"+n)+"|0?0?"+n)),m=r(h+"\\."+h+"\\."+h+"\\."+h),f=r(s+"{1,4}"),v=r(r(f+"\\:"+f)+"|"+m),g=r(r(f+"\\:")+"{6}"+v),y=r("\\:\\:"+r(f+"\\:")+"{5}"+v),_=r(r(f)+"?\\:\\:"+r(f+"\\:")+"{4}"+v),b=r(r(r(f+"\\:")+"{0,1}"+f)+"?\\:\\:"+r(f+"\\:")+"{3}"+v),E=r(r(r(f+"\\:")+"{0,2}"+f)+"?\\:\\:"+r(f+"\\:")+"{2}"+v),w=r(r(r(f+"\\:")+"{0,3}"+f)+"?\\:\\:"+f+"\\:"+v),P=r(r(r(f+"\\:")+"{0,4}"+f)+"?\\:\\:"+v),x=r(r(r(f+"\\:")+"{0,5}"+f)+"?\\:\\:"+f),S=r(r(r(f+"\\:")+"{0,6}"+f)+"?\\:\\:"),O=r([g,y,_,b,E,w,P,x,S].join("|")),k=r(r(u+"|"+o)+"+"),C=(r(O+"\\%25"+k),r(O+r("\\%25|\\%(?!"+s+"{2})")+k)),I=r("[vV]"+s+"+\\."+t(u,i,"[\\:]")+"+"),$=r("\\["+r(C+"|"+O+"|"+I)+"\\]"),A=r(r(o+"|"+t(u,i))+"*"),R=r($+"|"+m+"(?!"+A+")|"+A),T=r(n+"*"),j=r(r(p+"@")+"?"+R+r("\\:"+T)+"?"),L=r(o+"|"+t(u,i,"[\\:\\@]")),F=r(L+"*"),N=r(L+"+"),D=r(r(o+"|"+t(u,i,"[\\@]"))+"+"),M=r(r("\\/"+F)+"*"),z=r("\\/"+r(N+M)+"?"),U=r(D+M),q=r(N+M),V="(?!"+L+")",Z=(r(M+"|"+z+"|"+U+"|"+q+"|"+V),r(r(L+"|"+t("[\\/\\?]",c))+"*")),H=r(r(L+"|[\\/\\?]")+"*"),B=r(r("\\/\\/"+j+M)+"|"+z+"|"+q+"|"+V),G=r(d+"\\:"+B+r("\\?"+Z)+"?"+r("\\#"+H)+"?"),K=r(r("\\/\\/"+j+M)+"|"+z+"|"+U+"|"+V),Q=r(K+r("\\?"+Z)+"?"+r("\\#"+H)+"?");return r(G+"|"+Q),r(d+"\\:"+B+r("\\?"+Z)+"?"),r(r("\\/\\/("+r("("+p+")@")+"?("+R+")"+r("\\:("+T+")")+"?)")+"?("+M+"|"+z+"|"+q+"|"+V+")"),r("\\?("+Z+")"),r("\\#("+H+")"),r(r("\\/\\/("+r("("+p+")@")+"?("+R+")"+r("\\:("+T+")")+"?)")+"?("+M+"|"+z+"|"+U+"|"+V+")"),r("\\?("+Z+")"),r("\\#("+H+")"),r(r("\\/\\/("+r("("+p+")@")+"?("+R+")"+r("\\:("+T+")")+"?)")+"?("+M+"|"+z+"|"+q+"|"+V+")"),r("\\?("+Z+")"),r("\\#("+H+")"),r("("+p+")@"),r("\\:("+T+")"),{NOT_SCHEME:new RegExp(t("[^]",a,n,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,i),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,i),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,i),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,i),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,i,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,i,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,i),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,l),"g"),PCT_ENCODED:new RegExp(o,"g"),IPV4ADDRESS:new RegExp("^("+m+")$"),IPV6ADDRESS:new RegExp("^\\[?("+O+")"+r(r("\\%25|\\%(?!"+s+"{2})")+"("+k+")")+"?\\]?$")}}var o=s(!1),i=s(!0),l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,n=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,s=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=2147483647,u=36,d=/^xn--/,p=/[^\0-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,v=String.fromCharCode;function g(e){throw new RangeError(m[e])}function y(e,t){var r=e.split("@"),a="";return r.length>1&&(a=r[0]+"@",e=r[1]),a+function(e,t){for(var r=[],a=e.length;a--;)r[a]=t(e[a]);return r}((e=e.replace(h,".")).split("."),t).join(".")}function _(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var s=e.charCodeAt(r++);56320==(64512&s)?t.push(((1023&n)<<10)+(1023&s)+65536):(t.push(n),r--)}else t.push(n)}return t}var b=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:u},E=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},w=function(e,t,r){var a=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;a+=u)e=f(e/35);return f(a+36*e/(e+38))},P=function(e){var t=[],r=e.length,a=0,n=128,s=72,o=e.lastIndexOf("-");o<0&&(o=0);for(var i=0;i<o;++i)e.charCodeAt(i)>=128&&g("not-basic"),t.push(e.charCodeAt(i));for(var l=o>0?o+1:0;l<r;){for(var d=a,p=1,h=u;;h+=u){l>=r&&g("invalid-input");var m=b(e.charCodeAt(l++));(m>=u||m>f((c-a)/p))&&g("overflow"),a+=m*p;var v=h<=s?1:h>=s+26?26:h-s;if(m<v)break;var y=u-v;p>f(c/y)&&g("overflow"),p*=y}var _=t.length+1;s=w(a-d,_,0==d),f(a/_)>c-n&&g("overflow"),n+=f(a/_),a%=_,t.splice(a++,0,n)}return String.fromCodePoint.apply(String,t)},x=function(e){var t=[],r=(e=_(e)).length,a=128,n=0,s=72,o=!0,i=!1,l=void 0;try{for(var d,p=e[Symbol.iterator]();!(o=(d=p.next()).done);o=!0){var h=d.value;h<128&&t.push(v(h))}}catch(e){i=!0,l=e}finally{try{!o&&p.return&&p.return()}finally{if(i)throw l}}var m=t.length,y=m;for(m&&t.push("-");y<r;){var b=c,P=!0,x=!1,S=void 0;try{for(var O,k=e[Symbol.iterator]();!(P=(O=k.next()).done);P=!0){var C=O.value;C>=a&&C<b&&(b=C)}}catch(e){x=!0,S=e}finally{try{!P&&k.return&&k.return()}finally{if(x)throw S}}var I=y+1;b-a>f((c-n)/I)&&g("overflow"),n+=(b-a)*I,a=b;var $=!0,A=!1,R=void 0;try{for(var T,j=e[Symbol.iterator]();!($=(T=j.next()).done);$=!0){var L=T.value;if(L<a&&++n>c&&g("overflow"),L==a){for(var F=n,N=u;;N+=u){var D=N<=s?1:N>=s+26?26:N-s;if(F<D)break;var M=F-D,z=u-D;t.push(v(E(D+M%z,0))),F=f(M/z)}t.push(v(E(F,0))),s=w(n,I,y==m),n=0,++y}}}catch(e){A=!0,R=e}finally{try{!$&&j.return&&j.return()}finally{if(A)throw R}}++n,++a}return t.join("")},S=function(e){return y(e,function(e){return p.test(e)?"xn--"+x(e):e})},O=function(e){return y(e,function(e){return d.test(e)?P(e.slice(4).toLowerCase()):e})},k={};function C(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function I(e){for(var t="",r=0,a=e.length;r<a;){var n=parseInt(e.substr(r+1,2),16);if(n<128)t+=String.fromCharCode(n),r+=3;else if(n>=194&&n<224){if(a-r>=6){var s=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&n)<<6|63&s)}else t+=e.substr(r,6);r+=6}else if(n>=224){if(a-r>=9){var o=parseInt(e.substr(r+4,2),16),i=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&i)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function $(e,t){function r(e){var r=I(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,C).replace(t.PCT_ENCODED,n)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,C).replace(t.PCT_ENCODED,n)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,C).replace(t.PCT_ENCODED,n)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,C).replace(t.PCT_ENCODED,n)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,C).replace(t.PCT_ENCODED,n)),e}function A(e){return e.replace(/^0*(.*)/,"$1")||"0"}function R(e,t){var r=e.match(t.IPV4ADDRESS)||[],a=l(r,2)[1];return a?a.split(".").map(A).join("."):e}function T(e,t){var r=e.match(t.IPV6ADDRESS)||[],a=l(r,3),n=a[1],s=a[2];if(n){for(var o=n.toLowerCase().split("::").reverse(),i=l(o,2),c=i[0],u=i[1],d=u?u.split(":").map(A):[],p=c.split(":").map(A),h=t.IPV4ADDRESS.test(p[p.length-1]),m=h?7:8,f=p.length-m,v=Array(m),g=0;g<m;++g)v[g]=d[g]||p[f+g]||"";h&&(v[m-1]=R(v[m-1],t));var y=v.reduce(function(e,t,r){if(!t||"0"===t){var a=e[e.length-1];a&&a.index+a.length===r?a.length++:e.push({index:r,length:1})}return e},[]).sort(function(e,t){return t.length-e.length})[0],_=void 0;if(y&&y.length>1){var b=v.slice(0,y.index),E=v.slice(y.index+y.length);_=b.join(":")+"::"+E.join(":")}else _=v.join(":");return s&&(_+="%"+s),_}return e}var j=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,L=void 0==="".match(/(){0}/)[1];function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},a=!1!==t.iri?i:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var n=e.match(j);if(n){L?(r.scheme=n[1],r.userinfo=n[3],r.host=n[4],r.port=parseInt(n[5],10),r.path=n[6]||"",r.query=n[7],r.fragment=n[8],isNaN(r.port)&&(r.port=n[5])):(r.scheme=n[1]||void 0,r.userinfo=-1!==e.indexOf("@")?n[3]:void 0,r.host=-1!==e.indexOf("//")?n[4]:void 0,r.port=parseInt(n[5],10),r.path=n[6]||"",r.query=-1!==e.indexOf("?")?n[7]:void 0,r.fragment=-1!==e.indexOf("#")?n[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?n[4]:void 0)),r.host&&(r.host=T(R(r.host,a),a)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var s=k[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||s&&s.unicodeSupport)$(r,a);else{if(r.host&&(t.domainHost||s&&s.domainHost))try{r.host=S(r.host.replace(a.PCT_ENCODED,I).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}$(r,o)}s&&s.parse&&s.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}var N=/^\.\.?\//,D=/^\/\.(\/|$)/,M=/^\/\.\.(\/|$)/,z=/^\/?(?:.|\n)*?(?=\/|$)/;function U(e){for(var t=[];e.length;)if(e.match(N))e=e.replace(N,"");else if(e.match(D))e=e.replace(D,"/");else if(e.match(M))e=e.replace(M,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(z);if(!r)throw new Error("Unexpected dot segment condition");var a=r[0];e=e.slice(a.length),t.push(a)}return t.join("")}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?i:o,a=[],n=k[(t.scheme||e.scheme||"").toLowerCase()];if(n&&n.serialize&&n.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||n&&n.domainHost)try{e.host=t.iri?O(e.host):S(e.host.replace(r.PCT_ENCODED,I).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}$(e,r),"suffix"!==t.reference&&e.scheme&&(a.push(e.scheme),a.push(":"));var s=function(e,t){var r=!1!==t.iri?i:o,a=[];return void 0!==e.userinfo&&(a.push(e.userinfo),a.push("@")),void 0!==e.host&&a.push(T(R(String(e.host),r),r).replace(r.IPV6ADDRESS,function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"})),"number"!=typeof e.port&&"string"!=typeof e.port||(a.push(":"),a.push(String(e.port))),a.length?a.join(""):void 0}(e,t);if(void 0!==s&&("suffix"!==t.reference&&a.push("//"),a.push(s),e.path&&"/"!==e.path.charAt(0)&&a.push("/")),void 0!==e.path){var l=e.path;t.absolutePath||n&&n.absolutePath||(l=U(l)),void 0===s&&(l=l.replace(/^\/\//,"/%2F")),a.push(l)}return void 0!==e.query&&(a.push("?"),a.push(e.query)),void 0!==e.fragment&&(a.push("#"),a.push(e.fragment)),a.join("")}function V(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={};return arguments[3]||(e=F(q(e,r),r),t=F(q(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(a.scheme=t.scheme,a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=U(t.path||""),a.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=U(t.path||""),a.query=t.query):(t.path?("/"===t.path.charAt(0)?a.path=U(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?a.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:a.path=t.path:a.path="/"+t.path,a.path=U(a.path)),a.query=t.query):(a.path=e.path,void 0!==t.query?a.query=t.query:a.query=e.query),a.userinfo=e.userinfo,a.host=e.host,a.port=e.port),a.scheme=e.scheme),a.fragment=t.fragment,a}function Z(e,t){return e&&e.toString().replace(t&&t.iri?i.PCT_ENCODED:o.PCT_ENCODED,I)}var H={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},B={scheme:"https",domainHost:H.domainHost,parse:H.parse,serialize:H.serialize};function G(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var K={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=G(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(G(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),a=l(r,2),n=a[0],s=a[1];e.path=n&&"/"!==n?n:void 0,e.query=s,e.resourceName=void 0}return e.fragment=void 0,e}},Q={scheme:"wss",domainHost:K.domainHost,parse:K.parse,serialize:K.serialize},W={},J="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",X="[0-9A-Fa-f]",Y=r(r("%[EFef]"+X+"%"+X+X+"%"+X+X)+"|"+r("%[89A-Fa-f]"+X+"%"+X+X)+"|"+r("%"+X+X)),ee=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),te=new RegExp(J,"g"),re=new RegExp(Y,"g"),ae=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',ee),"g"),ne=new RegExp(t("[^]",J,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),se=ne;function oe(e){var t=I(e);return t.match(te)?t:e}var ie={scheme:"mailto",parse:function(e,t){var r=e,a=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var n=!1,s={},o=r.query.split("&"),i=0,l=o.length;i<l;++i){var c=o[i].split("=");switch(c[0]){case"to":for(var u=c[1].split(","),d=0,p=u.length;d<p;++d)a.push(u[d]);break;case"subject":r.subject=Z(c[1],t);break;case"body":r.body=Z(c[1],t);break;default:n=!0,s[Z(c[0],t)]=Z(c[1],t)}}n&&(r.headers=s)}r.query=void 0;for(var h=0,m=a.length;h<m;++h){var f=a[h].split("@");if(f[0]=Z(f[0]),t.unicodeSupport)f[1]=Z(f[1],t).toLowerCase();else try{f[1]=S(Z(f[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}a[h]=f.join("@")}return r},serialize:function(e,t){var r,a=e,s=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(s){for(var o=0,i=s.length;o<i;++o){var l=String(s[o]),c=l.lastIndexOf("@"),u=l.slice(0,c).replace(re,oe).replace(re,n).replace(ae,C),d=l.slice(c+1);try{d=t.iri?O(d):S(Z(d,t).toLowerCase())}catch(e){a.error=a.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}s[o]=u+"@"+d}a.path=s.join(",")}var p=e.headers=e.headers||{};e.subject&&(p.subject=e.subject),e.body&&(p.body=e.body);var h=[];for(var m in p)p[m]!==W[m]&&h.push(m.replace(re,oe).replace(re,n).replace(ne,C)+"="+p[m].replace(re,oe).replace(re,n).replace(se,C));return h.length&&(a.query=h.join("&")),a}},le=/^([^\:]+)\:(.*)/,ce={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(le),a=e;if(r){var n=t.scheme||a.scheme||"urn",s=r[1].toLowerCase(),o=r[2],i=n+":"+(t.nid||s),l=k[i];a.nid=s,a.nss=o,a.path=void 0,l&&(a=l.parse(a,t))}else a.error=a.error||"URN can not be parsed.";return a},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",a=e.nid,n=r+":"+(t.nid||a),s=k[n];s&&(e=s.serialize(e,t));var o=e,i=e.nss;return o.path=(a||t.nid)+":"+i,o}},ue=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,de={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ue)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};k[H.scheme]=H,k[B.scheme]=B,k[K.scheme]=K,k[Q.scheme]=Q,k[ie.scheme]=ie,k[ce.scheme]=ce,k[de.scheme]=de,e.SCHEMES=k,e.pctEncChar=C,e.pctDecChars=I,e.parse=F,e.removeDotSegments=U,e.serialize=q,e.resolveComponents=V,e.resolve=function(e,t,r){var a=function(e,t){var r=e;if(t)for(var a in t)r[a]=t[a];return r}({scheme:"null"},r);return q(V(F(e,a),F(t,a),a,!0),a)},e.normalize=function(e,t){return"string"==typeof e?e=q(F(e,t),t):"object"===a(e)&&(e=F(q(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=q(F(e,r),r):"object"===a(e)&&(e=q(e,r)),"string"==typeof t?t=q(F(t,r),r):"object"===a(t)&&(t=q(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?i.ESCAPE:o.ESCAPE,C)},e.unescapeComponent=Z,Object.defineProperty(e,"__esModule",{value:!0})}(t)},724:(e,t,r)=>{"use strict";const a=r(2717);e.exports=(e,t)=>{try{return new a(e,t).range||"*"}catch(e){return null}}},887:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t,r)=>{const n=new a(e,r),s=new a(t,r);return n.compare(s)||n.compareBuild(s)}},1039:(e,t,r)=>{"use strict";const a=r(3376),n=r(4774);e.exports=(e,t,r)=>{const s=[];let o=null,i=null;const l=e.sort((e,t)=>n(e,t,r));for(const e of l)a(e,t,r)?(i=e,o||(o=e)):(i&&s.push([o,i]),i=null,o=null);o&&s.push([o,null]);const c=[];for(const[e,t]of s)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},1114:(e,t,r)=>{"use strict";const a=r(2717);e.exports=(e,t,r)=>(e=new a(e,r),t=new a(t,r),e.intersects(t,r))},1232:e=>{"use strict";var t=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,r){for(var a=0;a<r.length;a++){e=JSON.parse(JSON.stringify(e));var n,s=r[a].split("/"),o=e;for(n=1;n<s.length;n++)o=o[s[n]];for(n=0;n<t.length;n++){var i=t[n],l=o[i];l&&(o[i]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e}},1269:e=>{"use strict";e.exports=a},1345:(e,t,r)=>{"use strict";var a=/^[a-z_$][a-z0-9_$-]*$/i,n=r(1854),s=r(9827);e.exports={add:function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!a.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var s=t.type;if(Array.isArray(s))for(var o=0;o<s.length;o++)l(e,s[o],t);else l(e,s,t);var i=t.metaSchema;i&&(t.$data&&this._opts.$data&&(i={anyOf:[i,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(i,!0))}function l(e,t,a){for(var s,o=0;o<r.length;o++){var i=r[o];if(i.type==t){s=i;break}}s||(s={type:t,rules:[]},r.push(s));var l={keyword:e,definition:a,custom:!0,code:n,implements:a.implements};s.rules.push(l),r.custom[e]=l}return r.keywords[e]=r.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var a=t[r].rules,n=0;n<a.length;n++)if(a[n].keyword==e){a.splice(n,1);break}return this},validate:function e(t,r){e.errors=null;var a=this._validateKeyword=this._validateKeyword||this.compile(s,!0);if(a(t))return!0;if(e.errors=a.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(a.errors));return!1}}},1386:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},1397:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p="errs__"+n,h=e.util.copy(e),m="";h.level++;var f="valid"+h.level,v="i"+n,g=h.dataLevel=e.dataLevel+1,y="data"+g,_=e.baseId;if(a+="var "+p+" = errors;var "+d+";",Array.isArray(o)){var b=e.schema.additionalItems;if(!1===b){a+=" "+d+" = "+u+".length <= "+o.length+"; ";var E=l;l=e.errSchemaPath+"/additionalItems",a+="  if (!"+d+") {   ";var w=w||[];w.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+o.length+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var P=a;a=w.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+P+"]); ":a+=" validate.errors = ["+P+"]; return false; ":a+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",l=E,c&&(m+="}",a+=" else { ")}var x=o;if(x)for(var S,O=-1,k=x.length-1;O<k;)if(S=x[O+=1],e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0||!1===S:e.util.schemaHasRules(S,e.RULES.all)){a+=" "+f+" = true; if ("+u+".length > "+O+") { ";var C=u+"["+O+"]";h.schema=S,h.schemaPath=i+"["+O+"]",h.errSchemaPath=l+"/"+O,h.errorPath=e.util.getPathExpr(e.errorPath,O,e.opts.jsonPointers,!0),h.dataPathArr[g]=O;var I=e.validate(h);h.baseId=_,e.util.varOccurences(I,y)<2?a+=" "+e.util.varReplace(I,y,C)+" ":a+=" var "+y+" = "+C+"; "+I+" ",a+=" }  ",c&&(a+=" if ("+f+") { ",m+="}")}"object"==typeof b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0||!1===b:e.util.schemaHasRules(b,e.RULES.all))&&(h.schema=b,h.schemaPath=e.schemaPath+".additionalItems",h.errSchemaPath=e.errSchemaPath+"/additionalItems",a+=" "+f+" = true; if ("+u+".length > "+o.length+") {  for (var "+v+" = "+o.length+"; "+v+" < "+u+".length; "+v+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0),C=u+"["+v+"]",h.dataPathArr[g]=v,I=e.validate(h),h.baseId=_,e.util.varOccurences(I,y)<2?a+=" "+e.util.varReplace(I,y,C)+" ":a+=" var "+y+" = "+C+"; "+I+" ",c&&(a+=" if (!"+f+") break; "),a+=" } }  ",c&&(a+=" if ("+f+") { ",m+="}"))}else(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0||!1===o:e.util.schemaHasRules(o,e.RULES.all))&&(h.schema=o,h.schemaPath=i,h.errSchemaPath=l,a+="  for (var "+v+" = 0; "+v+" < "+u+".length; "+v+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0),C=u+"["+v+"]",h.dataPathArr[g]=v,I=e.validate(h),h.baseId=_,e.util.varOccurences(I,y)<2?a+=" "+e.util.varReplace(I,y,C)+" ":a+=" var "+y+" = "+C+"; "+I+" ",c&&(a+=" if (!"+f+") break; "),a+=" }");return c&&(a+=" "+m+" if ("+p+" == errors) {"),a}},1416:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="errs__"+n,p=e.util.copy(e),h="";p.level++;var m="valid"+p.level,f={},v={},g=e.opts.ownProperties;for(E in o)if("__proto__"!=E){var y=o[E],_=Array.isArray(y)?v:f;_[E]=y}a+="var "+d+" = errors;";var b=e.errorPath;for(var E in a+="var missing"+n+";",v)if((_=v[E]).length){if(a+=" if ( "+u+e.util.getProperty(E)+" !== undefined ",g&&(a+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(E)+"') "),c){a+=" && ( ";var w=_;if(w)for(var P=-1,x=w.length-1;P<x;)$=w[P+=1],P&&(a+=" || "),a+=" ( ( "+(j=u+(T=e.util.getProperty($)))+" === undefined ",g&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes($)+"') "),a+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?$:T)+") ) ";a+=")) {  ";var S="missing"+n,O="' + "+S+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,S,!0):b+" + "+S);var k=k||[];k.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(E)+"', missingProperty: '"+O+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should have ",1==_.length?a+="property "+e.util.escapeQuotes(_[0]):a+="properties "+e.util.escapeQuotes(_.join(", ")),a+=" when property "+e.util.escapeQuotes(E)+" is present' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var C=a;a=k.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+C+"]); ":a+=" validate.errors = ["+C+"]; return false; ":a+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{a+=" ) { ";var I=_;if(I)for(var $,A=-1,R=I.length-1;A<R;){$=I[A+=1];var T=e.util.getProperty($),j=(O=e.util.escapeQuotes($),u+T);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,$,e.opts.jsonPointers)),a+=" if ( "+j+" === undefined ",g&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes($)+"') "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(E)+"', missingProperty: '"+O+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should have ",1==_.length?a+="property "+e.util.escapeQuotes(_[0]):a+="properties "+e.util.escapeQuotes(_.join(", ")),a+=" when property "+e.util.escapeQuotes(E)+" is present' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}a+=" }   ",c&&(h+="}",a+=" else { ")}e.errorPath=b;var L=p.baseId;for(var E in f)y=f[E],(e.opts.strictKeywords?"object"==typeof y&&Object.keys(y).length>0||!1===y:e.util.schemaHasRules(y,e.RULES.all))&&(a+=" "+m+" = true; if ( "+u+e.util.getProperty(E)+" !== undefined ",g&&(a+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(E)+"') "),a+=") { ",p.schema=y,p.schemaPath=i+e.util.getProperty(E),p.errSchemaPath=l+"/"+e.util.escapeFragment(E),a+="  "+e.validate(p)+" ",p.baseId=L,a+=" }  ",c&&(a+=" if ("+m+") { ",h+="}"));return c&&(a+="   "+h+" if ("+d+" == errors) {"),a}},1644:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p=e.opts.$data&&o&&o.$data;p&&(a+=" var schema"+n+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ");var h="schema"+n;if(!p)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var m=[],f=o;if(f)for(var v,g=-1,y=f.length-1;g<y;){v=f[g+=1];var _=e.schema.properties[v];_&&(e.opts.strictKeywords?"object"==typeof _&&Object.keys(_).length>0||!1===_:e.util.schemaHasRules(_,e.RULES.all))||(m[m.length]=v)}}else m=o;if(p||m.length){var b=e.errorPath,E=p||m.length>=e.opts.loopRequired,w=e.opts.ownProperties;if(c)if(a+=" var missing"+n+"; ",E){p||(a+=" var "+h+" = validate.schema"+i+"; ");var P="' + "+(I="schema"+n+"["+(k="i"+n)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,I,e.opts.jsonPointers)),a+=" var "+d+" = true; ",p&&(a+=" if (schema"+n+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+n+")) "+d+" = false; else {"),a+=" for (var "+k+" = 0; "+k+" < "+h+".length; "+k+"++) { "+d+" = "+u+"["+h+"["+k+"]] !== undefined ",w&&(a+=" &&   Object.prototype.hasOwnProperty.call("+u+", "+h+"["+k+"]) "),a+="; if (!"+d+") break; } ",p&&(a+="  }  "),a+="  if (!"+d+") {   ",(S=S||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+P+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+P+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var x=a;a=S.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+x+"]); ":a+=" validate.errors = ["+x+"]; return false; ":a+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { "}else{a+=" if ( ";var S,O=m;if(O)for(var k=-1,C=O.length-1;k<C;)A=O[k+=1],k&&(a+=" || "),a+=" ( ( "+(L=u+(j=e.util.getProperty(A)))+" === undefined ",w&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(A)+"') "),a+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?A:j)+") ) ";a+=") {  ",P="' + "+(I="missing"+n)+" + '",e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,I,!0):b+" + "+I),(S=S||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+P+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+P+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",x=a,a=S.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+x+"]); ":a+=" validate.errors = ["+x+"]; return false; ":a+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { "}else if(E){var I;p||(a+=" var "+h+" = validate.schema"+i+"; "),P="' + "+(I="schema"+n+"["+(k="i"+n)+"]")+" + '",e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,I,e.opts.jsonPointers)),p&&(a+=" if ("+h+" && !Array.isArray("+h+")) {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+P+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+P+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+h+" !== undefined) { "),a+=" for (var "+k+" = 0; "+k+" < "+h+".length; "+k+"++) { if ("+u+"["+h+"["+k+"]] === undefined ",w&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", "+h+"["+k+"]) "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+P+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+P+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",p&&(a+="  }  ")}else{var $=m;if($)for(var A,R=-1,T=$.length-1;R<T;){A=$[R+=1];var j=e.util.getProperty(A),L=(P=e.util.escapeQuotes(A),u+j);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,A,e.opts.jsonPointers)),a+=" if ( "+L+" === undefined ",w&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(A)+"') "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+P+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+P+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=b}else c&&(a+=" if (true) {");return a}},1680:(e,t,r)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=r(7628),o=r(202),i=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],d=t.t={};let p=0;const h="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",s],[h,n]],f=(e,t,r)=>{const a=(e=>{for(const[t,r]of m)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),n=p++;o(e,n,t),d[e]=n,c[n]=t,u[n]=a,i[n]=new RegExp(t,r?"g":void 0),l[n]=new RegExp(a,r?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),f("MAINVERSION",`(${c[d.NUMERICIDENTIFIER]})\\.(${c[d.NUMERICIDENTIFIER]})\\.(${c[d.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${c[d.NUMERICIDENTIFIERLOOSE]})\\.(${c[d.NUMERICIDENTIFIERLOOSE]})\\.(${c[d.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${c[d.NONNUMERICIDENTIFIER]}|${c[d.NUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${c[d.NONNUMERICIDENTIFIER]}|${c[d.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASE",`(?:-(${c[d.PRERELEASEIDENTIFIER]}(?:\\.${c[d.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${c[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[d.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${h}+`),f("BUILD",`(?:\\+(${c[d.BUILDIDENTIFIER]}(?:\\.${c[d.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${c[d.MAINVERSION]}${c[d.PRERELEASE]}?${c[d.BUILD]}?`),f("FULL",`^${c[d.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${c[d.MAINVERSIONLOOSE]}${c[d.PRERELEASELOOSE]}?${c[d.BUILD]}?`),f("LOOSE",`^${c[d.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${c[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${c[d.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${c[d.XRANGEIDENTIFIER]})(?:\\.(${c[d.XRANGEIDENTIFIER]})(?:\\.(${c[d.XRANGEIDENTIFIER]})(?:${c[d.PRERELEASE]})?${c[d.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${c[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[d.XRANGEIDENTIFIERLOOSE]})(?:${c[d.PRERELEASELOOSE]})?${c[d.BUILD]}?)?)?`),f("XRANGE",`^${c[d.GTLT]}\\s*${c[d.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${c[d.GTLT]}\\s*${c[d.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),f("COERCE",`${c[d.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",c[d.COERCEPLAIN]+`(?:${c[d.PRERELEASE]})?`+`(?:${c[d.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",c[d.COERCE],!0),f("COERCERTLFULL",c[d.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${c[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${c[d.LONETILDE]}${c[d.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${c[d.LONETILDE]}${c[d.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${c[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${c[d.LONECARET]}${c[d.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${c[d.LONECARET]}${c[d.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${c[d.GTLT]}\\s*(${c[d.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${c[d.GTLT]}\\s*(${c[d.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${c[d.GTLT]}\\s*(${c[d.LOOSEPLAIN]}|${c[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${c[d.XRANGEPLAIN]})\\s+-\\s+(${c[d.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${c[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[d.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},1694:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>a(e,t,r)>0},1780:e=>{"use strict";var t=e.exports=function(){this._cache={}};t.prototype.put=function(e,t){this._cache[e]=t},t.prototype.get=function(e){return this._cache[e]},t.prototype.del=function(e){delete this._cache[e]},t.prototype.clear=function(){this._cache={}}},1854:e=>{"use strict";e.exports=function(e,t,r){var a,n,s=" ",o=e.level,i=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,p="data"+(i||""),h="valid"+o,m="errs__"+o,f=e.opts.$data&&l&&l.$data;f?(s+=" var schema"+o+" = "+e.util.getData(l.$data,i,e.dataPathArr)+"; ",n="schema"+o):n=l;var v,g,y,_,b,E=this,w="definition"+o,P=E.definition,x="";if(f&&P.$data){b="keywordValidate"+o;var S=P.validateSchema;s+=" var "+w+" = RULES.custom['"+t+"'].definition; var "+b+" = "+w+".validate;"}else{if(!(_=e.useCustomRule(E,l,e.schema,e)))return;n="validate.schema"+c,b=_.code,v=P.compile,g=P.inline,y=P.macro}var O=b+".errors",k="i"+o,C="ruleErr"+o,I=P.async;if(I&&!e.async)throw new Error("async keyword in sync schema");if(g||y||(s+=O+" = null;"),s+="var "+m+" = errors;var "+h+";",f&&P.$data&&(x+="}",s+=" if ("+n+" === undefined) { "+h+" = true; } else { ",S&&(x+="}",s+=" "+h+" = "+w+".validateSchema("+n+"); if ("+h+") { ")),g)P.statements?s+=" "+_.validate+" ":s+=" "+h+" = "+_.validate+"; ";else if(y){var $=e.util.copy(e);x="",$.level++;var A="valid"+$.level;$.schema=_.validate,$.schemaPath="";var R=e.compositeRule;e.compositeRule=$.compositeRule=!0;var T=e.validate($).replace(/validate\.schema/g,b);e.compositeRule=$.compositeRule=R,s+=" "+T}else{(N=N||[]).push(s),s="",s+="  "+b+".call( ",e.opts.passContext?s+="this":s+="self",v||!1===P.schema?s+=" , "+p+" ":s+=" , "+n+" , "+p+" , validate.schema"+e.schemaPath+" ",s+=" , (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var j=i?"data"+(i-1||""):"parentData",L=i?e.dataPathArr[i]:"parentDataProperty",F=s+=" , "+j+" , "+L+" , rootData )  ";s=N.pop(),!1===P.errors?(s+=" "+h+" = ",I&&(s+="await "),s+=F+"; "):s+=I?" var "+(O="customErrors"+o)+" = null; try { "+h+" = await "+F+"; } catch (e) { "+h+" = false; if (e instanceof ValidationError) "+O+" = e.errors; else throw e; } ":" "+O+" = null; "+h+" = "+F+"; "}if(P.modifying&&(s+=" if ("+j+") "+p+" = "+j+"["+L+"];"),s+=""+x,P.valid)d&&(s+=" if (true) { ");else{var N;s+=" if ( ",void 0===P.valid?(s+=" !",s+=y?""+A:""+h):s+=" "+!P.valid+" ",s+=") { ",a=E.keyword,(N=N||[]).push(s),s="",(N=N||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(a||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+E.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+E.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),s+=" } "):s+=" {} ";var D=s;s=N.pop(),!e.compositeRule&&d?e.async?s+=" throw new ValidationError(["+D+"]); ":s+=" validate.errors = ["+D+"]; return false; ":s+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var M=s;s=N.pop(),g?P.errors?"full"!=P.errors&&(s+="  for (var "+k+"="+m+"; "+k+"<errors; "+k+"++) { var "+C+" = vErrors["+k+"]; if ("+C+".dataPath === undefined) "+C+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+C+".schemaPath === undefined) { "+C+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(s+=" "+C+".schema = "+n+"; "+C+".data = "+p+"; "),s+=" } "):!1===P.errors?s+=" "+M+" ":(s+=" if ("+m+" == errors) { "+M+" } else {  for (var "+k+"="+m+"; "+k+"<errors; "+k+"++) { var "+C+" = vErrors["+k+"]; if ("+C+".dataPath === undefined) "+C+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+C+".schemaPath === undefined) { "+C+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(s+=" "+C+".schema = "+n+"; "+C+".data = "+p+"; "),s+=" } } "):y?(s+="   var err =   ",!1!==e.createErrors?(s+=" { keyword: '"+(a||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+E.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+E.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; ")):!1===P.errors?s+=" "+M+" ":(s+=" if (Array.isArray("+O+")) { if (vErrors === null) vErrors = "+O+"; else vErrors = vErrors.concat("+O+"); errors = vErrors.length;  for (var "+k+"="+m+"; "+k+"<errors; "+k+"++) { var "+C+" = vErrors["+k+"]; if ("+C+".dataPath === undefined) "+C+".dataPath = (dataPath || '') + "+e.errorPath+";  "+C+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(s+=" "+C+".schema = "+n+"; "+C+".data = "+p+"; "),s+=" } } else { "+M+" } "),s+=" } ",d&&(s+=" else { ")}return s}},1880:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p="errs__"+n,h=e.util.copy(e);h.level++;var m="valid"+h.level,f="i"+n,v=h.dataLevel=e.dataLevel+1,g="data"+v,y=e.baseId,_=e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0||!1===o:e.util.schemaHasRules(o,e.RULES.all);if(a+="var "+p+" = errors;var "+d+";",_){var b=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=o,h.schemaPath=i,h.errSchemaPath=l,a+=" var "+m+" = false; for (var "+f+" = 0; "+f+" < "+u+".length; "+f+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);var E=u+"["+f+"]";h.dataPathArr[v]=f;var w=e.validate(h);h.baseId=y,e.util.varOccurences(w,g)<2?a+=" "+e.util.varReplace(w,g,E)+" ":a+=" var "+g+" = "+E+"; "+w+" ",a+=" if ("+m+") break; }  ",e.compositeRule=h.compositeRule=b,a+="  if (!"+m+") {"}else a+=" if ("+u+".length == 0) {";var P=P||[];P.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should contain a valid item' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var x=a;return a=P.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+x+"]); ":a+=" validate.errors = ["+x+"]; return false; ":a+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { ",_&&(a+="  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; } "),e.opts.allErrors&&(a+=" } "),a}},1896:(e,t,r)=>{"use strict";const a=r(6262),n=r(2717);e.exports=(e,t,r)=>{let s=null,o=null,i=null;try{i=new n(t,r)}catch(e){return null}return e.forEach(e=>{i.test(e)&&(s&&1!==o.compare(e)||(s=e,o=new a(s,r)))}),s}},2007:e=>{"use strict";e.exports=n},2033:(e,t,r)=>{"use strict";const a=r(6262),n=r(3274),{ANY:s}=n,o=r(2717),i=r(3376),l=r(1694),c=r(7665),u=r(2658),d=r(8327);e.exports=(e,t,r,p)=>{let h,m,f,v,g;switch(e=new a(e,p),t=new o(t,p),r){case">":h=l,m=u,f=c,v=">",g=">=";break;case"<":h=c,m=d,f=l,v="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(i(e,t,p))return!1;for(let r=0;r<t.set.length;++r){const a=t.set[r];let o=null,i=null;if(a.forEach(e=>{e.semver===s&&(e=new n(">=0.0.0")),o=o||e,i=i||e,h(e.semver,o.semver,p)?o=e:f(e.semver,i.semver,p)&&(i=e)}),o.operator===v||o.operator===g)return!1;if((!i.operator||i.operator===v)&&m(e,i.semver))return!1;if(i.operator===g&&f(e,i.semver))return!1}return!0}},2259:(e,t,r)=>{"use strict";const a=r(6262),n=r(2717),s=r(1694);e.exports=(e,t)=>{e=new n(e,t);let r=new a("0.0.0");if(e.test(r))return r;if(r=new a("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let o=null;n.forEach(e=>{const t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!s(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),!o||r&&!s(r,o)||(r=o)}return r&&e.test(r)?r:null}},2268:(e,t,r)=>{"use strict";var a=r(8701).MissingRef;e.exports=function e(t,r,n){var s=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(n=r,r=void 0);var o=i(t).then(function(){var e=s._addSchema(t,void 0,r);return e.validate||l(e)});return n&&o.then(function(e){n(null,e)},n),o;function i(t){var r=t.$schema;return r&&!s.getSchema(r)?e.call(s,{$ref:r},!0):Promise.resolve()}function l(e){try{return s._compile(e)}catch(t){if(t instanceof a)return function(t){var a=t.missingSchema;if(c(a))throw new Error("Schema "+a+" is loaded but "+t.missingRef+" cannot be resolved");var n=s._loadingSchemas[a];return n||(n=s._loadingSchemas[a]=s._opts.loadSchema(a)).then(o,o),n.then(function(e){if(!c(a))return i(e).then(function(){c(a)||s.addSchema(e,a,void 0,r)})}).then(function(){return l(e)});function o(){delete s._loadingSchemas[a]}function c(e){return s._refs[e]||s._schemas[e]}}(t);throw t}}}},2303:(e,t,r)=>{"use strict";var a=r(5773),n=r(7290).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=n(t),e.types=n(["number","integer","string","array","object","boolean","null"]),e.forEach(function(r){r.rules=r.rules.map(function(r){var n;if("object"==typeof r){var s=Object.keys(r)[0];n=r[s],r=s,n.forEach(function(r){t.push(r),e.all[r]=!0})}return t.push(r),e.all[r]={keyword:r,code:a[r],implements:n}}),e.all.$comment={keyword:"$comment",code:a.$comment},r.type&&(e.types[r.type]=r)}),e.keywords=n(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},2359:e=>{"use strict";e.exports=function(e){for(var t,r=0,a=e.length,n=0;n<a;)r++,(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<a&&56320==(64512&(t=e.charCodeAt(n)))&&n++;return r}},2424:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p=e.opts.$data&&i&&i.$data;if(p?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i,!p&&"number"!=typeof i)throw new Error(t+" must be number");n+="var division"+s+";if (",p&&(n+=" "+a+" !== undefined && ( typeof "+a+" != 'number' || "),n+=" (division"+s+" = "+d+" / "+a+", ",e.opts.multipleOfPrecision?n+=" Math.abs(Math.round(division"+s+") - division"+s+") > 1e-"+e.opts.multipleOfPrecision+" ":n+=" division"+s+" !== parseInt(division"+s+") ",n+=" ) ",p&&(n+="  )  "),n+=" ) {   ";var h=h||[];h.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be multiple of ",n+=p?"' + "+a:a+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+i,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var m=n;return n=h.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+m+"]); ":n+=" validate.errors = ["+m+"]; return false; ":n+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},2658:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>a(e,t,r)<=0},2717:(e,t,r)=>{"use strict";const a=/\s+/g;class n{constructor(e,t){if(t=o(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof i)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(a," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!g(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&f)|(this.options.loose&&v))+":"+e,r=s.get(t);if(r)return r;const a=this.options.loose,n=a?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];e=e.replace(n,$(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(u[d.COMPARATORTRIM],p),l("comparator trim",e),e=e.replace(u[d.TILDETRIM],h),l("tilde trim",e),e=e.replace(u[d.CARETTRIM],m),l("caret trim",e);let o=e.split(" ").map(e=>b(e,this.options)).join(" ").split(/\s+/).map(e=>I(e,this.options));a&&(o=o.filter(e=>(l("loose invalid filter",e,this.options),!!e.match(u[d.COMPARATORLOOSE])))),l("range list",o);const c=new Map,y=o.map(e=>new i(e,this.options));for(const e of y){if(g(e))return[e];c.set(e.value,e)}c.size>1&&c.has("")&&c.delete("");const _=[...c.values()];return s.set(t,_),_}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>_(r,t)&&e.set.some(e=>_(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(A(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const s=new(r(7540)),o=r(3365),i=r(3274),l=r(202),c=r(6262),{safeRe:u,t:d,comparatorTrimReplace:p,tildeTrimReplace:h,caretTrimReplace:m}=r(1680),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:v}=r(7628),g=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,_=(e,t)=>{let r=!0;const a=e.slice();let n=a.pop();for(;r&&a.length;)r=a.every(e=>n.intersects(e,t)),n=a.pop();return r},b=(e,t)=>(e=e.replace(u[d.BUILD],""),l("comp",e,t),e=x(e,t),l("caret",e),e=w(e,t),l("tildes",e),e=O(e,t),l("xrange",e),e=C(e,t),l("stars",e),e),E=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map(e=>P(e,t)).join(" "),P=(e,t)=>{const r=t.loose?u[d.TILDELOOSE]:u[d.TILDE];return e.replace(r,(t,r,a,n,s)=>{let o;return l("tilde",e,t,r,a,n,s),E(r)?o="":E(a)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:E(n)?o=`>=${r}.${a}.0 <${r}.${+a+1}.0-0`:s?(l("replaceTilde pr",s),o=`>=${r}.${a}.${n}-${s} <${r}.${+a+1}.0-0`):o=`>=${r}.${a}.${n} <${r}.${+a+1}.0-0`,l("tilde return",o),o})},x=(e,t)=>e.trim().split(/\s+/).map(e=>S(e,t)).join(" "),S=(e,t)=>{l("caret",e,t);const r=t.loose?u[d.CARETLOOSE]:u[d.CARET],a=t.includePrerelease?"-0":"";return e.replace(r,(t,r,n,s,o)=>{let i;return l("caret",e,t,r,n,s,o),E(r)?i="":E(n)?i=`>=${r}.0.0${a} <${+r+1}.0.0-0`:E(s)?i="0"===r?`>=${r}.${n}.0${a} <${r}.${+n+1}.0-0`:`>=${r}.${n}.0${a} <${+r+1}.0.0-0`:o?(l("replaceCaret pr",o),i="0"===r?"0"===n?`>=${r}.${n}.${s}-${o} <${r}.${n}.${+s+1}-0`:`>=${r}.${n}.${s}-${o} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${s}-${o} <${+r+1}.0.0-0`):(l("no pr"),i="0"===r?"0"===n?`>=${r}.${n}.${s}${a} <${r}.${n}.${+s+1}-0`:`>=${r}.${n}.${s}${a} <${r}.${+n+1}.0-0`:`>=${r}.${n}.${s} <${+r+1}.0.0-0`),l("caret return",i),i})},O=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map(e=>k(e,t)).join(" ")),k=(e,t)=>{e=e.trim();const r=t.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return e.replace(r,(r,a,n,s,o,i)=>{l("xRange",e,r,a,n,s,o,i);const c=E(n),u=c||E(s),d=u||E(o),p=d;return"="===a&&p&&(a=""),i=t.includePrerelease?"-0":"",c?r=">"===a||"<"===a?"<0.0.0-0":"*":a&&p?(u&&(s=0),o=0,">"===a?(a=">=",u?(n=+n+1,s=0,o=0):(s=+s+1,o=0)):"<="===a&&(a="<",u?n=+n+1:s=+s+1),"<"===a&&(i="-0"),r=`${a+n}.${s}.${o}${i}`):u?r=`>=${n}.0.0${i} <${+n+1}.0.0-0`:d&&(r=`>=${n}.${s}.0${i} <${n}.${+s+1}.0-0`),l("xRange return",r),r})},C=(e,t)=>(l("replaceStars",e,t),e.trim().replace(u[d.STAR],"")),I=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),$=e=>(t,r,a,n,s,o,i,l,c,u,d,p)=>`${r=E(a)?"":E(n)?`>=${a}.0.0${e?"-0":""}`:E(s)?`>=${a}.${n}.0${e?"-0":""}`:o?`>=${r}`:`>=${r}${e?"-0":""}`} ${l=E(c)?"":E(u)?`<${+c+1}.0.0-0`:E(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),A=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(l(e[r].semver),e[r].semver!==i.ANY&&e[r].semver.prerelease.length>0){const a=e[r].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}},2720:(e,t,r)=>{"use strict";var a=r(7290),n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31],o=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,i=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,u=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,d=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,p=/^(?:\/(?:[^~/]|~0|~1)*)*$/,h=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,m=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function f(e){return e="full"==e?"full":"fast",a.copy(f[e])}function v(e){var t=e.match(n);if(!t)return!1;var r=+t[1],a=+t[2],o=+t[3];return a>=1&&a<=12&&o>=1&&o<=(2==a&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:s[a])}function g(e,t){var r=e.match(o);if(!r)return!1;var a=r[1],n=r[2],s=r[3],i=r[5];return(a<=23&&n<=59&&s<=59||23==a&&59==n&&60==s)&&(!t||i)}e.exports=f,f.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:u,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:E,uuid:d,"json-pointer":p,"json-pointer-uri-fragment":h,"relative-json-pointer":m},f.full={date:v,time:g,"date-time":function(e){var t=e.split(y);return 2==t.length&&v(t[0])&&g(t[1],!0)},uri:function(e){return _.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":c,url:u,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:E,uuid:d,"json-pointer":p,"json-pointer-uri-fragment":h,"relative-json-pointer":m};var y=/t|\s/i,_=/\/|:/,b=/[^\\]\\Z/;function E(e){if(b.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},3263:(e,t,r)=>{"use strict";const a=r(7738);e.exports=(e,t)=>{const r=a(e,t);return r?r.version:null}},3274:(e,t,r)=>{"use strict";const a=Symbol("SemVer ANY");class n{static get ANY(){return a}constructor(e,t){if(t=s(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===a?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?o[i.COMPARATORLOOSE]:o[i.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new u(r[2],this.options.loose):this.semver=a}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===a||e===a)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):!((t=s(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=n;const s=r(3365),{safeRe:o,t:i}=r(1680),l=r(5373),c=r(202),u=r(6262),d=r(2717)},3344:(e,t,r)=>{"use strict";const a=r(7738);e.exports=(e,t)=>{const r=a(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},3365:e=>{"use strict";const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},3376:(e,t,r)=>{"use strict";const a=r(2717);e.exports=(e,t,r)=>{try{t=new a(t,r)}catch(e){return!1}return t.test(e)}},3399:(e,t,r)=>{"use strict";const a=r(887);e.exports=(e,t)=>e.sort((e,r)=>a(r,e,t))},3623:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>0===a(e,t,r)},3678:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p=e.opts.$data&&o&&o.$data;p&&(a+=" var schema"+n+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; "),p||(a+=" var schema"+n+" = validate.schema"+i+";"),a+="var "+d+" = equal("+u+", schema"+n+"); if (!"+d+") {   ";var h=h||[];h.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+n+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be equal to constant' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var m=a;return a=h.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" }",c&&(a+=" else { "),a}},3933:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p=e.opts.$data&&i&&i.$data;if(p?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i,!p&&"number"!=typeof i)throw new Error(t+" must be number");var h="maxLength"==t?">":"<";n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),!1===e.opts.unicode?n+=" "+d+".length ":n+=" ucs2length("+d+") ",n+=" "+h+" "+a+") { ";var m=t,f=f||[];f.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(m||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be ",n+="maxLength"==t?"longer":"shorter",n+=" than ",n+=p?"' + "+a+" + '":""+i,n+=" characters' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+i,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var v=n;return n=f.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},4084:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t)=>new a(e,t).minor},4232:e=>{"use strict";var t=e.exports=function(e,t,a){"function"==typeof t&&(a=t,t={}),r(t,"function"==typeof(a=t.cb||a)?a:a.pre||function(){},a.post||function(){},e,"",e)};function r(e,n,s,o,i,l,c,u,d,p){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var h in n(o,i,l,c,u,d,p),o){var m=o[h];if(Array.isArray(m)){if(h in t.arrayKeywords)for(var f=0;f<m.length;f++)r(e,n,s,m[f],i+"/"+h+"/"+f,l,i,h,o,f)}else if(h in t.propsKeywords){if(m&&"object"==typeof m)for(var v in m)r(e,n,s,m[v],i+"/"+h+"/"+a(v),l,i,h,o,v)}else(h in t.keywords||e.allKeys&&!(h in t.skipKeywords))&&r(e,n,s,m,i+"/"+h,l,i,h,o)}s(o,i,l,c,u,d,p)}}function a(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},4768:(e,t,r)=>{"use strict";const a=r(6262),n=r(7738),{safeRe:s,t:o}=r(1680);e.exports=(e,t)=>{if(e instanceof a)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const a=t.includePrerelease?s[o.COERCERTLFULL]:s[o.COERCERTL];let n;for(;(n=a.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&n.index+n[0].length===r.index+r[0].length||(r=n),a.lastIndex=n.index+n[1].length+n[2].length;a.lastIndex=-1}else r=e.match(t.includePrerelease?s[o.COERCEFULL]:s[o.COERCE]);if(null===r)return null;const i=r[2],l=r[3]||"0",c=r[4]||"0",u=t.includePrerelease&&r[5]?`-${r[5]}`:"",d=t.includePrerelease&&r[6]?`+${r[6]}`:"";return n(`${i}.${l}.${c}${u}${d}`,t)}},4774:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t,r)=>new a(e,r).compare(new a(t,r))},4960:(e,t,r)=>{"use strict";var a=r(7960),n=r(7290),s=r(8701),o=r(7574),i=r(8815),l=n.ucs2length,c=r(5043),u=s.Validation;function d(e,t,r){var a=h.call(this,e,t,r);return a>=0?{index:a,compiling:!0}:(a=this._compilations.length,this._compilations[a]={schema:e,root:t,baseId:r},{index:a,compiling:!1})}function p(e,t,r){var a=h.call(this,e,t,r);a>=0&&this._compilations.splice(a,1)}function h(e,t,r){for(var a=0;a<this._compilations.length;a++){var n=this._compilations[a];if(n.schema==e&&n.root==t&&n.baseId==r)return a}return-1}function m(e,t){return"var pattern"+e+" = new RegExp("+n.toQuotedString(t[e])+");"}function f(e){return"var default"+e+" = defaults["+e+"];"}function v(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function g(e){return"var customRule"+e+" = customRules["+e+"];"}function y(e,t){if(!e.length)return"";for(var r="",a=0;a<e.length;a++)r+=t(a,e);return r}e.exports=function e(t,r,h,_){var b=this,E=this._opts,w=[void 0],P={},x=[],S={},O=[],k={},C=[];r=r||{schema:t,refVal:w,refs:P};var I=d.call(this,t,r,_),$=this._compilations[I.index];if(I.compiling)return $.callValidate=function e(){var t=$.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var A=this._formats,R=this.RULES;try{var T=L(t,r,h,_);$.validate=T;var j=$.callValidate;return j&&(j.schema=T.schema,j.errors=null,j.refs=T.refs,j.refVal=T.refVal,j.root=T.root,j.$async=T.$async,E.sourceCode&&(j.source=T.source)),T}finally{p.call(this,t,r,_)}function L(t,o,d,p){var h=!o||o&&o.schema==t;if(o.schema!=r.schema)return e.call(b,t,o,d,p);var _,S=!0===t.$async,k=i({isTop:!0,schema:t,isRoot:h,baseId:p,root:o,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:s.MissingRef,RULES:R,validate:i,util:n,resolve:a,resolveRef:F,usePattern:M,useDefault:z,useCustomRule:U,opts:E,formats:A,logger:b.logger,self:b});k=y(w,v)+y(x,m)+y(O,f)+y(C,g)+k,E.processCode&&(k=E.processCode(k,t));try{_=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",k)(b,R,A,r,w,O,C,c,l,u),w[0]=_}catch(e){throw b.logger.error("Error compiling schema, function code:",k),e}return _.schema=t,_.errors=null,_.refs=P,_.refVal=w,_.root=h?_:o,S&&(_.$async=!0),!0===E.sourceCode&&(_.source={code:k,patterns:x,defaults:O}),_}function F(t,n,s){n=a.url(t,n);var o,i,l=P[n];if(void 0!==l)return D(o=w[l],i="refVal["+l+"]");if(!s&&r.refs){var c=r.refs[n];if(void 0!==c)return D(o=r.refVal[c],i=N(n,o))}i=N(n);var u=a.call(b,L,r,n);if(void 0===u){var d=h&&h[n];d&&(u=a.inlineRef(d,E.inlineRefs)?d:e.call(b,d,r,h,t))}if(void 0!==u)return function(e,t){var r=P[e];w[r]=t}(n,u),D(u,i);!function(e){delete P[e]}(n)}function N(e,t){var r=w.length;return w[r]=t,P[e]=r,"refVal"+r}function D(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function M(e){var t=S[e];return void 0===t&&(t=S[e]=x.length,x[t]=e),"pattern"+t}function z(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return n.toQuotedString(e);case"object":if(null===e)return"null";var t=o(e),r=k[t];return void 0===r&&(r=k[t]=O.length,O[r]=e),"default"+r}}function U(e,t,r,a){if(!1!==b._opts.validateSchema){var n=e.definition.dependencies;if(n&&!n.every(function(e){return Object.prototype.hasOwnProperty.call(r,e)}))throw new Error("parent schema must have all required keywords: "+n.join(","));var s=e.definition.validateSchema;if(s&&!s(t)){var o="keyword schema is invalid: "+b.errorsText(s.errors);if("log"!=b._opts.validateSchema)throw new Error(o);b.logger.error(o)}}var i,l=e.definition.compile,c=e.definition.inline,u=e.definition.macro;if(l)i=l.call(b,t,r,a);else if(u)i=u.call(b,t,r,a),!1!==E.validateSchema&&b.validateSchema(i,!0);else if(c)i=c.call(b,a,e.keyword,t,r);else if(!(i=e.definition.validate))return;if(void 0===i)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var d=C.length;return C[d]=i,{code:"customRule"+d,validate:i}}}},5043:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var a,n,s;if(Array.isArray(t)){if((a=t.length)!=r.length)return!1;for(n=a;0!==n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((a=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=a;0!==n--;)if(!Object.prototype.hasOwnProperty.call(r,s[n]))return!1;for(n=a;0!==n--;){var o=s[n];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},5048:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p=e.opts.$data&&i&&i.$data;if(p?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i,!p&&"number"!=typeof i)throw new Error(t+" must be number");n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" Object.keys("+d+").length "+("maxProperties"==t?">":"<")+" "+a+") { ";var h=t,m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(h||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxProperties"==t?"more":"fewer",n+=" than ",n+=p?"' + "+a+" + '":""+i,n+=" properties' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+i,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var f=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},5104:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>a(t,e,r)},5179:(e,t,r)=>{"use strict";const a=r(7738);e.exports=(e,t)=>{const r=a(e,t);return r&&r.prerelease.length?r.prerelease:null}},5217:(e,t,r)=>{"use strict";var a=r(4960),n=r(7960),s=r(1780),o=r(7759),i=r(7574),l=r(2720),c=r(2303),u=r(1232),d=r(7290);e.exports=g,g.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var a=this._addSchema(e);r=a.validate||this._compile(a)}var n=r(t);return!0!==r.$async&&(this.errors=r.errors),n},g.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},g.prototype.addSchema=function(e,t,r,a){if(Array.isArray(e)){for(var s=0;s<e.length;s++)this.addSchema(e[s],void 0,r,a);return this}var o=this._getId(e);if(void 0!==o&&"string"!=typeof o)throw new Error("schema id must be string");return P(this,t=n.normalizeId(t||o)),this._schemas[t]=this._addSchema(e,r,a,!0),this},g.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},g.prototype.validateSchema=function(e,t){var r,a,n=e.$schema;if(void 0!==n&&"string"!=typeof n)throw new Error("$schema must be a string");if(!(n=n||this._opts.defaultMeta||(r=this,a=r._opts.meta,r._opts.defaultMeta="object"==typeof a?r._getId(a)||a:r.getSchema(m)?m:void 0,r._opts.defaultMeta)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var s=this.validate(n,e);if(!s&&t){var o="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(o);this.logger.error(o)}return s},g.prototype.getSchema=function(e){var t=y(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=n.schema.call(e,{schema:{}},t);if(r){var s=r.schema,i=r.root,l=r.baseId,c=a.call(e,s,i,void 0,l);return e._fragments[t]=new o({ref:t,fragment:!0,schema:s,root:i,baseId:l,validate:c}),c}}(this,e)}},g.prototype.removeSchema=function(e){if(e instanceof RegExp)return _(this,this._schemas,e),_(this,this._refs,e),this;switch(typeof e){case"undefined":return _(this,this._schemas),_(this,this._refs),this._cache.clear(),this;case"string":var t=y(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,a=r?r(e):e;this._cache.del(a);var s=this._getId(e);s&&(s=n.normalizeId(s),delete this._schemas[s],delete this._refs[s])}return this},g.prototype.addFormat=function(e,t){return"string"==typeof t&&(t=new RegExp(t)),this._formats[e]=t,this},g.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,a=void 0===t.dataVar?"data":t.dataVar,n="",s=0;s<e.length;s++){var o=e[s];o&&(n+=a+o.dataPath+" "+o.message+r)}return n.slice(0,-r.length)},g.prototype._addSchema=function(e,t,r,a){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var s=this._opts.serialize,i=s?s(e):e,l=this._cache.get(i);if(l)return l;a=a||!1!==this._opts.addUsedSchema;var c=n.normalizeId(this._getId(e));c&&a&&P(this,c);var u,d=!1!==this._opts.validateSchema&&!t;d&&!(u=c&&c==n.normalizeId(e.$schema))&&this.validateSchema(e,!0);var p=n.ids.call(this,e),h=new o({id:c,schema:e,localRefs:p,cacheKey:i,meta:r});return"#"!=c[0]&&a&&(this._refs[c]=h),this._cache.put(i,h),d&&u&&this.validateSchema(e,!0),h},g.prototype._compile=function(e,t){if(e.compiling)return e.validate=s,s.schema=e.schema,s.errors=null,s.root=t||s,!0===e.schema.$async&&(s.$async=!0),s;var r,n;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{n=a.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=n,e.refs=n.refs,e.refVal=n.refVal,e.root=n.root,n;function s(){var t=e.validate,r=t.apply(this,arguments);return s.errors=t.errors,r}},g.prototype.compileAsync=r(2268);var p=r(1345);g.prototype.addKeyword=p.add,g.prototype.getKeyword=p.get,g.prototype.removeKeyword=p.remove,g.prototype.validateKeyword=p.validate;var h=r(8701);g.ValidationError=h.Validation,g.MissingRefError=h.MissingRef,g.$dataMetaSchema=u;var m="http://json-schema.org/draft-07/schema",f=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],v=["/properties"];function g(e){if(!(this instanceof g))return new g(e);e=this._opts=d.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:x,warn:x,error:x};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=l(e.format),this._cache=e.cache||new s,this._loadingSchemas={},this._compilations=[],this.RULES=c(),this._getId=function(e){switch(e.schemaId){case"auto":return w;case"id":return b;default:return E}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=i),this._metaOpts=function(e){for(var t=d.copy(e._opts),r=0;r<f.length;r++)delete t[f[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(e){var t;if(e._opts.$data&&(t=r(1386),e.addMetaSchema(t,t.$id,!0)),!1!==e._opts.meta){var a=r(6696);e._opts.$data&&(a=u(a,v)),e.addMetaSchema(a,m,!0),e._refs["http://json-schema.org/schema"]=m}}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(t)if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function y(e,t){return t=n.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function _(e,t,r){for(var a in t){var n=t[a];n.meta||r&&!r.test(a)||(e._cache.del(n.cacheKey),delete t[a])}}function b(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function E(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function w(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function P(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function x(){}},5313:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p=e.opts.$data&&i&&i.$data;p?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i;var h="maximum"==t,m=h?"exclusiveMaximum":"exclusiveMinimum",f=e.schema[m],v=e.opts.$data&&f&&f.$data,g=h?"<":">",y=h?">":"<",_=void 0;if(!p&&"number"!=typeof i&&void 0!==i)throw new Error(t+" must be number");if(!v&&void 0!==f&&"number"!=typeof f&&"boolean"!=typeof f)throw new Error(m+" must be number or boolean");if(v){var b,E=e.util.getData(f.$data,o,e.dataPathArr),w="exclusive"+s,P="exclType"+s,x="exclIsNumber"+s,S="' + "+(k="op"+s)+" + '";n+=" var schemaExcl"+s+" = "+E+"; ",n+=" var "+w+"; var "+P+" = typeof "+(E="schemaExcl"+s)+"; if ("+P+" != 'boolean' && "+P+" != 'undefined' && "+P+" != 'number') { ",_=m,(b=b||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(_||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: '"+m+" should be boolean' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var O=n;n=b.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+O+"]); ":n+=" validate.errors = ["+O+"]; return false; ":n+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" "+P+" == 'number' ? ( ("+w+" = "+a+" === undefined || "+E+" "+g+"= "+a+") ? "+d+" "+y+"= "+E+" : "+d+" "+y+" "+a+" ) : ( ("+w+" = "+E+" === true) ? "+d+" "+y+"= "+a+" : "+d+" "+y+" "+a+" ) || "+d+" !== "+d+") { var op"+s+" = "+w+" ? '"+g+"' : '"+g+"='; ",void 0===i&&(_=m,c=e.errSchemaPath+"/"+m,a=E,p=v)}else if(S=g,(x="number"==typeof f)&&p){var k="'"+S+"'";n+=" if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" ( "+a+" === undefined || "+f+" "+g+"= "+a+" ? "+d+" "+y+"= "+f+" : "+d+" "+y+" "+a+" ) || "+d+" !== "+d+") { "}else x&&void 0===i?(w=!0,_=m,c=e.errSchemaPath+"/"+m,a=f,y+="="):(x&&(a=Math[h?"min":"max"](f,i)),f===(!x||a)?(w=!0,_=m,c=e.errSchemaPath+"/"+m,y+="="):(w=!1,S+="=")),k="'"+S+"'",n+=" if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" "+d+" "+y+" "+a+" || "+d+" !== "+d+") { ";return _=_||t,(b=b||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(_||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+k+", limit: "+a+", exclusive: "+w+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be "+S+" ",n+=p?"' + "+a:a+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+i,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",O=n,n=b.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+O+"]); ":n+=" validate.errors = ["+O+"]; return false; ":n+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { "),n}},5372:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p="errs__"+n,h=e.util.copy(e),m="";h.level++;var f="valid"+h.level,v=h.baseId,g="prevValid"+n,y="passingSchemas"+n;a+="var "+p+" = errors , "+g+" = false , "+d+" = false , "+y+" = null; ";var _=e.compositeRule;e.compositeRule=h.compositeRule=!0;var b=o;if(b)for(var E,w=-1,P=b.length-1;w<P;)E=b[w+=1],(e.opts.strictKeywords?"object"==typeof E&&Object.keys(E).length>0||!1===E:e.util.schemaHasRules(E,e.RULES.all))?(h.schema=E,h.schemaPath=i+"["+w+"]",h.errSchemaPath=l+"/"+w,a+="  "+e.validate(h)+" ",h.baseId=v):a+=" var "+f+" = true; ",w&&(a+=" if ("+f+" && "+g+") { "+d+" = false; "+y+" = ["+y+", "+w+"]; } else { ",m+="}"),a+=" if ("+f+") { "+d+" = "+g+" = true; "+y+" = "+w+"; }";return e.compositeRule=h.compositeRule=_,a+=m+"if (!"+d+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+y+" } ",!1!==e.opts.messages&&(a+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+="} else {  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; }",e.opts.allErrors&&(a+=" } "),a}},5373:(e,t,r)=>{"use strict";const a=r(3623),n=r(5477),s=r(1694),o=r(8327),i=r(7665),l=r(2658);e.exports=(e,t,r,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return a(e,r,c);case"!=":return n(e,r,c);case">":return s(e,r,c);case">=":return o(e,r,c);case"<":return i(e,r,c);case"<=":return l(e,r,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},5477:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>0!==a(e,t,r)},5513:(e,t,r)=>{"use strict";const a=r(887);e.exports=(e,t)=>e.sort((e,r)=>a(e,r,t))},5746:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p="errs__"+n,h=e.util.copy(e);h.level++;var m="valid"+h.level,f=e.schema.then,v=e.schema.else,g=void 0!==f&&(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0||!1===f:e.util.schemaHasRules(f,e.RULES.all)),y=void 0!==v&&(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0||!1===v:e.util.schemaHasRules(v,e.RULES.all)),_=h.baseId;if(g||y){var b;h.createErrors=!1,h.schema=o,h.schemaPath=i,h.errSchemaPath=l,a+=" var "+p+" = errors; var "+d+" = true;  ";var E=e.compositeRule;e.compositeRule=h.compositeRule=!0,a+="  "+e.validate(h)+" ",h.baseId=_,h.createErrors=!0,a+="  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; }  ",e.compositeRule=h.compositeRule=E,g?(a+=" if ("+m+") {  ",h.schema=e.schema.then,h.schemaPath=e.schemaPath+".then",h.errSchemaPath=e.errSchemaPath+"/then",a+="  "+e.validate(h)+" ",h.baseId=_,a+=" "+d+" = "+m+"; ",g&&y?a+=" var "+(b="ifClause"+n)+" = 'then'; ":b="'then'",a+=" } ",y&&(a+=" else { ")):a+=" if (!"+m+") { ",y&&(h.schema=e.schema.else,h.schemaPath=e.schemaPath+".else",h.errSchemaPath=e.errSchemaPath+"/else",a+="  "+e.validate(h)+" ",h.baseId=_,a+=" "+d+" = "+m+"; ",g&&y?a+=" var "+(b="ifClause"+n)+" = 'else'; ":b="'else'",a+=" } "),a+=" if (!"+d+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+b+" } ",!1!==e.opts.messages&&(a+=" , message: 'should match \"' + "+b+" + '\" schema' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+=" }   ",c&&(a+=" else { ")}else c&&(a+=" if (true) { ");return a}},5773:(e,t,r)=>{"use strict";e.exports={$ref:r(252),allOf:r(7023),anyOf:r(6082),$comment:r(8440),const:r(3678),contains:r(1880),dependencies:r(1416),enum:r(6516),format:r(5974),if:r(5746),items:r(1397),maximum:r(5313),minimum:r(5313),maxItems:r(7317),minItems:r(7317),maxLength:r(3933),minLength:r(3933),maxProperties:r(5048),minProperties:r(5048),multipleOf:r(2424),not:r(9048),oneOf:r(5372),pattern:r(8771),properties:r(9816),propertyNames:r(6018),required:r(1644),uniqueItems:r(320),validate:r(8815)}},5959:e=>{"use strict";e.exports=t},5974:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||"");if(!1===e.opts.format)return c&&(a+=" if (true) { "),a;var d,p=e.opts.$data&&o&&o.$data;p?(a+=" var schema"+n+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",d="schema"+n):d=o;var h=e.opts.unknownFormats,m=Array.isArray(h);if(p)a+=" var "+(f="format"+n)+" = formats["+d+"]; var "+(v="isObject"+n)+" = typeof "+f+" == 'object' && !("+f+" instanceof RegExp) && "+f+".validate; var "+(g="formatType"+n)+" = "+v+" && "+f+".type || 'string'; if ("+v+") { ",e.async&&(a+=" var async"+n+" = "+f+".async; "),a+=" "+f+" = "+f+".validate; } if (  ",p&&(a+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),a+=" (","ignore"!=h&&(a+=" ("+d+" && !"+f+" ",m&&(a+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),a+=") || "),a+=" ("+f+" && "+g+" == '"+r+"' && !(typeof "+f+" == 'function' ? ",e.async?a+=" (async"+n+" ? await "+f+"("+u+") : "+f+"("+u+")) ":a+=" "+f+"("+u+") ",a+=" : "+f+".test("+u+"))))) {";else{var f;if(!(f=e.formats[o])){if("ignore"==h)return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(a+=" if (true) { "),a;if(m&&h.indexOf(o)>=0)return c&&(a+=" if (true) { "),a;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var v,g=(v="object"==typeof f&&!(f instanceof RegExp)&&f.validate)&&f.type||"string";if(v){var y=!0===f.async;f=f.validate}if(g!=r)return c&&(a+=" if (true) { "),a;if(y){if(!e.async)throw new Error("async format in sync schema");a+=" if (!(await "+(_="formats"+e.util.getProperty(o)+".validate")+"("+u+"))) { "}else{a+=" if (! ";var _="formats"+e.util.getProperty(o);v&&(_+=".validate"),a+="function"==typeof f?" "+_+"("+u+") ":" "+_+".test("+u+") ",a+=") { "}}var b=b||[];b.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",a+=p?""+d:""+e.util.toQuotedString(o),a+="  } ",!1!==e.opts.messages&&(a+=" , message: 'should match format \"",a+=p?"' + "+d+" + '":""+e.util.escapeQuotes(o),a+="\"' "),e.opts.verbose&&(a+=" , schema:  ",a+=p?"validate.schema"+i:""+e.util.toQuotedString(o),a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var E=a;return a=b.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",c&&(a+=" else { "),a}},6018:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="errs__"+n,p=e.util.copy(e);p.level++;var h="valid"+p.level;if(a+="var "+d+" = errors;",e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0||!1===o:e.util.schemaHasRules(o,e.RULES.all)){p.schema=o,p.schemaPath=i,p.errSchemaPath=l;var m="key"+n,f="idx"+n,v="i"+n,g="' + "+m+" + '",y="data"+(p.dataLevel=e.dataLevel+1),_="dataProperties"+n,b=e.opts.ownProperties,E=e.baseId;b&&(a+=" var "+_+" = undefined; "),a+=b?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+f+"=0; "+f+"<"+_+".length; "+f+"++) { var "+m+" = "+_+"["+f+"]; ":" for (var "+m+" in "+u+") { ",a+=" var startErrs"+n+" = errors; ";var w=m,P=e.compositeRule;e.compositeRule=p.compositeRule=!0;var x=e.validate(p);p.baseId=E,e.util.varOccurences(x,y)<2?a+=" "+e.util.varReplace(x,y,w)+" ":a+=" var "+y+" = "+w+"; "+x+" ",e.compositeRule=p.compositeRule=P,a+=" if (!"+h+") { for (var "+v+"=startErrs"+n+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+m+"; }   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+g+"' } ",!1!==e.opts.messages&&(a+=" , message: 'property name \\'"+g+"\\' is invalid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),c&&(a+=" break; "),a+=" } }"}return c&&(a+="  if ("+d+" == errors) {"),a}},6082:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p="errs__"+n,h=e.util.copy(e),m="";h.level++;var f="valid"+h.level,v=o.every(function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0||!1===t:e.util.schemaHasRules(t,e.RULES.all)});if(v){var g=h.baseId;a+=" var "+p+" = errors; var "+d+" = false;  ";var y=e.compositeRule;e.compositeRule=h.compositeRule=!0;var _=o;if(_)for(var b,E=-1,w=_.length-1;E<w;)b=_[E+=1],h.schema=b,h.schemaPath=i+"["+E+"]",h.errSchemaPath=l+"/"+E,a+="  "+e.validate(h)+" ",h.baseId=g,a+=" "+d+" = "+d+" || "+f+"; if (!"+d+") { ",m+="}";e.compositeRule=h.compositeRule=y,a+=" "+m+" if (!"+d+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+=" } else {  errors = "+p+"; if (vErrors !== null) { if ("+p+") vErrors.length = "+p+"; else vErrors = null; } ",e.opts.allErrors&&(a+=" } ")}else c&&(a+=" if (true) { ");return a}},6089:e=>{"use strict";e.exports=s},6262:(e,t,r)=>{"use strict";const a=r(202),{MAX_LENGTH:n,MAX_SAFE_INTEGER:s}=r(7628),{safeRe:o,t:i}=r(1680),l=r(3365),{compareIdentifiers:c}=r(9525);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>n)throw new TypeError(`version is longer than ${n} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?o[i.LOOSE]:o[i.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<s)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],n=e.prerelease[t];if(a("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return c(r,n)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const r=this.build[t],n=e.build[t];if(a("build compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return c(r,n)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?o[i.PRERELEASELOOSE]:o[i.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===r&&(a=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},6390:(e,t,r)=>{"use strict";const a=r(7738);e.exports=(e,t)=>{const r=a(e,null,!0),n=a(t,null,!0),s=r.compare(n);if(0===s)return null;const o=s>0,i=o?r:n,l=o?n:r,c=!!i.prerelease.length;if(l.prerelease.length&&!c){if(!l.patch&&!l.minor)return"major";if(0===l.compareMain(i))return l.minor&&!l.patch?"minor":"patch"}const u=c?"pre":"";return r.major!==n.major?u+"major":r.minor!==n.minor?u+"minor":r.patch!==n.patch?u+"patch":"prerelease"}},6413:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t)=>a(e,t,!0)},6516:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="valid"+n,p=e.opts.$data&&o&&o.$data;p&&(a+=" var schema"+n+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ");var h="i"+n,m="schema"+n;p||(a+=" var "+m+" = validate.schema"+i+";"),a+="var "+d+";",p&&(a+=" if (schema"+n+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+n+")) "+d+" = false; else {"),a+=d+" = false;for (var "+h+"=0; "+h+"<"+m+".length; "+h+"++) if (equal("+u+", "+m+"["+h+"])) { "+d+" = true; break; }",p&&(a+="  }  "),a+=" if (!"+d+") {   ";var f=f||[];f.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+n+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var v=a;return a=f.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+v+"]); ":a+=" validate.errors = ["+v+"]; return false; ":a+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" }",c&&(a+=" else { "),a}},6696:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},6761:(e,t,r)=>{"use strict";const a=r(2033);e.exports=(e,t,r)=>a(e,t,">",r)},7023:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,i=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var u="valid"+l.level,d=l.baseId,p=!0,h=n;if(h)for(var m,f=-1,v=h.length-1;f<v;)m=h[f+=1],(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0||!1===m:e.util.schemaHasRules(m,e.RULES.all))&&(p=!1,l.schema=m,l.schemaPath=s+"["+f+"]",l.errSchemaPath=o+"/"+f,a+="  "+e.validate(l)+" ",l.baseId=d,i&&(a+=" if ("+u+") { ",c+="}"));return i&&(a+=p?" if (true) { ":" "+c.slice(0,-1)+" "),a}},7170:(e,t,r)=>{"use strict";const a=r(6262),n=r(2717);e.exports=(e,t,r)=>{let s=null,o=null,i=null;try{i=new n(t,r)}catch(e){return null}return e.forEach(e=>{i.test(e)&&(s&&-1!==o.compare(e)||(s=e,o=new a(s,r)))}),s}},7290:(e,t,r)=>{"use strict";function a(e,t,r,a){var n=a?" !== ":" === ",s=a?" || ":" && ",o=a?"!":"",i=a?"":"!";switch(e){case"null":return t+n+"null";case"array":return o+"Array.isArray("+t+")";case"object":return"("+o+t+s+"typeof "+t+n+'"object"'+s+i+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+n+'"number"'+s+i+"("+t+" % 1)"+s+t+n+t+(r?s+o+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+n+'"'+e+'"'+(r?s+o+"isFinite("+t+")":"")+")";default:return"typeof "+t+n+'"'+e+'"'}}e.exports={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:a,checkDataTypes:function(e,t,r){if(1===e.length)return a(e[0],t,r,!0);var n="",o=s(e);for(var i in o.array&&o.object&&(n=o.null?"(":"(!"+t+" || ",n+="typeof "+t+' !== "object")',delete o.null,delete o.array,delete o.object),o.number&&delete o.integer,o)n+=(n?" && ":"")+a(i,t,r,!0);return n},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],a=0;a<t.length;a++){var s=t[a];(n[s]||"array"===e&&"array"===s)&&(r[r.length]=s)}if(r.length)return r}else{if(n[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:s,getProperty:l,escapeQuotes:c,equal:r(5043),ucs2length:r(2359),varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var a in e)if(a!=r&&t[a])return!0},schemaUnknownRules:function(e,t){if("boolean"!=typeof e)for(var r in e)if(!t[r])return r},toQuotedString:u,getPathExpr:function(e,t,r,a){return h(e,r?"'/' + "+t+(a?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):a?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){return h(e,u(r?"/"+m(t):l(t)))},getData:function(e,t,r){var a,n,s,o;if(""===e)return"rootData";if("/"==e[0]){if(!d.test(e))throw new Error("Invalid JSON-pointer: "+e);n=e,s="rootData"}else{if(!(o=e.match(p)))throw new Error("Invalid JSON-pointer: "+e);if(a=+o[1],"#"==(n=o[2])){if(a>=t)throw new Error("Cannot access property/index "+a+" levels up, current level is "+t);return r[t-a]}if(a>t)throw new Error("Cannot access data "+a+" levels up, current level is "+t);if(s="data"+(t-a||""),!n)return s}for(var i=s,c=n.split("/"),u=0;u<c.length;u++){var h=c[u];h&&(i+=" && "+(s+=l(f(h))))}return i},unescapeFragment:function(e){return f(decodeURIComponent(e))},unescapeJsonPointer:f,escapeFragment:function(e){return encodeURIComponent(m(e))},escapeJsonPointer:m};var n=s(["string","number","integer","boolean","null"]);function s(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var o=/^[a-z$_][a-z$_0-9]*$/i,i=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":o.test(e)?"."+e:"['"+c(e)+"']"}function c(e){return e.replace(i,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function u(e){return"'"+c(e)+"'"}var d=/^\/(?:[^~]|~0|~1)*$/,p=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function h(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function m(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},7317:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p=e.opts.$data&&i&&i.$data;if(p?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i,!p&&"number"!=typeof i)throw new Error(t+" must be number");n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),n+=" "+d+".length "+("maxItems"==t?">":"<")+" "+a+") { ";var h=t,m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(h||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxItems"==t?"more":"fewer",n+=" than ",n+=p?"' + "+a+" + '":""+i,n+=" items' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+i,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var f=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},7540:e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},7574:e=>{"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,a="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(r=t.cmp,function(e){return function(t,a){var n={key:t,value:e[t]},s={key:a,value:e[a]};return r(n,s)}}),s=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,o;if(Array.isArray(t)){for(o="[",r=0;r<t.length;r++)r&&(o+=","),o+=e(t[r])||"null";return o+"]"}if(null===t)return"null";if(-1!==s.indexOf(t)){if(a)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var i=s.push(t)-1,l=Object.keys(t).sort(n&&n(t));for(o="",r=0;r<l.length;r++){var c=l[r],u=e(t[c]);u&&(o&&(o+=","),o+=JSON.stringify(c)+":"+u)}return s.splice(i,1),"{"+o+"}"}}(e)}},7628:e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},7665:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>a(e,t,r)<0},7738:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t,r=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!r)return null;throw e}}},7759:(e,t,r)=>{"use strict";var a=r(7290);e.exports=function(e){a.copy(e,this)}},7781:t=>{"use strict";t.exports=e},7960:(e,t,r)=>{"use strict";var a=r(453),n=r(5043),s=r(7290),o=r(7759),i=r(4232);function l(e,t,r){var a=this._refs[r];if("string"==typeof a){if(!this._refs[a])return l.call(this,e,t,a);a=this._refs[a]}if((a=a||this._schemas[r])instanceof o)return m(a.schema,this._opts.inlineRefs)?a.schema:a.validate||this._compile(a);var n,s,i,u=c.call(this,t,r);return u&&(n=u.schema,t=u.root,i=u.baseId),n instanceof o?s=n.validate||e.call(this,n.schema,t,void 0,i):void 0!==n&&(s=m(n,this._opts.inlineRefs)?n:e.call(this,n,t,void 0,i)),s}function c(e,t){var r=a.parse(t),n=y(r),s=g(this._getId(e.schema));if(0===Object.keys(e.schema).length||n!==s){var i=b(n),l=this._refs[i];if("string"==typeof l)return u.call(this,e,l,r);if(l instanceof o)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[i])instanceof o))return;if(l.validate||this._compile(l),i==b(t))return{schema:l,root:e,baseId:s};e=l}if(!e.schema)return;s=g(this._getId(e.schema))}return p.call(this,r,s,e.schema,e)}function u(e,t,r){var a=c.call(this,e,t);if(a){var n=a.schema,s=a.baseId;e=a.root;var o=this._getId(n);return o&&(s=E(s,o)),p.call(this,r,s,n,e)}}e.exports=l,l.normalizeId=b,l.fullPath=g,l.url=E,l.ids=function(e){var t=b(this._getId(e)),r={"":t},o={"":g(t,!1)},l={},c=this;return i(e,{allKeys:!0},function(e,t,i,u,d,p,h){if(""!==t){var m=c._getId(e),f=r[u],v=o[u]+"/"+d;if(void 0!==h&&(v+="/"+("number"==typeof h?h:s.escapeFragment(h))),"string"==typeof m){m=f=b(f?a.resolve(f,m):m);var g=c._refs[m];if("string"==typeof g&&(g=c._refs[g]),g&&g.schema){if(!n(e,g.schema))throw new Error('id "'+m+'" resolves to more than one schema')}else if(m!=b(v))if("#"==m[0]){if(l[m]&&!n(e,l[m]))throw new Error('id "'+m+'" resolves to more than one schema');l[m]=e}else c._refs[m]=v}r[t]=f,o[t]=v}}),l},l.inlineRef=m,l.schema=c;var d=s.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function p(e,t,r,a){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var n=e.fragment.split("/"),o=1;o<n.length;o++){var i=n[o];if(i){if(void 0===(r=r[i=s.unescapeFragment(i)]))break;var l;if(!d[i]&&((l=this._getId(r))&&(t=E(t,l)),r.$ref)){var u=E(t,r.$ref),p=c.call(this,a,u);p&&(r=p.schema,a=p.root,t=p.baseId)}}}return void 0!==r&&r!==a.schema?{schema:r,root:a,baseId:t}:void 0}}var h=s.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function m(e,t){return!1!==t&&(void 0===t||!0===t?f(e):t?v(e)<=t:void 0)}function f(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&!f(t))return!1}else for(var a in e){if("$ref"==a)return!1;if("object"==typeof(t=e[a])&&!f(t))return!1}return!0}function v(e){var t,r=0;if(Array.isArray(e)){for(var a=0;a<e.length;a++)if("object"==typeof(t=e[a])&&(r+=v(t)),r==1/0)return 1/0}else for(var n in e){if("$ref"==n)return 1/0;if(h[n])r++;else if("object"==typeof(t=e[n])&&(r+=v(t)+1),r==1/0)return 1/0}return r}function g(e,t){return!1!==t&&(e=b(e)),y(a.parse(e))}function y(e){return a.serialize(e).split("#")[0]+"#"}var _=/#\/?$/;function b(e){return e?e.replace(_,""):""}function E(e,t){return t=b(t),a.resolve(e,t)}},8187:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t)=>new a(e,t).patch},8327:(e,t,r)=>{"use strict";const a=r(4774);e.exports=(e,t,r)=>a(e,t,r)>=0},8432:(e,t,r)=>{"use strict";const a=r(2033);e.exports=(e,t,r)=>a(e,t,"<",r)},8440:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.schema[t],s=e.errSchemaPath+"/"+t,o=(e.opts.allErrors,e.util.toQuotedString(n));return!0===e.opts.$comment?a+=" console.log("+o+");":"function"==typeof e.opts.$comment&&(a+=" self._opts.$comment("+o+", "+e.util.toQuotedString(s)+", validate.root.schema);"),a}},8531:e=>{"use strict";e.exports=r},8701:(e,t,r)=>{"use strict";var a=r(7960);function n(e,t,r){this.message=r||n.message(e,t),this.missingRef=a.url(e,t),this.missingSchema=a.normalizeId(a.fullPath(this.missingRef))}function s(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:s(function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0}),MissingRef:s(n)},n.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},8771:e=>{"use strict";e.exports=function(e,t,r){var a,n=" ",s=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),p=e.opts.$data&&i&&i.$data;p?(n+=" var schema"+s+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=i,n+="if ( ",p&&(n+=" ("+a+" !== undefined && typeof "+a+" != 'string') || "),n+=" !"+(p?"(new RegExp("+a+"))":e.usePattern(i))+".test("+d+") ) {   ";var h=h||[];h.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",n+=p?""+a:""+e.util.toQuotedString(i),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match pattern \"",n+=p?"' + "+a+" + '":""+e.util.escapeQuotes(i),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=p?"validate.schema"+l:""+e.util.toQuotedString(i),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var m=n;return n=h.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+m+"]); ":n+=" validate.errors = ["+m+"]; return false; ":n+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},8815:e=>{"use strict";e.exports=function(e,t,r){var a="",n=!0===e.schema.$async,s=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var i=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(i){var l="unknown keyword: "+i;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(a+=" var validate = ",n&&(e.async=!0,a+="async "),a+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(a+=" /*# sourceURL="+o+" */ ")),"boolean"==typeof e.schema||!s&&!e.schema.$ref){t="false schema";var c=e.level,u=e.dataLevel,d=e.schema[t],p=e.schemaPath+e.util.getProperty(t),h=e.errSchemaPath+"/"+t,m=!e.opts.allErrors,f="data"+(u||""),v="valid"+c;if(!1===e.schema){e.isTop?m=!0:a+=" var "+v+" = false; ",(H=H||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'boolean schema is false' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var g=a;a=H.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?a+=n?" return data; ":" validate.errors = null; return true; ":a+=" var "+v+" = true; ";return e.isTop&&(a+=" }; return validate; "),a}if(e.isTop){var y=e.isTop;if(c=e.level=0,u=e.dataLevel=0,f="data",e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var _="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}a+=" var vErrors = null; ",a+=" var errors = 0;     ",a+=" if (rootData === undefined) rootData = data; "}else{if(c=e.level,f="data"+((u=e.dataLevel)||""),o&&(e.baseId=e.resolve.url(e.baseId,o)),n&&!e.async)throw new Error("async schema in sync schema");a+=" var errs_"+c+" = errors;"}v="valid"+c,m=!e.opts.allErrors;var b="",E="",w=e.schema.type,P=Array.isArray(w);if(w&&e.opts.nullable&&!0===e.schema.nullable&&(P?-1==w.indexOf("null")&&(w=w.concat("null")):"null"!=w&&(w=[w,"null"],P=!0)),P&&1==w.length&&(w=w[0],P=!1),e.schema.$ref&&s){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(s=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(a+=" "+e.RULES.all.$comment.code(e,"$comment")),w){if(e.opts.coerceTypes)var x=e.util.coerceToTypes(e.opts.coerceTypes,w);var S=e.RULES.types[w];if(x||P||!0===S||S&&!J(S)){p=e.schemaPath+".type",h=e.errSchemaPath+"/type",p=e.schemaPath+".type",h=e.errSchemaPath+"/type";var O=P?"checkDataTypes":"checkDataType";if(a+=" if ("+e.util[O](w,f,e.opts.strictNumbers,!0)+") { ",x){var k="dataType"+c,C="coerced"+c;a+=" var "+k+" = typeof "+f+"; var "+C+" = undefined; ","array"==e.opts.coerceTypes&&(a+=" if ("+k+" == 'object' && Array.isArray("+f+") && "+f+".length == 1) { "+f+" = "+f+"[0]; "+k+" = typeof "+f+"; if ("+e.util.checkDataType(e.schema.type,f,e.opts.strictNumbers)+") "+C+" = "+f+"; } "),a+=" if ("+C+" !== undefined) ; ";var I=x;if(I)for(var $,A=-1,R=I.length-1;A<R;)"string"==($=I[A+=1])?a+=" else if ("+k+" == 'number' || "+k+" == 'boolean') "+C+" = '' + "+f+"; else if ("+f+" === null) "+C+" = ''; ":"number"==$||"integer"==$?(a+=" else if ("+k+" == 'boolean' || "+f+" === null || ("+k+" == 'string' && "+f+" && "+f+" == +"+f+" ","integer"==$&&(a+=" && !("+f+" % 1)"),a+=")) "+C+" = +"+f+"; "):"boolean"==$?a+=" else if ("+f+" === 'false' || "+f+" === 0 || "+f+" === null) "+C+" = false; else if ("+f+" === 'true' || "+f+" === 1) "+C+" = true; ":"null"==$?a+=" else if ("+f+" === '' || "+f+" === 0 || "+f+" === false) "+C+" = null; ":"array"==e.opts.coerceTypes&&"array"==$&&(a+=" else if ("+k+" == 'string' || "+k+" == 'number' || "+k+" == 'boolean' || "+f+" == null) "+C+" = ["+f+"]; ");a+=" else {   ",(H=H||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",a+=P?""+w.join(","):""+w,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=P?""+w.join(","):""+w,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+p+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ",g=a,a=H.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } if ("+C+" !== undefined) {  ";var T=u?"data"+(u-1||""):"parentData";a+=" "+f+" = "+C+"; ",u||(a+="if ("+T+" !== undefined)"),a+=" "+T+"["+(u?e.dataPathArr[u]:"parentDataProperty")+"] = "+C+"; } "}else(H=H||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",a+=P?""+w.join(","):""+w,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=P?""+w.join(","):""+w,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+p+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ",g=a,a=H.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";a+=" } "}}if(e.schema.$ref&&!s)a+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",m&&(a+=" } if (errors === ",a+=y?"0":"errs_"+c,a+=") { ",E+="}");else{var j=e.RULES;if(j)for(var L=-1,F=j.length-1;L<F;)if(J(S=j[L+=1])){if(S.type&&(a+=" if ("+e.util.checkDataType(S.type,f,e.opts.strictNumbers)+") { "),e.opts.useDefaults)if("object"==S.type&&e.schema.properties){d=e.schema.properties;var N=Object.keys(d);if(N)for(var D,M=-1,z=N.length-1;M<z;)if(void 0!==(V=d[D=N[M+=1]]).default){var U=f+e.util.getProperty(D);if(e.compositeRule){if(e.opts.strictDefaults){if(_="default is ignored for: "+U,"log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else a+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(a+=" || "+U+" === null || "+U+" === '' "),a+=" ) "+U+" = ","shared"==e.opts.useDefaults?a+=" "+e.useDefault(V.default)+" ":a+=" "+JSON.stringify(V.default)+" ",a+="; "}}else if("array"==S.type&&Array.isArray(e.schema.items)){var q=e.schema.items;if(q){A=-1;for(var V,Z=q.length-1;A<Z;)if(void 0!==(V=q[A+=1]).default)if(U=f+"["+A+"]",e.compositeRule){if(e.opts.strictDefaults){if(_="default is ignored for: "+U,"log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else a+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(a+=" || "+U+" === null || "+U+" === '' "),a+=" ) "+U+" = ","shared"==e.opts.useDefaults?a+=" "+e.useDefault(V.default)+" ":a+=" "+JSON.stringify(V.default)+" ",a+="; "}}var H,B=S.rules;if(B)for(var G,K=-1,Q=B.length-1;K<Q;)if(X(G=B[K+=1])){var W=G.code(e,G.keyword,S.type);W&&(a+=" "+W+" ",m&&(b+="}"))}if(m&&(a+=" "+b+" ",b=""),S.type&&(a+=" } ",w&&w===S.type&&!x))a+=" else { ",p=e.schemaPath+".type",h=e.errSchemaPath+"/type",(H=H||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",a+=P?""+w.join(","):""+w,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=P?""+w.join(","):""+w,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+p+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ",g=a,a=H.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ";m&&(a+=" if (errors === ",a+=y?"0":"errs_"+c,a+=") { ",E+="}")}}function J(e){for(var t=e.rules,r=0;r<t.length;r++)if(X(t[r]))return!0}function X(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,a=0;a<r.length;a++)if(void 0!==e.schema[r[a]])return!0}(t)}return m&&(a+=" "+E+" "),y?(n?(a+=" if (errors === 0) return data;           ",a+=" else throw new ValidationError(vErrors); "):(a+=" validate.errors = vErrors; ",a+=" return errors === 0;       "),a+=" }; return validate;"):a+=" var "+v+" = errors === errs_"+c+";",a}},9048:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="errs__"+n,p=e.util.copy(e);p.level++;var h="valid"+p.level;if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0||!1===o:e.util.schemaHasRules(o,e.RULES.all)){p.schema=o,p.schemaPath=i,p.errSchemaPath=l,a+=" var "+d+" = errors;  ";var m,f=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.createErrors=!1,p.opts.allErrors&&(m=p.opts.allErrors,p.opts.allErrors=!1),a+=" "+e.validate(p)+" ",p.createErrors=!0,m&&(p.opts.allErrors=m),e.compositeRule=p.compositeRule=f,a+=" if ("+h+") {   ";var v=v||[];v.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be valid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var g=a;a=v.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(a+=" } ")}else a+="  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be valid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(a+=" if (false) { ");return a}},9489:(e,t,r)=>{"use strict";const a=r(6262);e.exports=(e,t,r,n,s)=>{"string"==typeof r&&(s=n,n=r,r=void 0);try{return new a(e instanceof a?e.version:e,r).inc(t,n,s).version}catch(e){return null}}},9525:e=>{"use strict";const t=/^[0-9]+$/,r=(e,r)=>{if("number"==typeof e&&"number"==typeof r)return e===r?0:e<r?-1:1;const a=t.test(e),n=t.test(r);return a&&n&&(e=+e,r=+r),e===r?0:a&&!n?-1:n&&!a?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},9816:e=>{"use strict";e.exports=function(e,t,r){var a=" ",n=e.level,s=e.dataLevel,o=e.schema[t],i=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(s||""),d="errs__"+n,p=e.util.copy(e),h="";p.level++;var m="valid"+p.level,f="key"+n,v="idx"+n,g=p.dataLevel=e.dataLevel+1,y="data"+g,_="dataProperties"+n,b=Object.keys(o||{}).filter(T),E=e.schema.patternProperties||{},w=Object.keys(E).filter(T),P=e.schema.additionalProperties,x=b.length||w.length,S=!1===P,O="object"==typeof P&&Object.keys(P).length,k=e.opts.removeAdditional,C=S||O||k,I=e.opts.ownProperties,$=e.baseId,A=e.schema.required;if(A&&(!e.opts.$data||!A.$data)&&A.length<e.opts.loopRequired)var R=e.util.toHash(A);function T(e){return"__proto__"!==e}if(a+="var "+d+" = errors;var "+m+" = true;",I&&(a+=" var "+_+" = undefined;"),C){if(a+=I?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+v+"=0; "+v+"<"+_+".length; "+v+"++) { var "+f+" = "+_+"["+v+"]; ":" for (var "+f+" in "+u+") { ",x){if(a+=" var isAdditional"+n+" = !(false ",b.length)if(b.length>8)a+=" || validate.schema"+i+".hasOwnProperty("+f+") ";else{var j=b;if(j)for(var L=-1,F=j.length-1;L<F;)Q=j[L+=1],a+=" || "+f+" == "+e.util.toQuotedString(Q)+" "}if(w.length){var N=w;if(N)for(var D=-1,M=N.length-1;D<M;)se=N[D+=1],a+=" || "+e.usePattern(se)+".test("+f+") "}a+=" ); if (isAdditional"+n+") { "}if("all"==k)a+=" delete "+u+"["+f+"]; ";else{var z=e.errorPath,U="' + "+f+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers)),S)if(k)a+=" delete "+u+"["+f+"]; ";else{a+=" "+m+" = false; ";var q=l;l=e.errSchemaPath+"/additionalProperties",(re=re||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+U+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is an invalid additional property":a+="should NOT have additional properties",a+="' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var V=a;a=re.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+V+"]); ":a+=" validate.errors = ["+V+"]; return false; ":a+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=q,c&&(a+=" break; ")}else if(O)if("failing"==k){a+=" var "+d+" = errors;  ";var Z=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=P,p.schemaPath=e.schemaPath+".additionalProperties",p.errSchemaPath=e.errSchemaPath+"/additionalProperties",p.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);var H=u+"["+f+"]";p.dataPathArr[g]=f;var B=e.validate(p);p.baseId=$,e.util.varOccurences(B,y)<2?a+=" "+e.util.varReplace(B,y,H)+" ":a+=" var "+y+" = "+H+"; "+B+" ",a+=" if (!"+m+") { errors = "+d+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+u+"["+f+"]; }  ",e.compositeRule=p.compositeRule=Z}else p.schema=P,p.schemaPath=e.schemaPath+".additionalProperties",p.errSchemaPath=e.errSchemaPath+"/additionalProperties",p.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers),H=u+"["+f+"]",p.dataPathArr[g]=f,B=e.validate(p),p.baseId=$,e.util.varOccurences(B,y)<2?a+=" "+e.util.varReplace(B,y,H)+" ":a+=" var "+y+" = "+H+"; "+B+" ",c&&(a+=" if (!"+m+") break; ");e.errorPath=z}x&&(a+=" } "),a+=" }  ",c&&(a+=" if ("+m+") { ",h+="}")}var G=e.opts.useDefaults&&!e.compositeRule;if(b.length){var K=b;if(K)for(var Q,W=-1,J=K.length-1;W<J;){var X=o[Q=K[W+=1]];if(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all)){var Y=e.util.getProperty(Q),ee=(H=u+Y,G&&void 0!==X.default);if(p.schema=X,p.schemaPath=i+Y,p.errSchemaPath=l+"/"+e.util.escapeFragment(Q),p.errorPath=e.util.getPath(e.errorPath,Q,e.opts.jsonPointers),p.dataPathArr[g]=e.util.toQuotedString(Q),B=e.validate(p),p.baseId=$,e.util.varOccurences(B,y)<2){B=e.util.varReplace(B,y,H);var te=H}else te=y,a+=" var "+y+" = "+H+"; ";if(ee)a+=" "+B+" ";else{if(R&&R[Q]){a+=" if ( "+te+" === undefined ",I&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Q)+"') "),a+=") { "+m+" = false; ",z=e.errorPath,q=l;var re,ae=e.util.escapeQuotes(Q);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(z,Q,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(re=re||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+ae+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+ae+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+i+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ",V=a,a=re.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+V+"]); ":a+=" validate.errors = ["+V+"]; return false; ":a+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=q,e.errorPath=z,a+=" } else { "}else c?(a+=" if ( "+te+" === undefined ",I&&(a+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Q)+"') "),a+=") { "+m+" = true; } else { "):(a+=" if ("+te+" !== undefined ",I&&(a+=" &&   Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Q)+"') "),a+=" ) { ");a+=" "+B+" } "}}c&&(a+=" if ("+m+") { ",h+="}")}}if(w.length){var ne=w;if(ne)for(var se,oe=-1,ie=ne.length-1;oe<ie;)X=E[se=ne[oe+=1]],(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all))&&(p.schema=X,p.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(se),p.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(se),a+=I?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+v+"=0; "+v+"<"+_+".length; "+v+"++) { var "+f+" = "+_+"["+v+"]; ":" for (var "+f+" in "+u+") { ",a+=" if ("+e.usePattern(se)+".test("+f+")) { ",p.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers),H=u+"["+f+"]",p.dataPathArr[g]=f,B=e.validate(p),p.baseId=$,e.util.varOccurences(B,y)<2?a+=" "+e.util.varReplace(B,y,H)+" ":a+=" var "+y+" = "+H+"; "+B+" ",c&&(a+=" if (!"+m+") break; "),a+=" } ",c&&(a+=" else "+m+" = true; "),a+=" }  ",c&&(a+=" if ("+m+") { ",h+="}"))}return c&&(a+=" "+h+" if ("+d+" == errors) {"),a}},9827:(e,t,r)=>{"use strict";var a=r(6696);e.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:a.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:a.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return o[e].call(r.exports,r,r.exports,l),r.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{"use strict";l.r(c),l.d(c,{plugin:()=>Ho});var e=l(7781),t=l(5959),r=l.n(t);const a="ac-container",n="ac-provider",s="ac-openai-api-key",o="ac-customize-openai-api-path",i="ac-openai-api-path",u="ac-openai-api-organization-id",d="ac-openai-api-url",p="ac-anthropic-api-key",h="ac-anthropic-api-url",m="ac-vector-enabled",f="ac-qdrant-address",v="ac-qdrant-secure",g="ac-qdrant-api-key",y="ac-grafana-vector-api-url",_="ac-vector-model",b="ac-submit-form",E="ac-basic-auth-username",w="ac-basic-auth-password",P="main-page-container",x="models-container",S="mcp-tools-container",O="mcp-tools-disabled",k="mcp-tools-loading",C="mcp-tools-error",I="mcp-tools-empty",$="mcp-tools-list",A="mcp-tools-tool-item",R="mcp-tools-tool-name",T="mcp-tools-tool-description";var j=function(e,t){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},j(e,t)};function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var F=function(){return F=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},F.apply(this,arguments)};function N(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function D(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=s.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function M(e,t,r){if(r||2===arguments.length)for(var a,n=0,s=t.length;n<s;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function z(e,r){void 0===r&&(r=[]);var a=function(e,r,a){void 0===r&&(r=[]),void 0===a&&(a={loading:!1});var n,s,o=(0,t.useRef)(0),i=(n=(0,t.useRef)(!1),s=(0,t.useCallback)(function(){return n.current},[]),(0,t.useEffect)(function(){return n.current=!0,function(){n.current=!1}},[]),s),l=(0,t.useState)(a),c=l[0],u=l[1],d=(0,t.useCallback)(function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=++o.current;return c.loading||u(function(e){return F(F({},e),{loading:!0})}),e.apply(void 0,t).then(function(e){return i()&&a===o.current&&u({value:e,loading:!1}),e},function(e){return i()&&a===o.current&&u({error:e,loading:!1}),e})},r);return[c,d]}(e,r,{loading:!0}),n=a[0],s=a[1];return(0,t.useEffect)(function(){s()},[s]),n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var U,q,V=l(8531);function Z(){const{error:e,loading:t,value:a}=z(()=>(0,V.getBackendSrv)().get("api/plugins/grafana-llm-app/resources/openai/v1/models"));return t?r().createElement("div",{"data-testid":x},r().createElement("span",null,"Loading...")):e||!a?r().createElement("div",{"data-testid":x},r().createElement("span",null,"Error loading models: ",null==e?void 0:e.message)):r().createElement("div",{"data-testid":x},r().createElement("h1",null,"Available Models"),r().createElement("pre",null,JSON.stringify(a,null,2)))}!function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),a={};for(const e of r)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(U||(U={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(q||(q={}));const H=U.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),B=e=>{switch(typeof e){case"undefined":return H.undefined;case"string":return H.string;case"number":return Number.isNaN(e)?H.nan:H.number;case"boolean":return H.boolean;case"function":return H.function;case"bigint":return H.bigint;case"symbol":return H.symbol;case"object":return Array.isArray(e)?H.array:null===e?H.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?H.promise:"undefined"!=typeof Map&&e instanceof Map?H.map:"undefined"!=typeof Set&&e instanceof Set?H.set:"undefined"!=typeof Date&&e instanceof Date?H.date:H.object;default:return H.unknown}},G=U.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class K extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(const n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(a);else if("invalid_return_type"===n.code)a(n.returnTypeError);else if("invalid_arguments"===n.code)a(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,a=0;for(;a<n.path.length;){const r=n.path[a];a===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}static assert(e){if(!(e instanceof K))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,U.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const a of this.issues)if(a.path.length>0){const r=a.path[0];t[r]=t[r]||[],t[r].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}K.create=e=>new K(e);const Q=(e,t)=>{let r;switch(e.code){case G.invalid_type:r=e.received===H.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case G.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,U.jsonStringifyReplacer)}`;break;case G.unrecognized_keys:r=`Unrecognized key(s) in object: ${U.joinValues(e.keys,", ")}`;break;case G.invalid_union:r="Invalid input";break;case G.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${U.joinValues(e.options)}`;break;case G.invalid_enum_value:r=`Invalid enum value. Expected ${U.joinValues(e.options)}, received '${e.received}'`;break;case G.invalid_arguments:r="Invalid function arguments";break;case G.invalid_return_type:r="Invalid function return type";break;case G.invalid_date:r="Invalid date";break;case G.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:U.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case G.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case G.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case G.custom:r="Invalid input";break;case G.invalid_intersection_types:r="Intersection results could not be merged";break;case G.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case G.not_finite:r="Number must be finite";break;default:r=t.defaultError,U.assertNever(e)}return{message:r}};let W=Q;var J;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(J||(J={}));function X(e,t){const r=W,a=(e=>{const{data:t,path:r,errorMaps:a,issueData:n}=e,s=[...r,...n.path||[]],o={...n,path:s};if(void 0!==n.message)return{...n,path:s,message:n.message};let i="";const l=a.filter(e=>!!e).slice().reverse();for(const e of l)i=e(o,{data:t,defaultError:i}).message;return{...n,path:s,message:i}})({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Q?void 0:Q].filter(e=>!!e)});e.common.issues.push(a)}class Y{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const a of t){if("aborted"===a.status)return ee;"dirty"===a.status&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t){const t=await e.key,a=await e.value;r.push({key:t,value:a})}return Y.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const a of t){const{key:t,value:n}=a;if("aborted"===t.status)return ee;if("aborted"===n.status)return ee;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"===t.value||void 0===n.value&&!a.alwaysSet||(r[t.value]=n.value)}return{status:e.value,value:r}}}const ee=Object.freeze({status:"aborted"}),te=e=>({status:"dirty",value:e}),re=e=>({status:"valid",value:e}),ae=e=>"aborted"===e.status,ne=e=>"dirty"===e.status,se=e=>"valid"===e.status,oe=e=>"undefined"!=typeof Promise&&e instanceof Promise;class ie{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const le=(e,t)=>{if(se(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new K(e.common.issues);return this._error=t,this._error}}};function ce(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:a,description:n}=e;if(t&&(r||a))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{const{message:s}=e;return"invalid_enum_value"===t.code?{message:s??n.defaultError}:void 0===n.data?{message:s??a??n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:s??r??n.defaultError}},description:n}}class ue{get description(){return this._def.description}_getType(e){return B(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:B(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Y,ctx:{common:e.parent.common,data:e.data,parsedType:B(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(oe(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:B(e)},a=this._parseSync({data:e,path:r.path,parent:r});return le(r,a)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:B(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return se(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>se(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:B(e)},a=this._parse({data:e,path:r.path,parent:r}),n=await(oe(a)?a:Promise.resolve(a));return le(r,n)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,a)=>{const n=e(t),s=()=>a.addIssue({code:G.custom,...r(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(s(),!1)):!!n||(s(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new dt({schema:this,typeName:bt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return pt.create(this,this._def)}nullable(){return ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ge.create(this)}promise(){return ut.create(this,this._def)}or(e){return We.create([this,e],this._def)}and(e){return et.create(this,e,this._def)}transform(e){return new dt({...ce(this._def),schema:this,typeName:bt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new mt({...ce(this._def),innerType:this,defaultValue:t,typeName:bt.ZodDefault})}brand(){return new gt({typeName:bt.ZodBranded,type:this,...ce(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ft({...ce(this._def),innerType:this,catchValue:t,typeName:bt.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return yt.create(this,e)}readonly(){return _t.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const de=/^c[^\s-]{8,}$/i,pe=/^[0-9a-z]+$/,he=/^[0-9A-HJKMNP-TV-Z]{26}$/i,me=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,fe=/^[a-z0-9_-]{21}$/i,ve=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ge=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ye=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let _e;const be=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ee=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,we=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Pe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Se=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Oe="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ke=new RegExp(`^${Oe}$`);function Ce(e){let t="[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function Ie(e){return new RegExp(`^${Ce(e)}$`)}function $e(e){let t=`${Oe}T${Ce(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Ae(e,t){return!("v4"!==t&&t||!be.test(e))||!("v6"!==t&&t||!we.test(e))}function Re(e,t){if(!ve.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));return!("object"!=typeof n||null===n||"typ"in n&&"JWT"!==n?.typ||!n.alg||t&&n.alg!==t)}catch{return!1}}function Te(e,t){return!("v4"!==t&&t||!Ee.test(e))||!("v6"!==t&&t||!Pe.test(e))}class je extends ue{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==H.string){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.string,received:t.parsedType}),ee}const t=new Y;let r;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){const n=e.data.length>a.value,s=e.data.length<a.value;(n||s)&&(r=this._getOrReturnCtx(e,r),n?X(r,{code:G.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):s&&X(r,{code:G.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)ye.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"email",code:G.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)_e||(_e=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),_e.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"emoji",code:G.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)me.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"uuid",code:G.invalid_string,message:a.message}),t.dirty());else if("nanoid"===a.kind)fe.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"nanoid",code:G.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)de.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"cuid",code:G.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)pe.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"cuid2",code:G.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)he.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"ulid",code:G.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),X(r,{validation:"url",code:G.invalid_string,message:a.message}),t.dirty()}else"regex"===a.kind?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"regex",code:G.invalid_string,message:a.message}),t.dirty())):"trim"===a.kind?e.data=e.data.trim():"includes"===a.kind?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty()):"toLowerCase"===a.kind?e.data=e.data.toLowerCase():"toUpperCase"===a.kind?e.data=e.data.toUpperCase():"startsWith"===a.kind?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty()):"endsWith"===a.kind?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty()):"datetime"===a.kind?$e(a).test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_string,validation:"datetime",message:a.message}),t.dirty()):"date"===a.kind?ke.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_string,validation:"date",message:a.message}),t.dirty()):"time"===a.kind?Ie(a).test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:G.invalid_string,validation:"time",message:a.message}),t.dirty()):"duration"===a.kind?ge.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"duration",code:G.invalid_string,message:a.message}),t.dirty()):"ip"===a.kind?Ae(e.data,a.version)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"ip",code:G.invalid_string,message:a.message}),t.dirty()):"jwt"===a.kind?Re(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"jwt",code:G.invalid_string,message:a.message}),t.dirty()):"cidr"===a.kind?Te(e.data,a.version)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"cidr",code:G.invalid_string,message:a.message}),t.dirty()):"base64"===a.kind?xe.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"base64",code:G.invalid_string,message:a.message}),t.dirty()):"base64url"===a.kind?Se.test(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{validation:"base64url",code:G.invalid_string,message:a.message}),t.dirty()):U.assertNever(a);return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:G.invalid_string,...J.errToObj(r)})}_addCheck(e){return new je({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...J.errToObj(e)})}url(e){return this._addCheck({kind:"url",...J.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...J.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...J.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...J.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...J.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...J.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...J.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...J.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...J.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...J.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...J.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...J.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...J.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...J.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...J.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...J.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...J.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...J.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...J.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...J.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...J.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...J.errToObj(t)})}nonempty(e){return this.min(1,J.errToObj(e))}trim(){return new je({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new je({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new je({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Le(e,t){const r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}je.create=e=>new je({checks:[],typeName:bt.ZodString,coerce:e?.coerce??!1,...ce(e)});class Fe extends ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==H.number){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.number,received:t.parsedType}),ee}let t;const r=new Y;for(const a of this._def.checks)"int"===a.kind?U.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),X(t,{code:G.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),X(t,{code:G.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),X(t,{code:G.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"multipleOf"===a.kind?0!==Le(e.data,a.value)&&(t=this._getOrReturnCtx(e,t),X(t,{code:G.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),X(t,{code:G.not_finite,message:a.message}),r.dirty()):U.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,J.toString(t))}gt(e,t){return this.setLimit("min",e,!1,J.toString(t))}lte(e,t){return this.setLimit("max",e,!0,J.toString(t))}lt(e,t){return this.setLimit("max",e,!1,J.toString(t))}setLimit(e,t,r,a){return new Fe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:J.toString(a)}]})}_addCheck(e){return new Fe({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:J.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:J.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:J.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:J.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:J.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:J.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:J.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:J.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:J.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&U.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Fe.create=e=>new Fe({checks:[],typeName:bt.ZodNumber,coerce:e?.coerce||!1,...ce(e)});class Ne extends ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==H.bigint)return this._getInvalidInput(e);let t;const r=new Y;for(const a of this._def.checks)"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),X(t,{code:G.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),X(t,{code:G.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),X(t,{code:G.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):U.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.bigint,received:t.parsedType}),ee}gte(e,t){return this.setLimit("min",e,!0,J.toString(t))}gt(e,t){return this.setLimit("min",e,!1,J.toString(t))}lte(e,t){return this.setLimit("max",e,!0,J.toString(t))}lt(e,t){return this.setLimit("max",e,!1,J.toString(t))}setLimit(e,t,r,a){return new Ne({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:J.toString(a)}]})}_addCheck(e){return new Ne({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:J.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:J.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:J.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:J.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:J.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Ne.create=e=>new Ne({checks:[],typeName:bt.ZodBigInt,coerce:e?.coerce??!1,...ce(e)});class De extends ue{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==H.boolean){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.boolean,received:t.parsedType}),ee}return re(e.data)}}De.create=e=>new De({typeName:bt.ZodBoolean,coerce:e?.coerce||!1,...ce(e)});class Me extends ue{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==H.date){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.date,received:t.parsedType}),ee}if(Number.isNaN(e.data.getTime()))return X(this._getOrReturnCtx(e),{code:G.invalid_date}),ee;const t=new Y;let r;for(const a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),t.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),X(r,{code:G.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),t.dirty()):U.assertNever(a);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Me({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:J.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:J.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Me.create=e=>new Me({checks:[],coerce:e?.coerce||!1,typeName:bt.ZodDate,...ce(e)});class ze extends ue{_parse(e){if(this._getType(e)!==H.symbol){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.symbol,received:t.parsedType}),ee}return re(e.data)}}ze.create=e=>new ze({typeName:bt.ZodSymbol,...ce(e)});class Ue extends ue{_parse(e){if(this._getType(e)!==H.undefined){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.undefined,received:t.parsedType}),ee}return re(e.data)}}Ue.create=e=>new Ue({typeName:bt.ZodUndefined,...ce(e)});class qe extends ue{_parse(e){if(this._getType(e)!==H.null){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.null,received:t.parsedType}),ee}return re(e.data)}}qe.create=e=>new qe({typeName:bt.ZodNull,...ce(e)});class Ve extends ue{constructor(){super(...arguments),this._any=!0}_parse(e){return re(e.data)}}Ve.create=e=>new Ve({typeName:bt.ZodAny,...ce(e)});class Ze extends ue{constructor(){super(...arguments),this._unknown=!0}_parse(e){return re(e.data)}}Ze.create=e=>new Ze({typeName:bt.ZodUnknown,...ce(e)});class He extends ue{_parse(e){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.never,received:t.parsedType}),ee}}He.create=e=>new He({typeName:bt.ZodNever,...ce(e)});class Be extends ue{_parse(e){if(this._getType(e)!==H.undefined){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.void,received:t.parsedType}),ee}return re(e.data)}}Be.create=e=>new Be({typeName:bt.ZodVoid,...ce(e)});class Ge extends ue{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==H.array)return X(t,{code:G.invalid_type,expected:H.array,received:t.parsedType}),ee;if(null!==a.exactLength){const e=t.data.length>a.exactLength.value,n=t.data.length<a.exactLength.value;(e||n)&&(X(t,{code:e?G.too_big:G.too_small,minimum:n?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(X(t,{code:G.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(X(t,{code:G.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new ie(t,e,t.path,r)))).then(e=>Y.mergeArray(r,e));const n=[...t.data].map((e,r)=>a.type._parseSync(new ie(t,e,t.path,r)));return Y.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new Ge({...this._def,minLength:{value:e,message:J.toString(t)}})}max(e,t){return new Ge({...this._def,maxLength:{value:e,message:J.toString(t)}})}length(e,t){return new Ge({...this._def,exactLength:{value:e,message:J.toString(t)}})}nonempty(e){return this.min(1,e)}}function Ke(e){if(e instanceof Qe){const t={};for(const r in e.shape){const a=e.shape[r];t[r]=pt.create(Ke(a))}return new Qe({...e._def,shape:()=>t})}return e instanceof Ge?new Ge({...e._def,type:Ke(e.element)}):e instanceof pt?pt.create(Ke(e.unwrap())):e instanceof ht?ht.create(Ke(e.unwrap())):e instanceof tt?tt.create(e.items.map(e=>Ke(e))):e}Ge.create=(e,t)=>new Ge({type:e,minLength:null,maxLength:null,exactLength:null,typeName:bt.ZodArray,...ce(t)});class Qe extends ue{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=U.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==H.object){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.object,received:t.parsedType}),ee}const{status:t,ctx:r}=this._processInputParams(e),{shape:a,keys:n}=this._getCached(),s=[];if(!(this._def.catchall instanceof He&&"strip"===this._def.unknownKeys))for(const e in r.data)n.includes(e)||s.push(e);const o=[];for(const e of n){const t=a[e],n=r.data[e];o.push({key:{status:"valid",value:e},value:t._parse(new ie(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof He){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of s)o.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(X(r,{code:G.unrecognized_keys,keys:s}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of s){const a=r.data[t];o.push({key:{status:"valid",value:t},value:e._parse(new ie(r,a,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of o){const r=await t.key,a=await t.value;e.push({key:r,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>Y.mergeObjectSync(t,e)):Y.mergeObjectSync(t,o)}get shape(){return this._def.shape()}strict(e){return J.errToObj,new Qe({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{const a=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:J.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new Qe({...this._def,unknownKeys:"strip"})}passthrough(){return new Qe({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:bt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Qe({...this._def,catchall:e})}pick(e){const t={};for(const r of U.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new Qe({...this._def,shape:()=>t})}omit(e){const t={};for(const r of U.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new Qe({...this._def,shape:()=>t})}deepPartial(){return Ke(this)}partial(e){const t={};for(const r of U.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new Qe({...this._def,shape:()=>t})}required(e){const t={};for(const r of U.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof pt;)e=e._def.innerType;t[r]=e}return new Qe({...this._def,shape:()=>t})}keyof(){return it(U.objectKeys(this.shape))}}Qe.create=(e,t)=>new Qe({shape:()=>e,unknownKeys:"strip",catchall:He.create(),typeName:bt.ZodObject,...ce(t)}),Qe.strictCreate=(e,t)=>new Qe({shape:()=>e,unknownKeys:"strict",catchall:He.create(),typeName:bt.ZodObject,...ce(t)}),Qe.lazycreate=(e,t)=>new Qe({shape:e,unknownKeys:"strip",catchall:He.create(),typeName:bt.ZodObject,...ce(t)});class We extends ue{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map(e=>new K(e.ctx.common.issues));return X(t,{code:G.invalid_union,unionErrors:r}),ee});{let e;const a=[];for(const n of r){const r={...t,common:{...t.common,issues:[]},parent:null},s=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const n=a.map(e=>new K(e));return X(t,{code:G.invalid_union,unionErrors:n}),ee}}get options(){return this._def.options}}We.create=(e,t)=>new We({options:e,typeName:bt.ZodUnion,...ce(t)});const Je=e=>e instanceof st?Je(e.schema):e instanceof dt?Je(e.innerType()):e instanceof ot?[e.value]:e instanceof lt?e.options:e instanceof ct?U.objectValues(e.enum):e instanceof mt?Je(e._def.innerType):e instanceof Ue?[void 0]:e instanceof qe?[null]:e instanceof pt?[void 0,...Je(e.unwrap())]:e instanceof ht?[null,...Je(e.unwrap())]:e instanceof gt||e instanceof _t?Je(e.unwrap()):e instanceof ft?Je(e._def.innerType):[];class Xe extends ue{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==H.object)return X(t,{code:G.invalid_type,expected:H.object,received:t.parsedType}),ee;const r=this.discriminator,a=t.data[r],n=this.optionsMap.get(a);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(X(t,{code:G.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ee)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const a=new Map;for(const r of t){const t=Je(r.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const n of t){if(a.has(n))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);a.set(n,r)}}return new Xe({typeName:bt.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...ce(r)})}}function Ye(e,t){const r=B(e),a=B(t);if(e===t)return{valid:!0,data:e};if(r===H.object&&a===H.object){const r=U.objectKeys(t),a=U.objectKeys(e).filter(e=>-1!==r.indexOf(e)),n={...e,...t};for(const r of a){const a=Ye(e[r],t[r]);if(!a.valid)return{valid:!1};n[r]=a.data}return{valid:!0,data:n}}if(r===H.array&&a===H.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let a=0;a<e.length;a++){const n=Ye(e[a],t[a]);if(!n.valid)return{valid:!1};r.push(n.data)}return{valid:!0,data:r}}return r===H.date&&a===H.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class et extends ue{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=(e,a)=>{if(ae(e)||ae(a))return ee;const n=Ye(e.value,a.value);return n.valid?((ne(e)||ne(a))&&t.dirty(),{status:t.value,value:n.data}):(X(r,{code:G.invalid_intersection_types}),ee)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>a(e,t)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}et.create=(e,t,r)=>new et({left:e,right:t,typeName:bt.ZodIntersection,...ce(r)});class tt extends ue{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==H.array)return X(r,{code:G.invalid_type,expected:H.array,received:r.parsedType}),ee;if(r.data.length<this._def.items.length)return X(r,{code:G.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ee;!this._def.rest&&r.data.length>this._def.items.length&&(X(r,{code:G.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((e,t)=>{const a=this._def.items[t]||this._def.rest;return a?a._parse(new ie(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(a).then(e=>Y.mergeArray(t,e)):Y.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new tt({...this._def,rest:e})}}tt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tt({items:e,typeName:bt.ZodTuple,rest:null,...ce(t)})};class rt extends ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==H.object)return X(r,{code:G.invalid_type,expected:H.object,received:r.parsedType}),ee;const a=[],n=this._def.keyType,s=this._def.valueType;for(const e in r.data)a.push({key:n._parse(new ie(r,e,r.path,e)),value:s._parse(new ie(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?Y.mergeObjectAsync(t,a):Y.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new rt(t instanceof ue?{keyType:e,valueType:t,typeName:bt.ZodRecord,...ce(r)}:{keyType:je.create(),valueType:e,typeName:bt.ZodRecord,...ce(t)})}}class at extends ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==H.map)return X(r,{code:G.invalid_type,expected:H.map,received:r.parsedType}),ee;const a=this._def.keyType,n=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:a._parse(new ie(r,e,r.path,[s,"key"])),value:n._parse(new ie(r,t,r.path,[s,"value"]))}));if(r.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const r of s){const a=await r.key,n=await r.value;if("aborted"===a.status||"aborted"===n.status)return ee;"dirty"!==a.status&&"dirty"!==n.status||t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}})}{const e=new Map;for(const r of s){const a=r.key,n=r.value;if("aborted"===a.status||"aborted"===n.status)return ee;"dirty"!==a.status&&"dirty"!==n.status||t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}}}}at.create=(e,t,r)=>new at({valueType:t,keyType:e,typeName:bt.ZodMap,...ce(r)});class nt extends ue{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==H.set)return X(r,{code:G.invalid_type,expected:H.set,received:r.parsedType}),ee;const a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&(X(r,{code:G.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&(X(r,{code:G.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const n=this._def.valueType;function s(e){const r=new Set;for(const a of e){if("aborted"===a.status)return ee;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}const o=[...r.data.values()].map((e,t)=>n._parse(new ie(r,e,r.path,t)));return r.common.async?Promise.all(o).then(e=>s(e)):s(o)}min(e,t){return new nt({...this._def,minSize:{value:e,message:J.toString(t)}})}max(e,t){return new nt({...this._def,maxSize:{value:e,message:J.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}nt.create=(e,t)=>new nt({valueType:e,minSize:null,maxSize:null,typeName:bt.ZodSet,...ce(t)});class st extends ue{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}st.create=(e,t)=>new st({getter:e,typeName:bt.ZodLazy,...ce(t)});class ot extends ue{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return X(t,{received:t.data,code:G.invalid_literal,expected:this._def.value}),ee}return{status:"valid",value:e.data}}get value(){return this._def.value}}function it(e,t){return new lt({values:e,typeName:bt.ZodEnum,...ce(t)})}ot.create=(e,t)=>new ot({value:e,typeName:bt.ZodLiteral,...ce(t)});class lt extends ue{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return X(t,{expected:U.joinValues(r),received:t.parsedType,code:G.invalid_type}),ee}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return X(t,{received:t.data,code:G.invalid_enum_value,options:r}),ee}return re(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return lt.create(e,{...this._def,...t})}exclude(e,t=this._def){return lt.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}lt.create=it;class ct extends ue{_parse(e){const t=U.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==H.string&&r.parsedType!==H.number){const e=U.objectValues(t);return X(r,{expected:U.joinValues(e),received:r.parsedType,code:G.invalid_type}),ee}if(this._cache||(this._cache=new Set(U.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=U.objectValues(t);return X(r,{received:r.data,code:G.invalid_enum_value,options:e}),ee}return re(e.data)}get enum(){return this._def.values}}ct.create=(e,t)=>new ct({values:e,typeName:bt.ZodNativeEnum,...ce(t)});class ut extends ue{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==H.promise&&!1===t.common.async)return X(t,{code:G.invalid_type,expected:H.promise,received:t.parsedType}),ee;const r=t.parsedType===H.promise?t.data:Promise.resolve(t.data);return re(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}ut.create=(e,t)=>new ut({type:e,typeName:bt.ZodPromise,...ce(t)});class dt extends ue{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===bt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,n={addIssue:e=>{X(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===a.type){const e=a.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return ee;const a=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===a.status?ee:"dirty"===a.status||"dirty"===t.value?te(a.value):a});{if("aborted"===t.value)return ee;const a=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===a.status?ee:"dirty"===a.status||"dirty"===t.value?te(a.value):a}}if("refinement"===a.type){const e=e=>{const t=a.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?ee:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?ee:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))))}if("transform"===a.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!se(e))return ee;const s=a.transform(e.value,n);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>se(e)?Promise.resolve(a.transform(e.value,n)).then(e=>({status:t.value,value:e})):ee)}U.assertNever(a)}}dt.create=(e,t,r)=>new dt({schema:e,typeName:bt.ZodEffects,effect:t,...ce(r)}),dt.createWithPreprocess=(e,t,r)=>new dt({schema:t,effect:{type:"preprocess",transform:e},typeName:bt.ZodEffects,...ce(r)});class pt extends ue{_parse(e){return this._getType(e)===H.undefined?re(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}pt.create=(e,t)=>new pt({innerType:e,typeName:bt.ZodOptional,...ce(t)});class ht extends ue{_parse(e){return this._getType(e)===H.null?re(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ht.create=(e,t)=>new ht({innerType:e,typeName:bt.ZodNullable,...ce(t)});class mt extends ue{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===H.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}mt.create=(e,t)=>new mt({innerType:e,typeName:bt.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...ce(t)});class ft extends ue{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return oe(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new K(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new K(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ft.create=(e,t)=>new ft({innerType:e,typeName:bt.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...ce(t)});class vt extends ue{_parse(e){if(this._getType(e)!==H.nan){const t=this._getOrReturnCtx(e);return X(t,{code:G.invalid_type,expected:H.nan,received:t.parsedType}),ee}return{status:"valid",value:e.data}}}vt.create=e=>new vt({typeName:bt.ZodNaN,...ce(e)}),Symbol("zod_brand");class gt extends ue{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class yt extends ue{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?ee:"dirty"===e.status?(t.dirty(),te(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?ee:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new yt({in:e,out:t,typeName:bt.ZodPipeline})}}class _t extends ue{_parse(e){const t=this._def.innerType._parse(e),r=e=>(se(e)&&(e.value=Object.freeze(e.value)),e);return oe(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}var bt;_t.create=(e,t)=>new _t({innerType:e,typeName:bt.ZodReadonly,...ce(t)}),Qe.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(bt||(bt={}));const Et=je.create,wt=Fe.create,Pt=(vt.create,Ne.create,De.create),xt=(Me.create,ze.create,Ue.create,qe.create,Ve.create),St=Ze.create,Ot=(He.create,Be.create,Ge.create),kt=Qe.create,Ct=(Qe.strictCreate,We.create),It=Xe.create,$t=(et.create,tt.create,rt.create),At=(at.create,nt.create,st.create,ot.create),Rt=lt.create,Tt=(ct.create,ut.create,dt.create,pt.create),jt=(ht.create,dt.createWithPreprocess,yt.create,ee),Lt="2025-06-18",Ft=[Lt,"2025-03-26","2024-11-05","2024-10-07"],Nt="2.0",Dt=Ct([Et(),wt().int()]),Mt=Et(),zt=kt({progressToken:Tt(Dt)}).passthrough(),Ut=kt({_meta:Tt(zt)}).passthrough(),qt=kt({method:Et(),params:Tt(Ut)}),Vt=kt({_meta:Tt(kt({}).passthrough())}).passthrough(),Zt=kt({method:Et(),params:Tt(Vt)}),Ht=kt({_meta:Tt(kt({}).passthrough())}).passthrough(),Bt=Ct([Et(),wt().int()]),Gt=kt({jsonrpc:At(Nt),id:Bt}).merge(qt).strict(),Kt=e=>Gt.safeParse(e).success,Qt=kt({jsonrpc:At(Nt)}).merge(Zt).strict(),Wt=kt({jsonrpc:At(Nt),id:Bt,result:Ht}).strict(),Jt=e=>Wt.safeParse(e).success;var Xt;!function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(Xt||(Xt={}));const Yt=kt({jsonrpc:At(Nt),id:Bt,error:kt({code:wt().int(),message:Et(),data:Tt(St())})}).strict(),er=Ct([Gt,Qt,Wt,Yt]),tr=Ht.strict(),rr=Zt.extend({method:At("notifications/cancelled"),params:Vt.extend({requestId:Bt,reason:Et().optional()})}),ar=kt({src:Et(),mimeType:Tt(Et()),sizes:Tt(Ot(Et()))}).passthrough(),nr=kt({icons:Ot(ar).optional()}).passthrough(),sr=kt({name:Et(),title:Tt(Et())}).passthrough(),or=sr.extend({version:Et(),websiteUrl:Tt(Et())}).merge(nr),ir=kt({experimental:Tt(kt({}).passthrough()),sampling:Tt(kt({}).passthrough()),elicitation:Tt(kt({}).passthrough()),roots:Tt(kt({listChanged:Tt(Pt())}).passthrough())}).passthrough(),lr=qt.extend({method:At("initialize"),params:Ut.extend({protocolVersion:Et(),capabilities:ir,clientInfo:or})}),cr=kt({experimental:Tt(kt({}).passthrough()),logging:Tt(kt({}).passthrough()),completions:Tt(kt({}).passthrough()),prompts:Tt(kt({listChanged:Tt(Pt())}).passthrough()),resources:Tt(kt({subscribe:Tt(Pt()),listChanged:Tt(Pt())}).passthrough()),tools:Tt(kt({listChanged:Tt(Pt())}).passthrough())}).passthrough(),ur=Ht.extend({protocolVersion:Et(),capabilities:cr,serverInfo:or,instructions:Tt(Et())}),dr=Zt.extend({method:At("notifications/initialized")}),pr=qt.extend({method:At("ping")}),hr=kt({progress:wt(),total:Tt(wt()),message:Tt(Et())}).passthrough(),mr=Zt.extend({method:At("notifications/progress"),params:Vt.merge(hr).extend({progressToken:Dt})}),fr=qt.extend({params:Ut.extend({cursor:Tt(Mt)}).optional()}),vr=Ht.extend({nextCursor:Tt(Mt)}),gr=kt({uri:Et(),mimeType:Tt(Et()),_meta:Tt(kt({}).passthrough())}).passthrough(),yr=gr.extend({text:Et()}),_r=Et().refine(e=>{try{return atob(e),!0}catch(e){return!1}},{message:"Invalid Base64 string"}),br=gr.extend({blob:_r}),Er=sr.extend({uri:Et(),description:Tt(Et()),mimeType:Tt(Et()),_meta:Tt(kt({}).passthrough())}).merge(nr),wr=sr.extend({uriTemplate:Et(),description:Tt(Et()),mimeType:Tt(Et()),_meta:Tt(kt({}).passthrough())}).merge(nr),Pr=fr.extend({method:At("resources/list")}),xr=vr.extend({resources:Ot(Er)}),Sr=fr.extend({method:At("resources/templates/list")}),Or=vr.extend({resourceTemplates:Ot(wr)}),kr=qt.extend({method:At("resources/read"),params:Ut.extend({uri:Et()})}),Cr=Ht.extend({contents:Ot(Ct([yr,br]))}),Ir=Zt.extend({method:At("notifications/resources/list_changed")}),$r=qt.extend({method:At("resources/subscribe"),params:Ut.extend({uri:Et()})}),Ar=qt.extend({method:At("resources/unsubscribe"),params:Ut.extend({uri:Et()})}),Rr=Zt.extend({method:At("notifications/resources/updated"),params:Vt.extend({uri:Et()})}),Tr=kt({name:Et(),description:Tt(Et()),required:Tt(Pt())}).passthrough(),jr=sr.extend({description:Tt(Et()),arguments:Tt(Ot(Tr)),_meta:Tt(kt({}).passthrough())}).merge(nr),Lr=fr.extend({method:At("prompts/list")}),Fr=vr.extend({prompts:Ot(jr)}),Nr=qt.extend({method:At("prompts/get"),params:Ut.extend({name:Et(),arguments:Tt($t(Et()))})}),Dr=kt({type:At("text"),text:Et(),_meta:Tt(kt({}).passthrough())}).passthrough(),Mr=kt({type:At("image"),data:_r,mimeType:Et(),_meta:Tt(kt({}).passthrough())}).passthrough(),zr=kt({type:At("audio"),data:_r,mimeType:Et(),_meta:Tt(kt({}).passthrough())}).passthrough(),Ur=kt({type:At("resource"),resource:Ct([yr,br]),_meta:Tt(kt({}).passthrough())}).passthrough(),qr=Ct([Dr,Mr,zr,Er.extend({type:At("resource_link")}),Ur]),Vr=kt({role:Rt(["user","assistant"]),content:qr}).passthrough(),Zr=Ht.extend({description:Tt(Et()),messages:Ot(Vr)}),Hr=Zt.extend({method:At("notifications/prompts/list_changed")}),Br=kt({title:Tt(Et()),readOnlyHint:Tt(Pt()),destructiveHint:Tt(Pt()),idempotentHint:Tt(Pt()),openWorldHint:Tt(Pt())}).passthrough(),Gr=sr.extend({description:Tt(Et()),inputSchema:kt({type:At("object"),properties:Tt(kt({}).passthrough()),required:Tt(Ot(Et()))}).passthrough(),outputSchema:Tt(kt({type:At("object"),properties:Tt(kt({}).passthrough()),required:Tt(Ot(Et()))}).passthrough()),annotations:Tt(Br),_meta:Tt(kt({}).passthrough())}).merge(nr),Kr=fr.extend({method:At("tools/list")}),Qr=vr.extend({tools:Ot(Gr)}),Wr=Ht.extend({content:Ot(qr).default([]),structuredContent:kt({}).passthrough().optional(),isError:Tt(Pt())}),Jr=(Wr.or(Ht.extend({toolResult:St()})),qt.extend({method:At("tools/call"),params:Ut.extend({name:Et(),arguments:Tt($t(St()))})})),Xr=Zt.extend({method:At("notifications/tools/list_changed")}),Yr=Rt(["debug","info","notice","warning","error","critical","alert","emergency"]),ea=qt.extend({method:At("logging/setLevel"),params:Ut.extend({level:Yr})}),ta=Zt.extend({method:At("notifications/message"),params:Vt.extend({level:Yr,logger:Tt(Et()),data:St()})}),ra=kt({name:Et().optional()}).passthrough(),aa=kt({hints:Tt(Ot(ra)),costPriority:Tt(wt().min(0).max(1)),speedPriority:Tt(wt().min(0).max(1)),intelligencePriority:Tt(wt().min(0).max(1))}).passthrough(),na=kt({role:Rt(["user","assistant"]),content:Ct([Dr,Mr,zr])}).passthrough(),sa=qt.extend({method:At("sampling/createMessage"),params:Ut.extend({messages:Ot(na),systemPrompt:Tt(Et()),includeContext:Tt(Rt(["none","thisServer","allServers"])),temperature:Tt(wt()),maxTokens:wt().int(),stopSequences:Tt(Ot(Et())),metadata:Tt(kt({}).passthrough()),modelPreferences:Tt(aa)})}),oa=Ht.extend({model:Et(),stopReason:Tt(Rt(["endTurn","stopSequence","maxTokens"]).or(Et())),role:Rt(["user","assistant"]),content:It("type",[Dr,Mr,zr])}),ia=Ct([kt({type:At("boolean"),title:Tt(Et()),description:Tt(Et()),default:Tt(Pt())}).passthrough(),kt({type:At("string"),title:Tt(Et()),description:Tt(Et()),minLength:Tt(wt()),maxLength:Tt(wt()),format:Tt(Rt(["email","uri","date","date-time"]))}).passthrough(),kt({type:Rt(["number","integer"]),title:Tt(Et()),description:Tt(Et()),minimum:Tt(wt()),maximum:Tt(wt())}).passthrough(),kt({type:At("string"),title:Tt(Et()),description:Tt(Et()),enum:Ot(Et()),enumNames:Tt(Ot(Et()))}).passthrough()]),la=qt.extend({method:At("elicitation/create"),params:Ut.extend({message:Et(),requestedSchema:kt({type:At("object"),properties:$t(Et(),ia),required:Tt(Ot(Et()))}).passthrough()})}),ca=Ht.extend({action:Rt(["accept","decline","cancel"]),content:Tt($t(Et(),St()))}),ua=kt({type:At("ref/resource"),uri:Et()}).passthrough(),da=kt({type:At("ref/prompt"),name:Et()}).passthrough(),pa=qt.extend({method:At("completion/complete"),params:Ut.extend({ref:Ct([da,ua]),argument:kt({name:Et(),value:Et()}).passthrough(),context:Tt(kt({arguments:Tt($t(Et(),Et()))}))})}),ha=Ht.extend({completion:kt({values:Ot(Et()).max(100),total:Tt(wt().int()),hasMore:Tt(Pt())}).passthrough()}),ma=kt({uri:Et().startsWith("file://"),name:Tt(Et()),_meta:Tt(kt({}).passthrough())}).passthrough(),fa=qt.extend({method:At("roots/list")}),va=Ht.extend({roots:Ot(ma)}),ga=Zt.extend({method:At("notifications/roots/list_changed")});Ct([pr,lr,pa,ea,Nr,Lr,Pr,Sr,kr,$r,Ar,Jr,Kr]),Ct([rr,mr,dr,ga]),Ct([tr,oa,ca,va]),Ct([pr,sa,la,fa]),Ct([rr,mr,ta,Rr,Ir,Xr,Hr]),Ct([tr,ur,ha,Zr,Fr,xr,Or,Cr,Wr,Qr]);class ya extends Error{constructor(e,t,r){super(`MCP error ${e}: ${t}`),this.code=e,this.data=r,this.name="McpError"}}class _a{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(rr,e=>{const t=this._requestHandlerAbortControllers.get(e.params.requestId);null==t||t.abort(e.params.reason)}),this.setNotificationHandler(mr,e=>{this._onprogress(e)}),this.setRequestHandler(pr,e=>({}))}_setupTimeout(e,t,r,a,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(a,t),startTime:Date.now(),timeout:t,maxTotalTimeout:r,resetTimeoutOnProgress:n,onTimeout:a})}_resetTimeout(e){const t=this._timeoutInfo.get(e);if(!t)return!1;const r=Date.now()-t.startTime;if(t.maxTotalTimeout&&r>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new ya(Xt.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:r});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),!0}_cleanupTimeout(e){const t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var t,r,a;this._transport=e;const n=null===(t=this.transport)||void 0===t?void 0:t.onclose;this._transport.onclose=()=>{null==n||n(),this._onclose()};const s=null===(r=this.transport)||void 0===r?void 0:r.onerror;this._transport.onerror=e=>{null==s||s(e),this._onerror(e)};const o=null===(a=this._transport)||void 0===a?void 0:a.onmessage;this._transport.onmessage=(e,t)=>{var r;null==o||o(e,t),Jt(e)||(r=e,Yt.safeParse(r).success)?this._onresponse(e):Kt(e)?this._onrequest(e,t):(e=>Qt.safeParse(e).success)(e)?this._onnotification(e):this._onerror(new Error(`Unknown message type: ${JSON.stringify(e)}`))},await this._transport.start()}_onclose(){var e;const t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,null===(e=this.onclose)||void 0===e||e.call(this);const r=new ya(Xt.ConnectionClosed,"Connection closed");for(const e of t.values())e(r)}_onerror(e){var t;null===(t=this.onerror)||void 0===t||t.call(this,e)}_onnotification(e){var t;const r=null!==(t=this._notificationHandlers.get(e.method))&&void 0!==t?t:this.fallbackNotificationHandler;void 0!==r&&Promise.resolve().then(()=>r(e)).catch(e=>this._onerror(new Error(`Uncaught error in notification handler: ${e}`)))}_onrequest(e,t){var r,a;const n=null!==(r=this._requestHandlers.get(e.method))&&void 0!==r?r:this.fallbackRequestHandler,s=this._transport;if(void 0===n)return void(null==s||s.send({jsonrpc:"2.0",id:e.id,error:{code:Xt.MethodNotFound,message:"Method not found"}}).catch(e=>this._onerror(new Error(`Failed to send an error response: ${e}`))));const o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);const i={signal:o.signal,sessionId:null==s?void 0:s.sessionId,_meta:null===(a=e.params)||void 0===a?void 0:a._meta,sendNotification:t=>this.notification(t,{relatedRequestId:e.id}),sendRequest:(t,r,a)=>this.request(t,r,{...a,relatedRequestId:e.id}),authInfo:null==t?void 0:t.authInfo,requestId:e.id,requestInfo:null==t?void 0:t.requestInfo};Promise.resolve().then(()=>n(e,i)).then(t=>{if(!o.signal.aborted)return null==s?void 0:s.send({result:t,jsonrpc:"2.0",id:e.id})},t=>{var r;if(!o.signal.aborted)return null==s?void 0:s.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(t.code)?t.code:Xt.InternalError,message:null!==(r=t.message)&&void 0!==r?r:"Internal error"}})}).catch(e=>this._onerror(new Error(`Failed to send response: ${e}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:t,...r}=e.params,a=Number(t),n=this._progressHandlers.get(a);if(!n)return void this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));const s=this._responseHandlers.get(a),o=this._timeoutInfo.get(a);if(o&&s&&o.resetTimeoutOnProgress)try{this._resetTimeout(a)}catch(e){return void s(e)}n(r)}_onresponse(e){const t=Number(e.id),r=this._responseHandlers.get(t);void 0!==r?(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),Jt(e)?r(e):r(new ya(e.error.code,e.error.message,e.error.data))):this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`))}get transport(){return this._transport}async close(){var e;await(null===(e=this._transport)||void 0===e?void 0:e.close())}request(e,t,r){const{relatedRequestId:a,resumptionToken:n,onresumptiontoken:s}=null!=r?r:{};return new Promise((o,i)=>{var l,c,u,d,p,h;if(!this._transport)return void i(new Error("Not connected"));!0===(null===(l=this._options)||void 0===l?void 0:l.enforceStrictCapabilities)&&this.assertCapabilityForMethod(e.method),null===(c=null==r?void 0:r.signal)||void 0===c||c.throwIfAborted();const m=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:m};(null==r?void 0:r.onprogress)&&(this._progressHandlers.set(m,r.onprogress),f.params={...e.params,_meta:{...(null===(u=e.params)||void 0===u?void 0:u._meta)||{},progressToken:m}});const v=e=>{var t;this._responseHandlers.delete(m),this._progressHandlers.delete(m),this._cleanupTimeout(m),null===(t=this._transport)||void 0===t||t.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:m,reason:String(e)}},{relatedRequestId:a,resumptionToken:n,onresumptiontoken:s}).catch(e=>this._onerror(new Error(`Failed to send cancellation: ${e}`))),i(e)};this._responseHandlers.set(m,e=>{var a;if(!(null===(a=null==r?void 0:r.signal)||void 0===a?void 0:a.aborted)){if(e instanceof Error)return i(e);try{const r=t.parse(e.result);o(r)}catch(e){i(e)}}}),null===(d=null==r?void 0:r.signal)||void 0===d||d.addEventListener("abort",()=>{var e;v(null===(e=null==r?void 0:r.signal)||void 0===e?void 0:e.reason)});const g=null!==(p=null==r?void 0:r.timeout)&&void 0!==p?p:6e4;this._setupTimeout(m,g,null==r?void 0:r.maxTotalTimeout,()=>v(new ya(Xt.RequestTimeout,"Request timed out",{timeout:g})),null!==(h=null==r?void 0:r.resetTimeoutOnProgress)&&void 0!==h&&h),this._transport.send(f,{relatedRequestId:a,resumptionToken:n,onresumptiontoken:s}).catch(e=>{this._cleanupTimeout(m),i(e)})})}async notification(e,t){var r,a;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),(null!==(a=null===(r=this._options)||void 0===r?void 0:r.debouncedNotificationMethods)&&void 0!==a?a:[]).includes(e.method)&&!e.params&&!(null==t?void 0:t.relatedRequestId)){if(this._pendingDebouncedNotifications.has(e.method))return;return this._pendingDebouncedNotifications.add(e.method),void Promise.resolve().then(()=>{var r;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;const a={...e,jsonrpc:"2.0"};null===(r=this._transport)||void 0===r||r.send(a,t).catch(e=>this._onerror(e))})}const n={...e,jsonrpc:"2.0"};await this._transport.send(n,t)}setRequestHandler(e,t){const r=e.shape.method.value;this.assertRequestHandlerCapability(r),this._requestHandlers.set(r,(r,a)=>Promise.resolve(t(e.parse(r),a)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,r=>Promise.resolve(t(e.parse(r))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}}var ba=l(5217);class Ea extends _a{constructor(e,t){var r;super(t),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._capabilities=null!==(r=null==t?void 0:t.capabilities)&&void 0!==r?r:{},this._ajv=new ba}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");var t,r;this._capabilities=(t=this._capabilities,r=e,Object.entries(r).reduce((e,[t,r])=>(e[t]=r&&"object"==typeof r&&e[t]?{...e[t],...r}:r,e),{...t}))}assertCapability(e,t){var r;if(!(null===(r=this._serverCapabilities)||void 0===r?void 0:r[e]))throw new Error(`Server does not support ${e} (required for ${t})`)}async connect(e,t){if(await super.connect(e),void 0===e.sessionId)try{const r=await this.request({method:"initialize",params:{protocolVersion:Lt,capabilities:this._capabilities,clientInfo:this._clientInfo}},ur,t);if(void 0===r)throw new Error(`Server sent invalid initialize result: ${r}`);if(!Ft.includes(r.protocolVersion))throw new Error(`Server's protocol version is not supported: ${r.protocolVersion}`);this._serverCapabilities=r.capabilities,this._serverVersion=r.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(r.protocolVersion),this._instructions=r.instructions,await this.notification({method:"notifications/initialized"})}catch(e){throw this.close(),e}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var t,r,a,n,s;switch(e){case"logging/setLevel":if(!(null===(t=this._serverCapabilities)||void 0===t?void 0:t.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(null===(r=this._serverCapabilities)||void 0===r?void 0:r.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(null===(a=this._serverCapabilities)||void 0===a?void 0:a.resources))throw new Error(`Server does not support resources (required for ${e})`);if("resources/subscribe"===e&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(null===(n=this._serverCapabilities)||void 0===n?void 0:n.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(null===(s=this._serverCapabilities)||void 0===s?void 0:s.completions))throw new Error(`Server does not support completions (required for ${e})`)}}assertNotificationCapability(e){var t;if("notifications/roots/list_changed"===e&&!(null===(t=this._capabilities.roots)||void 0===t?void 0:t.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`)}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`)}}async ping(e){return this.request({method:"ping"},tr,e)}async complete(e,t){return this.request({method:"completion/complete",params:e},ha,t)}async setLoggingLevel(e,t){return this.request({method:"logging/setLevel",params:{level:e}},tr,t)}async getPrompt(e,t){return this.request({method:"prompts/get",params:e},Zr,t)}async listPrompts(e,t){return this.request({method:"prompts/list",params:e},Fr,t)}async listResources(e,t){return this.request({method:"resources/list",params:e},xr,t)}async listResourceTemplates(e,t){return this.request({method:"resources/templates/list",params:e},Or,t)}async readResource(e,t){return this.request({method:"resources/read",params:e},Cr,t)}async subscribeResource(e,t){return this.request({method:"resources/subscribe",params:e},tr,t)}async unsubscribeResource(e,t){return this.request({method:"resources/unsubscribe",params:e},tr,t)}async callTool(e,t=Wr,r){const a=await this.request({method:"tools/call",params:e},t,r),n=this.getToolOutputValidator(e.name);if(n){if(!a.structuredContent&&!a.isError)throw new ya(Xt.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(a.structuredContent)try{if(!n(a.structuredContent))throw new ya(Xt.InvalidParams,`Structured content does not match the tool's output schema: ${this._ajv.errorsText(n.errors)}`)}catch(e){if(e instanceof ya)throw e;throw new ya(Xt.InvalidParams,`Failed to validate structured content: ${e instanceof Error?e.message:String(e)}`)}}return a}cacheToolOutputSchemas(e){this._cachedToolOutputValidators.clear();for(const t of e)if(t.outputSchema)try{const e=this._ajv.compile(t.outputSchema);this._cachedToolOutputValidators.set(t.name,e)}catch(e){}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,t){const r=await this.request({method:"tools/list",params:e},Qr,t);return this.cacheToolOutputSchemas(r.tools),r}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}let wa;async function Pa(e){const t=await(await wa).subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function xa(e){if(e||(e=43),e<43||e>128)throw`Expected a length between 43 and 128. Received ${e}.`;const t=await async function(e){return await async function(e){let t="";const r=await async function(e){return(await wa).getRandomValues(new Uint8Array(e))}(e);for(let a=0;a<e;a++)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~"[r[a]%66];return t}(e)}(e);return{code_verifier:t,code_challenge:await Pa(t)}}wa=globalThis.crypto;const Sa=Et().url().superRefine((e,t)=>{if(!URL.canParse(e))return t.addIssue({code:G.custom,message:"URL must be parseable",fatal:!0}),jt}).refine(e=>{const t=new URL(e);return"javascript:"!==t.protocol&&"data:"!==t.protocol&&"vbscript:"!==t.protocol},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),Oa=kt({resource:Et().url(),authorization_servers:Ot(Sa).optional(),jwks_uri:Et().url().optional(),scopes_supported:Ot(Et()).optional(),bearer_methods_supported:Ot(Et()).optional(),resource_signing_alg_values_supported:Ot(Et()).optional(),resource_name:Et().optional(),resource_documentation:Et().optional(),resource_policy_uri:Et().url().optional(),resource_tos_uri:Et().url().optional(),tls_client_certificate_bound_access_tokens:Pt().optional(),authorization_details_types_supported:Ot(Et()).optional(),dpop_signing_alg_values_supported:Ot(Et()).optional(),dpop_bound_access_tokens_required:Pt().optional()}).passthrough(),ka=kt({issuer:Et(),authorization_endpoint:Sa,token_endpoint:Sa,registration_endpoint:Sa.optional(),scopes_supported:Ot(Et()).optional(),response_types_supported:Ot(Et()),response_modes_supported:Ot(Et()).optional(),grant_types_supported:Ot(Et()).optional(),token_endpoint_auth_methods_supported:Ot(Et()).optional(),token_endpoint_auth_signing_alg_values_supported:Ot(Et()).optional(),service_documentation:Sa.optional(),revocation_endpoint:Sa.optional(),revocation_endpoint_auth_methods_supported:Ot(Et()).optional(),revocation_endpoint_auth_signing_alg_values_supported:Ot(Et()).optional(),introspection_endpoint:Et().optional(),introspection_endpoint_auth_methods_supported:Ot(Et()).optional(),introspection_endpoint_auth_signing_alg_values_supported:Ot(Et()).optional(),code_challenge_methods_supported:Ot(Et()).optional()}).passthrough(),Ca=kt({issuer:Et(),authorization_endpoint:Sa,token_endpoint:Sa,userinfo_endpoint:Sa.optional(),jwks_uri:Sa,registration_endpoint:Sa.optional(),scopes_supported:Ot(Et()).optional(),response_types_supported:Ot(Et()),response_modes_supported:Ot(Et()).optional(),grant_types_supported:Ot(Et()).optional(),acr_values_supported:Ot(Et()).optional(),subject_types_supported:Ot(Et()),id_token_signing_alg_values_supported:Ot(Et()),id_token_encryption_alg_values_supported:Ot(Et()).optional(),id_token_encryption_enc_values_supported:Ot(Et()).optional(),userinfo_signing_alg_values_supported:Ot(Et()).optional(),userinfo_encryption_alg_values_supported:Ot(Et()).optional(),userinfo_encryption_enc_values_supported:Ot(Et()).optional(),request_object_signing_alg_values_supported:Ot(Et()).optional(),request_object_encryption_alg_values_supported:Ot(Et()).optional(),request_object_encryption_enc_values_supported:Ot(Et()).optional(),token_endpoint_auth_methods_supported:Ot(Et()).optional(),token_endpoint_auth_signing_alg_values_supported:Ot(Et()).optional(),display_values_supported:Ot(Et()).optional(),claim_types_supported:Ot(Et()).optional(),claims_supported:Ot(Et()).optional(),service_documentation:Et().optional(),claims_locales_supported:Ot(Et()).optional(),ui_locales_supported:Ot(Et()).optional(),claims_parameter_supported:Pt().optional(),request_parameter_supported:Pt().optional(),request_uri_parameter_supported:Pt().optional(),require_request_uri_registration:Pt().optional(),op_policy_uri:Sa.optional(),op_tos_uri:Sa.optional()}).passthrough().merge(ka.pick({code_challenge_methods_supported:!0})),Ia=kt({access_token:Et(),id_token:Et().optional(),token_type:Et(),expires_in:wt().optional(),scope:Et().optional(),refresh_token:Et().optional()}).strip(),$a=kt({error:Et(),error_description:Et().optional(),error_uri:Et().optional()}),Aa=Sa.optional().or(At("").transform(()=>{})),Ra=kt({redirect_uris:Ot(Sa),token_endpoint_auth_method:Et().optional(),grant_types:Ot(Et()).optional(),response_types:Ot(Et()).optional(),client_name:Et().optional(),client_uri:Sa.optional(),logo_uri:Aa,scope:Et().optional(),contacts:Ot(Et()).optional(),tos_uri:Aa,policy_uri:Et().optional(),jwks_uri:Sa.optional(),jwks:xt().optional(),software_id:Et().optional(),software_version:Et().optional(),software_statement:Et().optional()}).strip(),Ta=kt({client_id:Et(),client_secret:Et().optional(),client_id_issued_at:wt().optional(),client_secret_expires_at:wt().optional()}).strip(),ja=Ra.merge(Ta);kt({error:Et(),error_description:Et().optional()}).strip(),kt({token:Et(),token_type_hint:Et().optional()}).strip();class La extends Error{constructor(e,t){super(e),this.errorUri=t,this.name=this.constructor.name}toResponseObject(){const e={error:this.errorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}get errorCode(){return this.constructor.errorCode}}class Fa extends La{}Fa.errorCode="invalid_request";class Na extends La{}Na.errorCode="invalid_client";class Da extends La{}Da.errorCode="invalid_grant";class Ma extends La{}Ma.errorCode="unauthorized_client";class za extends La{}za.errorCode="unsupported_grant_type";class Ua extends La{}Ua.errorCode="invalid_scope";class qa extends La{}qa.errorCode="access_denied";class Va extends La{}Va.errorCode="server_error";class Za extends La{}Za.errorCode="temporarily_unavailable";class Ha extends La{}Ha.errorCode="unsupported_response_type";class Ba extends La{}Ba.errorCode="unsupported_token_type";class Ga extends La{}Ga.errorCode="invalid_token";class Ka extends La{}Ka.errorCode="method_not_allowed";class Qa extends La{}Qa.errorCode="too_many_requests";class Wa extends La{}Wa.errorCode="invalid_client_metadata";class Ja extends La{}Ja.errorCode="insufficient_scope";const Xa={[Fa.errorCode]:Fa,[Na.errorCode]:Na,[Da.errorCode]:Da,[Ma.errorCode]:Ma,[za.errorCode]:za,[Ua.errorCode]:Ua,[qa.errorCode]:qa,[Va.errorCode]:Va,[Za.errorCode]:Za,[Ha.errorCode]:Ha,[Ba.errorCode]:Ba,[Ga.errorCode]:Ga,[Ka.errorCode]:Ka,[Qa.errorCode]:Qa,[Wa.errorCode]:Wa,[Ja.errorCode]:Ja};class Ya extends Error{constructor(e){super(null!=e?e:"Unauthorized")}}const en="code",tn="S256";function rn(e,t){const r=void 0!==e.client_secret;return 0===t.length?r?"client_secret_post":"none":r&&t.includes("client_secret_basic")?"client_secret_basic":r&&t.includes("client_secret_post")?"client_secret_post":t.includes("none")?"none":r?"client_secret_post":"none"}function an(e,t,r,a){const{client_id:n,client_secret:s}=t;switch(e){case"client_secret_basic":return void function(e,t,r){if(!t)throw new Error("client_secret_basic authentication requires a client_secret");const a=btoa(`${e}:${t}`);r.set("Authorization",`Basic ${a}`)}(n,s,r);case"client_secret_post":return void function(e,t,r){r.set("client_id",e),t&&r.set("client_secret",t)}(n,s,a);case"none":return void function(e,t){t.set("client_id",e)}(n,a);default:throw new Error(`Unsupported client authentication method: ${e}`)}}async function nn(e){const t=e instanceof Response?e.status:void 0,r=e instanceof Response?await e.text():e;try{const e=$a.parse(JSON.parse(r)),{error:t,error_description:a,error_uri:n}=e;return new(Xa[t]||Va)(a||"",n)}catch(e){return new Va(`${t?`HTTP ${t}: `:""}Invalid OAuth error response: ${e}. Raw body: ${r}`)}}async function sn(e,t){var r,a;try{return await on(e,t)}catch(n){if(n instanceof Na||n instanceof Ma)return await(null===(r=e.invalidateCredentials)||void 0===r?void 0:r.call(e,"all")),await on(e,t);if(n instanceof Da)return await(null===(a=e.invalidateCredentials)||void 0===a?void 0:a.call(e,"tokens")),await on(e,t);throw n}}async function on(e,{serverUrl:t,authorizationCode:r,scope:a,resourceMetadataUrl:n,fetchFn:s}){let o,i;try{o=await async function(e,t,r=fetch){const a=await async function(e,t,r,a){var n,s;const o=new URL(e),i=null!==(n=null==a?void 0:a.protocolVersion)&&void 0!==n?n:Lt;let l;if(null==a?void 0:a.metadataUrl)l=new URL(a.metadataUrl);else{const e=function(e,t="",r={}){return t.endsWith("/")&&(t=t.slice(0,-1)),r.prependPathname?`${t}/.well-known/${e}`:`/.well-known/${e}${t}`}(t,o.pathname);l=new URL(e,null!==(s=null==a?void 0:a.metadataServerUrl)&&void 0!==s?s:o),l.search=o.search}let c=await cn(l,i,r);if(!(null==a?void 0:a.metadataUrl)&&function(e,t){return!e||e.status>=400&&e.status<500&&"/"!==t}(c,o.pathname)){const e=new URL(`/.well-known/${t}`,o);c=await cn(e,i,r)}return c}(e,"oauth-protected-resource",r,{protocolVersion:null==t?void 0:t.protocolVersion,metadataUrl:null==t?void 0:t.resourceMetadataUrl});if(!a||404===a.status)throw new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!a.ok)throw new Error(`HTTP ${a.status} trying to load well-known OAuth protected resource metadata.`);return Oa.parse(await a.json())}(t,{resourceMetadataUrl:n},s),o.authorization_servers&&o.authorization_servers.length>0&&(i=o.authorization_servers[0])}catch(e){}i||(i=t);const l=await async function(e,t,r){const a=function(e){const t="string"==typeof e?new URL(e):new URL(e.href);return t.hash="",t}(e);if(t.validateResourceURL)return await t.validateResourceURL(a,null==r?void 0:r.resource);if(r){if(!function({requestedResource:e,configuredResource:t}){const r="string"==typeof e?new URL(e):new URL(e.href),a="string"==typeof t?new URL(t):new URL(t.href);if(r.origin!==a.origin)return!1;if(r.pathname.length<a.pathname.length)return!1;const n=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",s=a.pathname.endsWith("/")?a.pathname:a.pathname+"/";return n.startsWith(s)}({requestedResource:a,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${a} (or origin)`);return new URL(r.resource)}}(t,e,o),c=await async function(e,{fetchFn:t=fetch,protocolVersion:r=Lt}={}){const a={"MCP-Protocol-Version":r,Accept:"application/json"},n=function(e){const t="string"==typeof e?new URL(e):e,r=[];if(!("/"!==t.pathname))return r.push({url:new URL("/.well-known/oauth-authorization-server",t.origin),type:"oauth"}),r.push({url:new URL("/.well-known/openid-configuration",t.origin),type:"oidc"}),r;let a=t.pathname;return a.endsWith("/")&&(a=a.slice(0,-1)),r.push({url:new URL(`/.well-known/oauth-authorization-server${a}`,t.origin),type:"oauth"}),r.push({url:new URL("/.well-known/oauth-authorization-server",t.origin),type:"oauth"}),r.push({url:new URL(`/.well-known/openid-configuration${a}`,t.origin),type:"oidc"}),r.push({url:new URL(`${a}/.well-known/openid-configuration`,t.origin),type:"oidc"}),r}(e);for(const{url:e,type:r}of n){const n=await ln(e,a,t);if(n){if(!n.ok){if(n.status>=400&&n.status<500)continue;throw new Error(`HTTP ${n.status} trying to load ${"oauth"===r?"OAuth":"OpenID provider"} metadata from ${e}`)}return"oauth"===r?ka.parse(await n.json()):Ca.parse(await n.json())}}}(i,{fetchFn:s});let u=await Promise.resolve(e.clientInformation());if(!u){if(void 0!==r)throw new Error("Existing OAuth client information is required when exchanging an authorization code");if(!e.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const t=await async function(e,{metadata:t,clientMetadata:r,fetchFn:a}){let n;if(t){if(!t.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");n=new URL(t.registration_endpoint)}else n=new URL("/register",e);const s=await(null!=a?a:fetch)(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw await nn(s);return ja.parse(await s.json())}(i,{metadata:c,clientMetadata:e.clientMetadata,fetchFn:s});await e.saveClientInformation(t),u=t}if(void 0!==r){const t=await e.codeVerifier(),a=await async function(e,{metadata:t,clientInformation:r,authorizationCode:a,codeVerifier:n,redirectUri:s,resource:o,addClientAuthentication:i,fetchFn:l}){var c;const u="authorization_code",d=(null==t?void 0:t.token_endpoint)?new URL(t.token_endpoint):new URL("/token",e);if((null==t?void 0:t.grant_types_supported)&&!t.grant_types_supported.includes(u))throw new Error(`Incompatible auth server: does not support grant type ${u}`);const p=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}),h=new URLSearchParams({grant_type:u,code:a,code_verifier:n,redirect_uri:String(s)});i?i(p,h,e,t):an(rn(r,null!==(c=null==t?void 0:t.token_endpoint_auth_methods_supported)&&void 0!==c?c:[]),r,p,h),o&&h.set("resource",o.href);const m=await(null!=l?l:fetch)(d,{method:"POST",headers:p,body:h});if(!m.ok)throw await nn(m);return Ia.parse(await m.json())}(i,{metadata:c,clientInformation:u,authorizationCode:r,codeVerifier:t,redirectUri:e.redirectUrl,resource:l,addClientAuthentication:e.addClientAuthentication,fetchFn:s});return await e.saveTokens(a),"AUTHORIZED"}const d=await e.tokens();if(null==d?void 0:d.refresh_token)try{const t=await async function(e,{metadata:t,clientInformation:r,refreshToken:a,resource:n,addClientAuthentication:s,fetchFn:o}){var i;const l="refresh_token";let c;if(t){if(c=new URL(t.token_endpoint),t.grant_types_supported&&!t.grant_types_supported.includes(l))throw new Error(`Incompatible auth server: does not support grant type ${l}`)}else c=new URL("/token",e);const u=new Headers({"Content-Type":"application/x-www-form-urlencoded"}),d=new URLSearchParams({grant_type:l,refresh_token:a});s?s(u,d,e,t):an(rn(r,null!==(i=null==t?void 0:t.token_endpoint_auth_methods_supported)&&void 0!==i?i:[]),r,u,d),n&&d.set("resource",n.href);const p=await(null!=o?o:fetch)(c,{method:"POST",headers:u,body:d});if(!p.ok)throw await nn(p);return Ia.parse({refresh_token:a,...await p.json()})}(i,{metadata:c,clientInformation:u,refreshToken:d.refresh_token,resource:l,addClientAuthentication:e.addClientAuthentication,fetchFn:s});return await e.saveTokens(t),"AUTHORIZED"}catch(e){if(e instanceof La&&!(e instanceof Va))throw e}const p=e.state?await e.state():void 0,{authorizationUrl:h,codeVerifier:m}=await async function(e,{metadata:t,clientInformation:r,redirectUrl:a,scope:n,state:s,resource:o}){let i;if(t){if(i=new URL(t.authorization_endpoint),!t.response_types_supported.includes(en))throw new Error(`Incompatible auth server: does not support response type ${en}`);if(t.code_challenge_methods_supported&&!t.code_challenge_methods_supported.includes(tn))throw new Error(`Incompatible auth server: does not support code challenge method ${tn}`)}else i=new URL("/authorize",e);const l=await xa(),c=l.code_verifier,u=l.code_challenge;return i.searchParams.set("response_type",en),i.searchParams.set("client_id",r.client_id),i.searchParams.set("code_challenge",u),i.searchParams.set("code_challenge_method",tn),i.searchParams.set("redirect_uri",String(a)),s&&i.searchParams.set("state",s),n&&i.searchParams.set("scope",n),(null==n?void 0:n.includes("offline_access"))&&i.searchParams.append("prompt","consent"),o&&i.searchParams.set("resource",o.href),{authorizationUrl:i,codeVerifier:c}}(i,{metadata:c,clientInformation:u,state:p,redirectUrl:e.redirectUrl,scope:a||e.clientMetadata.scope,resource:l});return await e.saveCodeVerifier(m),await e.redirectToAuthorization(h),"REDIRECT"}async function ln(e,t,r=fetch){try{return await r(e,{headers:t})}catch(a){if(a instanceof TypeError)return t?ln(e,void 0,r):void 0;throw a}}async function cn(e,t,r=fetch){const a={"MCP-Protocol-Version":t};return await ln(e,a,r)}class un extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function dn(e){}class pn extends TransformStream{constructor({onError:e,onRetry:t,onComment:r}={}){let a;super({start(n){a=function(e){if("function"==typeof e)throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=dn,onError:r=dn,onRetry:a=dn,onComment:n}=e;let s,o="",i=!0,l="",c="";function u(e){if(""===e)return l.length>0&&t({id:s,event:c||void 0,data:l.endsWith("\n")?l.slice(0,-1):l}),s=void 0,l="",void(c="");if(e.startsWith(":"))return void(n&&n(e.slice(e.startsWith(": ")?2:1)));const r=e.indexOf(":");if(-1!==r){const t=e.slice(0,r),a=" "===e[r+1]?2:1;return void d(t,e.slice(r+a),e)}d(e,"",e)}function d(e,t,n){switch(e){case"event":c=t;break;case"data":l=`${l}${t}\n`;break;case"id":s=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?a(parseInt(t,10)):r(new un(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:n}));break;default:r(new un(`Unknown field "${e.length>20?`${e.slice(0,20)}`:e}"`,{type:"unknown-field",field:e,value:t,line:n}))}}return{feed:function(e){const t=i?e.replace(/^\xEF\xBB\xBF/,""):e,[r,a]=function(e){const t=[];let r="",a=0;for(;a<e.length;){const n=e.indexOf("\r",a),s=e.indexOf("\n",a);let o=-1;if(-1!==n&&-1!==s?o=Math.min(n,s):-1!==n?o=n===e.length-1?-1:n:-1!==s&&(o=s),-1===o){r=e.slice(a);break}{const r=e.slice(a,o);t.push(r),a=o+1,"\r"===e[a-1]&&"\n"===e[a]&&a++}}return[t,r]}(`${o}${t}`);for(const e of r)u(e);o=a,i=!1},reset:function(e={}){o&&e.consume&&u(o),i=!0,s=void 0,l="",c="",o=""}}}({onEvent:e=>{n.enqueue(e)},onError(t){"terminate"===e?n.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:r})},transform(e){a.feed(e)}})}}const hn={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2};class mn extends Error{constructor(e,t){super(`Streamable HTTP error: ${t}`),this.code=e}}class fn{constructor(e,t){var r;this._hasCompletedAuthFlow=!1,this._url=e,this._resourceMetadataUrl=void 0,this._requestInit=null==t?void 0:t.requestInit,this._authProvider=null==t?void 0:t.authProvider,this._fetch=null==t?void 0:t.fetch,this._sessionId=null==t?void 0:t.sessionId,this._reconnectionOptions=null!==(r=null==t?void 0:t.reconnectionOptions)&&void 0!==r?r:hn}async _authThenStart(){var e;if(!this._authProvider)throw new Ya("No auth provider");let t;try{t=await sn(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})}catch(t){throw null===(e=this.onerror)||void 0===e||e.call(this,t),t}if("AUTHORIZED"!==t)throw new Ya;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){var e;const t={};if(this._authProvider){const e=await this._authProvider.tokens();e&&(t.Authorization=`Bearer ${e.access_token}`)}this._sessionId&&(t["mcp-session-id"]=this._sessionId),this._protocolVersion&&(t["mcp-protocol-version"]=this._protocolVersion);const r=this._normalizeHeaders(null===(e=this._requestInit)||void 0===e?void 0:e.headers);return new Headers({...t,...r})}async _startOrAuthSse(e){var t,r,a;const{resumptionToken:n}=e;try{const a=await this._commonHeaders();a.set("Accept","text/event-stream"),n&&a.set("last-event-id",n);const s=await(null!==(t=this._fetch)&&void 0!==t?t:fetch)(this._url,{method:"GET",headers:a,signal:null===(r=this._abortController)||void 0===r?void 0:r.signal});if(!s.ok){if(401===s.status&&this._authProvider)return await this._authThenStart();if(405===s.status)return;throw new mn(s.status,`Failed to open SSE stream: ${s.statusText}`)}this._handleSseStream(s.body,e,!0)}catch(e){throw null===(a=this.onerror)||void 0===a||a.call(this,e),e}}_getNextReconnectionDelay(e){const t=this._reconnectionOptions.initialReconnectionDelay,r=this._reconnectionOptions.reconnectionDelayGrowFactor,a=this._reconnectionOptions.maxReconnectionDelay;return Math.min(t*Math.pow(r,e),a)}_normalizeHeaders(e){return e?e instanceof Headers?Object.fromEntries(e.entries()):Array.isArray(e)?Object.fromEntries(e):{...e}:{}}_scheduleReconnection(e,t=0){var r;const a=this._reconnectionOptions.maxRetries;if(a>0&&t>=a)return void(null===(r=this.onerror)||void 0===r||r.call(this,new Error(`Maximum reconnection attempts (${a}) exceeded.`)));const n=this._getNextReconnectionDelay(t);setTimeout(()=>{this._startOrAuthSse(e).catch(r=>{var a;null===(a=this.onerror)||void 0===a||a.call(this,new Error(`Failed to reconnect SSE stream: ${r instanceof Error?r.message:String(r)}`)),this._scheduleReconnection(e,t+1)})},n)}_handleSseStream(e,t,r){if(!e)return;const{onresumptiontoken:a,replayMessageId:n}=t;let s;(async()=>{var t,o,i,l;try{const r=e.pipeThrough(new TextDecoderStream).pipeThrough(new pn).getReader();for(;;){const{value:e,done:i}=await r.read();if(i)break;if(e.id&&(s=e.id,null==a||a(e.id)),!e.event||"message"===e.event)try{const r=er.parse(JSON.parse(e.data));void 0!==n&&Jt(r)&&(r.id=n),null===(t=this.onmessage)||void 0===t||t.call(this,r)}catch(e){null===(o=this.onerror)||void 0===o||o.call(this,e)}}}catch(e){if(null===(i=this.onerror)||void 0===i||i.call(this,new Error(`SSE stream disconnected: ${e}`)),r&&this._abortController&&!this._abortController.signal.aborted)try{this._scheduleReconnection({resumptionToken:s,onresumptiontoken:a,replayMessageId:n},0)}catch(e){null===(l=this.onerror)||void 0===l||l.call(this,new Error(`Failed to reconnect: ${e instanceof Error?e.message:String(e)}`))}}})()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(e){if(!this._authProvider)throw new Ya("No auth provider");if("AUTHORIZED"!==await sn(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch}))throw new Ya("Failed to authorize")}async close(){var e,t;null===(e=this._abortController)||void 0===e||e.abort(),null===(t=this.onclose)||void 0===t||t.call(this)}async send(e,t){var r,a,n,s,o;try{const{resumptionToken:s,onresumptiontoken:i}=t||{};if(s)return void this._startOrAuthSse({resumptionToken:s,replayMessageId:Kt(e)?e.id:void 0}).catch(e=>{var t;return null===(t=this.onerror)||void 0===t?void 0:t.call(this,e)});const l=await this._commonHeaders();l.set("content-type","application/json"),l.set("accept","application/json, text/event-stream");const c={...this._requestInit,method:"POST",headers:l,body:JSON.stringify(e),signal:null===(r=this._abortController)||void 0===r?void 0:r.signal},u=await(null!==(a=this._fetch)&&void 0!==a?a:fetch)(this._url,c),d=u.headers.get("mcp-session-id");if(d&&(this._sessionId=d),!u.ok){if(401===u.status&&this._authProvider){if(this._hasCompletedAuthFlow)throw new mn(401,"Server returned 401 after successful authentication");if(this._resourceMetadataUrl=function(e){const t=e.headers.get("WWW-Authenticate");if(!t)return;const[r,a]=t.split(" ");if("bearer"!==r.toLowerCase()||!a)return;const n=/resource_metadata="([^"]*)"/.exec(t);if(n)try{return new URL(n[1])}catch(e){return}}(u),"AUTHORIZED"!==await sn(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch}))throw new Ya;return this._hasCompletedAuthFlow=!0,this.send(e)}const t=await u.text().catch(()=>null);throw new Error(`Error POSTing to endpoint (HTTP ${u.status}): ${t}`)}if(this._hasCompletedAuthFlow=!1,202===u.status)return o=e,void(dr.safeParse(o).success&&this._startOrAuthSse({resumptionToken:void 0}).catch(e=>{var t;return null===(t=this.onerror)||void 0===t?void 0:t.call(this,e)}));const p=(Array.isArray(e)?e:[e]).filter(e=>"method"in e&&"id"in e&&void 0!==e.id).length>0,h=u.headers.get("content-type");if(p)if(null==h?void 0:h.includes("text/event-stream"))this._handleSseStream(u.body,{onresumptiontoken:i},!1);else{if(!(null==h?void 0:h.includes("application/json")))throw new mn(-1,`Unexpected content type: ${h}`);{const e=await u.json(),t=Array.isArray(e)?e.map(e=>er.parse(e)):[er.parse(e)];for(const e of t)null===(n=this.onmessage)||void 0===n||n.call(this,e)}}}catch(e){throw null===(s=this.onerror)||void 0===s||s.call(this,e),e}}get sessionId(){return this._sessionId}async terminateSession(){var e,t,r;if(this._sessionId)try{const r=await this._commonHeaders(),a={...this._requestInit,method:"DELETE",headers:r,signal:null===(e=this._abortController)||void 0===e?void 0:e.signal},n=await(null!==(t=this._fetch)&&void 0!==t?t:fetch)(this._url,a);if(!n.ok&&405!==n.status)throw new mn(n.status,`Failed to terminate session: ${n.statusText}`);this._sessionId=void 0}catch(e){throw null===(r=this.onerror)||void 0===r||r.call(this,e),e}}setProtocolVersion(e){this._protocolVersion=e}get protocolVersion(){return this._protocolVersion}}var vn=l(1269),gn=l(143);const yn="grafana-llm-app",_n=`/api/plugins/${yn}`;let bn=new gn.SemVer("0.2.0");const En="mcp/grafana",wn=new Map,Pn=t.createContext(null);function xn(e,t){return`${e}-${t}`}function Sn({appName:e,appVersion:r,mcpAppName:a=yn,mcpAppPath:n=En,children:s}){const o=(0,t.useMemo)(()=>function({appName:e,appVersion:t,mcpAppName:r,mcpAppPath:a}){let n="pending",s=null,o=null;const i=xn(e,t),l=(async()=>{if(wn.has(i)){if(s=wn.get(i),s.error)throw n="error",o=s.error,s.error;return n="success",s}try{const o=await async function(){try{const e=await(0,V.getBackendSrv)().get(`${_n}/settings`,void 0,void 0,{showSuccessAlert:!1,showErrorAlert:!1});return!!e.enabled&&(void 0!==e.jsonData.mcp?.enabled?!!e.jsonData.mcp?.enabled:!e.jsonData.mcp?.disabled)}catch(e){return(0,V.logDebug)(String(e)),(0,V.logDebug)("Failed to check if LLM provider is enabled. This is expected if the Grafana LLM plugin is not installed, and the above error can be ignored."),!1}}();if(!o)return n="success",s={client:null,enabled:o},wn.set(i,s),s;const l=new Ea({name:e,version:t}),c=new fn(function(e=yn,t=En){let r=V.config.appUrl||"http://localhost:3000/";return r.endsWith("/")||(r=`${r}/`),t.startsWith("/")||(t=`/${t}`),new URL(`${r}api/plugins/${e}/resources${t}`)}(r,a),{reconnectionOptions:{maxRetries:5,initialReconnectionDelay:1e3,maxReconnectionDelay:5e3,reconnectionDelayGrowFactor:1.5}});return await l.connect(c),s={client:l,enabled:o},wn.set(i,s),n="success",s}catch(e){throw n="error",o=e,s={client:null,enabled:!1,error:o},wn.set(i,s),e}})();return{read(){if("pending"===n)throw l;if("error"===n)throw o;if("success"===n&&s)return s;throw new Error("Unexpected resource state")}}}({appName:e,appVersion:r,mcpAppName:a,mcpAppPath:n}),[e,r,a,n]).read();return t.useEffect(()=>()=>{o?.client&&o.client.close(),wn.delete(xn(e,r))},[o,e,r]),t.createElement(Pn.Provider,{value:o},s)}function On(){const e=t.useContext(Pn);if(null===e)throw new Error("MCP is not enabled in this Grafana instance.");return e}function kn(e){return e.map(Cn)}function Cn(e){return{type:"function",function:{name:e.name,description:e.description,parameters:void 0!==e.inputSchema.properties?e.inputSchema:void 0}}}var In=l(2007);function $n(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}function An(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var s=e.apply(t,r);function o(e){$n(s,a,n,o,i,"next",e)}function i(e){$n(s,a,n,o,i,"throw",e)}o(void 0)})}}function Rn(){const{client:e,enabled:t}=On(),{error:a,loading:n,value:s}=z(An(function*(){return t&&e?(yield e.listTools()).tools:null}),[e,t]);return t?n?r().createElement("div",{"data-testid":S},r().createElement("span",{"data-testid":k},"Loading MCP tools...")):a?r().createElement("div",{"data-testid":S},r().createElement("span",{"data-testid":C},"Error loading MCP tools: ",a.message)):s&&0!==s.length?r().createElement("div",{"data-testid":S,style:{maxHeight:"400px",overflowY:"auto"}},r().createElement("h2",null,"Available MCP Tools"),r().createElement("ul",{"data-testid":$},s.map(e=>r().createElement("li",{key:e.name,"data-testid":A},r().createElement("strong",{"data-testid":R},e.name),e.description&&r().createElement("span",{"data-testid":T}," - ",e.description))))):r().createElement("div",{"data-testid":S},r().createElement("p",{"data-testid":I},"No MCP tools available.")):r().createElement("div",{"data-testid":S},r().createElement("p",{"data-testid":O},"MCP is not enabled in this Grafana instance."))}function Tn(){return r().createElement(r().Suspense,{fallback:r().createElement("div",{"data-testid":S},"Connecting to MCP server...")},r().createElement(In.ErrorBoundary,null,({error:e})=>e?r().createElement("div",{"data-testid":S},r().createElement("span",{"data-testid":C},"Error loading MCP tools: ",e.message)):r().createElement(Sn,{appName:"grafana-llm-app",appVersion:"0.21.1"},r().createElement(Rn,null))))}var jn=l(6089);const Ln=e=>"object"==typeof e&&null!==e&&"llmProvider"in e&&"vector"in e&&"version"in e,Fn=new Set(["success","info","warning","error"]),Nn=e=>{return"ok"===e.toLowerCase()?"success":(t=e,Fn.has(t)?e:"info");var t};function Dn(e){var t;let a=Nn(null!==(t=e.status)&&void 0!==t?t:"error");if(!Ln(e.details))return r().createElement(In.Alert,{severity:a,title:e.message});var n;a=((e,t)=>{const r=Nn(e);if("success"!==r)return r;if(!Ln(t))return"success";if("object"==typeof t.llmProvider&&"object"==typeof t.vector){const e=!t.vector.enabled||t.vector.ok;return t.llmProvider.ok&&e?"success":"warning"}return r})(null!==(n=e.status)&&void 0!==n?n:"error",e.details);const s="boolean"==typeof e.details.llmProvider||"object"==typeof e.details.llmProvider&&e.details.llmProvider.configured,o="boolean"==typeof e.details.vector||"object"==typeof e.details.vector&&e.details.vector.enabled;return r().createElement(In.Stack,{direction:"column"},r().createElement(Mn,null),s&&r().createElement(zn,{provider:e.details.llmProvider}),o&&r().createElement(Un,{vector:e.details.vector}))}function Mn(){return V.config.liveEnabled?null:r().createElement(In.Alert,{title:"Grafana Live is disabled",severity:"warning"},r().createElement("div",null,"Grafana Live is disabled. This plugin requires Grafana Live to be enabled in order to function correctly."),r().createElement("div",null,"Set the"," ",r().createElement("a",{href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#max_connections"},r().createElement("code",null,"max_connections"))," ","setting to a non-zero value in the Grafana configuration file to enable Grafana Live."))}function zn({provider:e}){if("boolean"==typeof e){const t=e?"success":"error",a=e?"LLM provider health check succeeded!":"LLM provider health check failed.";return r().createElement(In.Alert,{title:a,severity:t})}const t=e.ok?"LLM provider health check succeeded!":"LLM provider health check failed.",a=e.ok?"success":"error";return r().createElement(In.Stack,{direction:"column",width:"100%"},r().createElement(In.Alert,{severity:a,title:t},r().createElement("b",null,"Models"),r().createElement("div",null,Object.entries(e.models).map(([e,t],a)=>r().createElement("li",{key:a},e,": ",t.ok?"OK":`Error: ${t.error}`)))))}function Un({vector:e}){if("boolean"==typeof e){const t=e?"success":"error",a=e?"Vector service health check succeeded!":"Vector service health check failed.";return r().createElement(In.Alert,{title:a,severity:t})}const t=e.ok?"success":"error",a=e.ok?"Vector service health check succeeded!":"Vector service health check failed.";return r().createElement(In.Alert,{title:a,severity:t},e.error&&r().createElement("div",null,"Error: ",e.error))}function qn(e){return"function"==typeof e}function Vn(e){return function(t){if(function(e){return qn(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw new TypeError("Unable to lift unknown Observable type")}}var Zn,Hn=((Zn=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),Zn.prototype.constructor=Zn,Zn);function Bn(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var Gn=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,a,n;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var o=N(s),i=o.next();!i.done;i=o.next())i.value.remove(this)}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else s.remove(this);var l=this.initialTeardown;if(qn(l))try{l()}catch(e){n=e instanceof Hn?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=N(c),d=u.next();!d.done;d=u.next()){var p=d.value;try{Kn(p)}catch(e){n=null!=n?n:[],e instanceof Hn?n=M(M([],D(n)),D(e.errors)):n.push(e)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}}if(n)throw new Hn(n)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Kn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Bn(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&Bn(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function Kn(e){qn(e)?e():e.unsubscribe()}Gn.EMPTY;var Qn={setTimeout:function(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var n=Qn.delegate;return(null==n?void 0:n.setTimeout)?n.setTimeout.apply(n,M([e,t],D(r))):setTimeout.apply(void 0,M([e,t],D(r)))},clearTimeout:function(e){var t=Qn.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Wn(){}var Jn=Xn("C",void 0,void 0);function Xn(e,t,r){return{kind:e,value:t,error:r}}var Yn=function(e){function t(t){var r,a=e.call(this)||this;return a.isStopped=!1,t?(a.destination=t,((r=t)instanceof Gn||r&&"closed"in r&&qn(r.remove)&&qn(r.add)&&qn(r.unsubscribe))&&t.add(a)):a.destination=ns,a}return L(t,e),t.create=function(e,t,r){return new ts(e,t,r)},t.prototype.next=function(e){this.isStopped?as(function(e){return Xn("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?as(Xn("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?as(Jn,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Gn);Function.prototype.bind;var es=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){rs(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){rs(e)}else rs(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){rs(e)}},e}(),ts=function(e){function t(t,r,a){var n,s=e.call(this)||this;return n=qn(t)||!t?{next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=a?a:void 0}:t,s.destination=new es(n),s}return L(t,e),t}(Yn);function rs(e){!function(e){Qn.setTimeout(function(){throw e})}(e)}function as(e,t){var r=null;r&&Qn.setTimeout(function(){return r(e,t)})}var ns={closed:!0,next:Wn,error:function(e){throw e},complete:Wn};function ss(e,t,r,a,n){return new os(e,t,r,a,n)}var os=function(e){function t(t,r,a,n,s,o){var i=e.call(this,t)||this;return i.onFinalize=s,i.shouldUnsubscribe=o,i._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,i._error=n?function(e){try{n(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,i._complete=a?function(){try{a()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,i}return L(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(Yn);function is(e,t){return Vn(function(r,a){var n=0;r.subscribe(ss(a,function(r){return e.call(t,r,n++)&&a.next(r)}))})}function ls(e,t){return Vn(function(r,a){var n=0;r.subscribe(ss(a,function(r){a.next(e.call(t,r,n++))}))})}function cs(e,t,r,a,n){return function(s,o){var i=r,l=t,c=0;s.subscribe(ss(o,function(t){var r=c++;l=i?e(l,t,r):(i=!0,t),a&&o.next(l)},n&&function(){i&&o.next(l),o.complete()}))}}function us(e){return e}var ds=function(e,t){return e.push(t),e};const ps={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let hs;const ms=new Uint8Array(16),fs=[];for(let e=0;e<256;++e)fs.push((e+256).toString(16).slice(1));const vs=function(e,t,r){if(ps.randomUUID&&!t&&!e)return ps.randomUUID();const a=(e=e||{}).random??e.rng?.()??function(){if(!hs){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");hs=crypto.getRandomValues.bind(crypto)}return hs(ms)}();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(fs[e[t+0]]+fs[e[t+1]]+fs[e[t+2]]+fs[e[t+3]]+"-"+fs[e[t+4]]+fs[e[t+5]]+"-"+fs[e[t+6]]+fs[e[t+7]]+"-"+fs[e[t+8]]+fs[e[t+9]]+"-"+fs[e[t+10]]+fs[e[t+11]]+fs[e[t+12]]+fs[e[t+13]]+fs[e[t+14]]+fs[e[t+15]]).toLowerCase()}(a)},gs="llm/v1/chat/completions";var ys=(e=>(e.BASE="base",e.LARGE="large",e))(ys||{});function _s(e){return"error"in e}function bs(e){return"tool_calls"in e&&null!=e.tool_calls}function Es(){return(0,vn.pipe)((0,vn.pipe)(is(e=>e.choices.length>0&&"content"in e.choices[0].delta),ls(e=>e.choices[0].delta.content)),function(e,t){return Vn(cs(e,t,arguments.length>=2,!0))}((e,t)=>e+t,""))}async function ws(e){return await(0,V.getBackendSrv)().post(`/api/plugins/grafana-llm-app/resources/${gs}`,e,{headers:{"Content-Type":"application/json"}})}function Ps(t){const r={scope:e.LiveChannelScope.Plugin,namespace:yn,path:gs+"/"+vs(),data:t};return(0,V.getGrafanaLiveSrv)().getStream(r).pipe(is(t=>(0,e.isLiveChannelMessageEvent)(t))).pipe(is(e=>!!e.message.choices),(l=qn(s=e=>{if(_s(e.message))throw new Error(e.message.error)})?{next:s,error:o,complete:i}:s)?Vn(function(e,t){var r;null===(r=l.subscribe)||void 0===r||r.call(l);var a=!0;e.subscribe(ss(t,function(e){var r;null===(r=l.next)||void 0===r||r.call(l,e),t.next(e)},function(){var e;a=!1,null===(e=l.complete)||void 0===e||e.call(l),t.complete()},function(e){var r;a=!1,null===(r=l.error)||void 0===r||r.call(l,e),t.error(e)},function(){var e,t;a&&(null===(e=l.unsubscribe)||void 0===e||e.call(l)),null===(t=l.finalize)||void 0===t||t.call(l)}))}):us,(a=e=>!(!_s(e.message)&&(e.message.choices&&e.message.choices[0].delta&&"done"in e.message.choices[0].delta&&!0===e.message.choices[0].delta.done||e.message.choices&&"finish_reason"in e.message.choices[0]&&"stop"===e.message.choices[0].finish_reason)),void 0===n&&(n=!1),Vn(function(e,t){e.subscribe(ss(t,function(e){var r=a(e,0);(r||n)&&t.next(e),!r&&t.complete()}))})),ls(e=>e.message));var a,n,s,o,i,l}let xs=!1;const Ss=async()=>{const e=await(async()=>{try{if(!(await(0,V.getBackendSrv)().get(`${_n}/settings`,void 0,void 0,{showSuccessAlert:!1,showErrorAlert:!1})).enabled)return{configured:!1,ok:!1,error:"The Grafana LLM plugin is not enabled."}}catch(e){return(0,V.logDebug)(String(e)),(0,V.logDebug)("Failed to check if LLM provider is enabled. This is expected if the Grafana LLM plugin is not installed, and the above error can be ignored."),xs=!0,{configured:!1,ok:!1,error:"The Grafana LLM plugin is not installed."}}let e;try{e=await(0,V.getBackendSrv)().get(`${_n}/health`,void 0,void 0,{showSuccessAlert:!1,showErrorAlert:!1})}catch(e){return xs||((0,V.logDebug)(String(e)),(0,V.logDebug)("Failed to check if LLM provider is enabled. This is expected if the Grafana LLM plugin is not installed, and the above error can be ignored."),xs=!0),{configured:!1,ok:!1,error:"The Grafana LLM plugin is not installed."}}const{details:t}=e;return void 0!==t?.version&&function(e){try{bn=new gn.SemVer(e)}catch(e){(0,V.logWarning)("Failed to parse version of grafana-llm-app; assuming old version is present.")}}(t.version),void 0===t?.llmProvider?{configured:!1,ok:!1,error:"The Grafana LLM plugin is outdated; please update it."}:"boolean"==typeof t.llmProvider?{configured:t.llmProvider,ok:t.llmProvider}:t.llmProvider})();return e.configured&&e.ok};function Os(){return(0,vn.pipe)(is(e=>bs(e.choices[0].delta)),Vn(function(e,t){(function(e,t){return Vn(cs(e,t,arguments.length>=2,!1,!0))})(ds,[])(e).subscribe(t)}),ls(e=>function(e){const t={role:"assistant",tool_calls:[]};for(const r of e)for(const e of r.tool_calls)e.index>=t.tool_calls.length?t.tool_calls.push({...e,function:{...e.function,arguments:e.function.arguments??""}}):t.tool_calls[e.index].function.arguments+=e.function.arguments??"";for(const e of t.tool_calls)e.function.arguments||(e.function.arguments="{}");return t}(e.map(e=>e.choices[0].delta))))}function ks(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){ks(e,t,r[t])})}return e}function Is(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const $s=ys.BASE;function As({provider:e,settings:t,onChange:a}){const n=function(e){return"anthropic"===e?[{id:ys.BASE,name:"claude-4-sonnet-20250514",label:"Base",description:"An effective, balanced model, suitable for most tasks."},{id:ys.LARGE,name:"claude-4-sonnet-20250514",label:"Large",description:"An effective, balanced model, suitable for most tasks."}]:[{id:ys.BASE,name:"gpt-4.1-mini",label:"Base",description:"A fast and cost-effective model for efficient, high-throughput tasks."},{id:ys.LARGE,name:"gpt-4.1",label:"Large",description:"A larger, higher cost model for more advanced tasks with longer context windows."}]}(e);t=((e,t,r)=>{var a;return{default:null!==(a=t.default)&&void 0!==a?a:$s,mapping:t.mapping?Object.fromEntries(Object.entries(t.mapping).filter(([e,t])=>r.find(t=>t.id===e))):Object.fromEntries(r.map(e=>[e.id,e.name]))}})(0,t,n);const s=e=>a(Is(Cs({},t),{default:e}));var o;return r().createElement(In.FieldSet,null,"azure"===e&&r().createElement(In.Field,{label:"Default Model",description:"The default model is used when no model is specified in the chat request."},r().createElement(In.Select,{options:n.map(e=>({label:e.label,value:e.id})),width:60,value:null!==(o=t.default)&&void 0!==o?o:$s,onChange:e=>{var t;return s(null!==(t=e.value)&&void 0!==t?t:$s)}})),"azure"!==e&&r().createElement(r().Fragment,null,r().createElement(In.Label,{description:"Map custom models used for LLM features. The default model is used when no model is specified in the chat request."},"Model mappings"),n.map((e,n)=>{const o=t.mapping[e.id],i=t.default===e.id,l=r().createElement(r().Fragment,null,r().createElement(In.Label,null,e.label,r().createElement(In.Divider,{direction:"vertical",spacing:1}),i?r().createElement("div",{style:{margin:"1px auto"}},r().createElement(In.Badge,{text:"Default",color:"blue"})):r().createElement(In.Button,{variant:"secondary",size:"sm",onClick:()=>s(e.id)},"Set as default")));return r().createElement(In.Field,{key:n,label:l,description:e.description},r().createElement(In.Input,{width:60,type:"text",name:"model",value:o,placeholder:e.name,onChange:r=>{const n=r.currentTarget.value,s=Is(Cs({},t.mapping),{[e.id]:n||void 0});a(Is(Cs({},t),{mapping:s}))}}))})))}function Rs(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}function Ts(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var s=e.apply(t,r);function o(e){Rs(s,a,n,o,i,"next",e)}function i(e){Rs(s,a,n,o,i,"throw",e)}o(void 0)})}}function js(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ls(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){js(e,t,r[t])})}return e}function Fs(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function Ns(e,t,r,a,n){return Ds.apply(this,arguments)}function Ds(){return(Ds=Ts(function*(e,t,r,a,n){const{function:s,id:o}=e;console.log("f",s),a(new Map(r.set(o,{name:s.name,arguments:s.arguments,running:!0})));const i=JSON.parse(s.arguments);try{const e=yield t.callTool({name:s.name,arguments:i}),l=Wr.parse(e).content.filter(e=>"text"===e.type).map(e=>e.text).join("");n.push({role:"tool",tool_call_id:o,content:l}),a(new Map(r.set(o,{name:s.name,arguments:s.arguments,running:!1,response:e})))}catch(e){var l;const t=null!==(l=e.message)&&void 0!==l?l:e.toString();n.push({role:"tool",tool_call_id:o,content:t}),a(new Map(r.set(o,{name:s.name,arguments:s.arguments,running:!1,error:t})))}})).apply(this,arguments)}function Ms({useStream:e,toolCalls:a,setToolCalls:n}){const{client:s}=On(),[o,i]=(0,t.useState)([]),[l,c]=(0,t.useState)(""),[u,d]=(0,t.useState)(!1),p=(0,t.useRef)(null);(0,t.useEffect)(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[o]);const{loading:h,error:m,value:f}=z(Ts(function*(){if(!(yield Ss()))return{enabled:!1,tools:[]};var e;const{tools:t}=null!==(e=yield null==s?void 0:s.listTools())&&void 0!==e?e:{tools:[]};return{enabled:!0,tools:t}}),[s]),v=(g=Ts(function*(e,t){let r=Ps({model:ys.LARGE,messages:e,tools:kn(t)}),[o,l]=(0,vn.partition)(r,e=>bs(e.choices[0].delta)),c=l.pipe(Es(),(0,vn.finalize)(()=>{console.log("stream finalized")}));c.subscribe(e=>{i(t=>t.map((r,a)=>a===t.length-1&&"assistant"===r.role?Fs(Ls({},r),{content:e}):r))});let u=yield(0,vn.lastValueFrom)(o.pipe(Os()));for(;u.tool_calls.length>0;){e.push(u);const d=u.tool_calls.filter(e=>"function"===e.type);yield Promise.all(d.map(t=>Ns(t,s,a,n,e))),r=Ps({model:ys.LARGE,messages:e,tools:kn(t)}),[o,l]=(0,vn.partition)(r,e=>bs(e.choices[0].delta));const p={choices:[{delta:{role:"assistant",content:""}}]};c=l.pipe((0,vn.startWith)(p),Es(),(0,vn.finalize)(()=>{console.log("stream finalized")})),c.subscribe(e=>{i(t=>t.map((r,a)=>a===t.length-1&&"assistant"===r.role?Fs(Ls({},r),{content:e}):r))}),u=yield(0,vn.lastValueFrom)(o.pipe(Os()))}}),function(e,t){return g.apply(this,arguments)});var g;const y=function(){var e=Ts(function*(e,t){var r;let o=yield ws({model:ys.BASE,messages:e,tools:kn(t)});var l;let c=null!==(l=null===(r=o.choices[0].message.tool_calls)||void 0===r?void 0:r.filter(e=>"function"===e.type))&&void 0!==l?l:[];for(;c.length>0;){var u,d;e.push(o.choices[0].message),yield Promise.all(c.map(t=>Ns(t,s,a,n,e))),o=yield ws({model:ys.LARGE,messages:e,tools:kn(t)}),c=null!==(d=null===(u=o.choices[0].message.tool_calls)||void 0===u?void 0:u.filter(e=>"function"===e.type))&&void 0!==d?d:[]}i(e=>e.map((t,r)=>r===e.length-1&&"assistant"===t.role?Fs(Ls({},t),{content:o.choices[0].message.content||""}):t))});return function(t,r){return e.apply(this,arguments)}}(),_=function(){var t=Ts(function*(){if(!l.trim()||u||!(null==f?void 0:f.enabled))return;const t={role:"user",content:l.trim(),timestamp:new Date};i(e=>[...e,t]),c(""),d(!0),n(new Map);const r={role:"assistant",content:"",timestamp:new Date};i(e=>[...e,r]);const a=[{role:"system",content:"You are a helpful assistant with deep knowledge of the Grafana, Prometheus and general observability ecosystem."},...o.map(e=>({role:e.role,content:e.content})),{role:"user",content:t.content}];try{e?yield v(a,f.tools):yield y(a,f.tools)}catch(e){console.error("Error in chat completion:",e),i(t=>t.map((r,a)=>a===t.length-1&&"assistant"===r.role?Fs(Ls({},r),{content:`Error: ${e instanceof Error?e.message:"Unknown error"}`}):r))}finally{d(!1)}});return function(){return t.apply(this,arguments)}}();return m?r().createElement("div",null,"Error: ",m.message):(null==f?void 0:f.enabled)?r().createElement(In.Stack,{direction:"column",gap:3},r().createElement("div",{ref:p,style:{height:"400px",overflowY:"auto",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"16px",backgroundColor:"var(--background-color-secondary)"}},0===o.length?r().createElement("div",{style:{color:"var(--text-color-secondary)",fontStyle:"italic"}},"Start a conversation by typing a message below..."):r().createElement(In.Stack,{direction:"column",gap:1},o.map((e,t)=>r().createElement("div",{key:t,style:{display:"flex",flexDirection:"row",marginBottom:"12px",width:"100%"}},r().createElement("div",{style:{maxWidth:"90%",padding:"10px 14px",borderRadius:"12px",backgroundColor:"user"===e.role?"#007acc":"var(--background-color-primary)",color:"user"===e.role?"white":"var(--text-color-primary)",whiteSpace:"pre-wrap",wordBreak:"break-word",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"assistant"===e.role?"1px solid var(--border-color)":"none",fontSize:"14px",lineHeight:"1.4"}},e.content||("assistant"===e.role&&u&&t===o.length-1?r().createElement("span",{style:{opacity:.7}},"..."):"")))))),r().createElement(In.Stack,{direction:"row",gap:2},r().createElement(In.TextArea,{value:l,onChange:e=>c(e.currentTarget.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),_())},placeholder:"Type your message... (Enter to send, Shift+Enter for new line)",disabled:u,style:{flex:1},rows:3}),r().createElement(In.Button,{onClick:_,disabled:!l.trim()||u||h,variant:"primary"},u?r().createElement(In.Spinner,{size:"sm"}):"Send"))):r().createElement("div",null,"LLM plugin not enabled.")}function zs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Us(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){zs(e,t,r[t])})}return e}function qs(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const Vs=r().memo(({field:e,value:t,onChange:a})=>{const n=e=>{a(e)},s={label:e.name,description:e.description,required:e.required};if(e.enum&&e.enum.length>0){const a=e.enum.map(e=>({label:e,value:e}));return r().createElement(In.Field,s,r().createElement(In.Select,{options:a,value:t,onChange:e=>n(null==e?void 0:e.value),placeholder:e.example?`e.g., ${e.example}`:`Select ${e.name}...`,isClearable:!e.required}))}switch(e.type){case"boolean":return r().createElement(In.Field,s,r().createElement(In.Switch,{value:Boolean(t),onChange:e=>n(e.currentTarget.checked)}));case"number":case"integer":return r().createElement(In.Field,s,r().createElement(In.Input,{type:"number",value:t||"",onChange:t=>{const r="integer"===e.type?parseInt(t.currentTarget.value,10):parseFloat(t.currentTarget.value);n(isNaN(r)?void 0:r)},placeholder:e.example?`e.g., ${e.example}`:void 0}));case"array":return r().createElement(In.Field,qs(Us({},s),{description:`${e.description||""} (Enter one item per line)`}),r().createElement(In.TextArea,{value:Array.isArray(t)?t.join("\n"):"",onChange:e=>{const t=e.currentTarget.value.split("\n").filter(e=>e.trim());n(t.length>0?t:void 0)},placeholder:e.example?`e.g.,\n${Array.isArray(e.example)?e.example.join("\n"):e.example}`:"Enter items, one per line",rows:3}));case"object":return r().createElement(In.Field,qs(Us({},s),{description:`${e.description||""} (Enter valid JSON)`}),r().createElement(In.TextArea,{value:"object"==typeof t?JSON.stringify(t,null,2):t||"",onChange:e=>{try{const t=JSON.parse(e.currentTarget.value);n(t)}catch(t){n(e.currentTarget.value)}},placeholder:e.example?`e.g.,\n${JSON.stringify(e.example,null,2)}`:'{\n  "key": "value"\n}',rows:4}));default:return e.description&&e.description.length>100||e.name.toLowerCase().includes("description")||e.name.toLowerCase().includes("query")||e.name.toLowerCase().includes("message")?r().createElement(In.Field,s,r().createElement(In.TextArea,{value:t||"",onChange:e=>n(e.currentTarget.value||void 0),placeholder:e.example?`e.g., ${e.example}`:void 0,rows:3})):r().createElement(In.Field,s,r().createElement(In.Input,{value:t||"",onChange:e=>n(e.currentTarget.value||void 0),placeholder:e.example?`e.g., ${e.example}`:void 0}))}});function Zs({schema:e,onParametersChange:a,onSubmit:n,isLoading:s}){const o=(0,t.useMemo)(()=>function(e){if(!(null==e?void 0:e.properties))return[];const t=e.required||[];return Object.entries(e.properties).map(([e,r])=>({name:e,type:r.type||"string",required:t.includes(e),description:r.description,example:r.example,enum:r.enum,default:r.default}))}(e),[e]),[i,l]=(0,t.useState)(()=>{const e={};return o.forEach(t=>{void 0!==t.default&&(e[t.name]=t.default)}),e});(0,t.useEffect)(()=>{const e=Object.entries(i).reduce((e,[t,r])=>(void 0!==r&&""!==r&&null!==r&&(e[t]=r),e),{}),t=setTimeout(()=>{a(e)},100);return()=>clearTimeout(t)},[i,a]);const c=(0,t.useCallback)((e,t)=>{l(r=>qs(Us({},r),{[e]:t}))},[]),u=()=>o.every(e=>{if(!e.required)return!0;const t=i[e.name];return void 0!==t&&""!==t&&null!==t});return 0===o.length?r().createElement("div",{style:{padding:"16px",textAlign:"center"}},r().createElement("p",{style:{color:"var(--text-color-secondary)",marginBottom:"16px"}},"This tool requires no parameters."),r().createElement(In.Button,{variant:"primary",onClick:n,disabled:s},s?"Running...":"Run Tool")):r().createElement("div",{style:{padding:"16px"}},r().createElement("div",{style:{marginBottom:"20px"}},o.map(e=>r().createElement("div",{key:e.name,style:{marginBottom:"16px"}},r().createElement(Vs,{field:e,value:i[e.name],onChange:t=>c(e.name,t)})))),r().createElement(In.Button,{variant:"primary",onClick:n,disabled:s||!u(),style:{width:"100%"}},s?"Running...":"Run Tool"),!u()&&r().createElement("div",{style:{marginTop:"8px",fontSize:"12px",color:"var(--error-color)",textAlign:"center"}},"Please fill in all required fields"))}function Hs(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}function Bs(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var s=e.apply(t,r);function o(e){Hs(s,a,n,o,i,"next",e)}function i(e){Hs(s,a,n,o,i,"throw",e)}o(void 0)})}}Vs.displayName="FormFieldComponent";const Gs={list_teams:"Admin",list_users_by_org:"Admin",search_dashboards:"Search",get_dashboard_by_uid:"Dashboard",update_dashboard:"Dashboard",get_dashboard_panel_queries:"Dashboard",list_datasources:"Datasources",get_datasource_by_uid:"Datasources",get_datasource_by_name:"Datasources",query_prometheus:"Prometheus",list_prometheus_metric_metadata:"Prometheus",list_prometheus_metric_names:"Prometheus",list_prometheus_label_names:"Prometheus",list_prometheus_label_values:"Prometheus",list_incidents:"Incident",create_incident:"Incident",add_activity_to_incident:"Incident",get_incident:"Incident",query_loki_logs:"Loki",list_loki_label_names:"Loki",list_loki_label_values:"Loki",query_loki_stats:"Loki",list_alert_rules:"Alerting",get_alert_rule_by_uid:"Alerting",list_contact_points:"Alerting",list_oncall_schedules:"OnCall",get_oncall_shift:"OnCall",get_current_oncall_users:"OnCall",list_oncall_teams:"OnCall",list_oncall_users:"OnCall",get_sift_investigation:"Sift",get_sift_analysis:"Sift",list_sift_investigations:"Sift",find_error_pattern_logs:"Sift",find_slow_requests:"Sift",list_pyroscope_label_names:"Pyroscope",list_pyroscope_label_values:"Pyroscope",list_pyroscope_profile_types:"Pyroscope",fetch_pyroscope_profile:"Pyroscope",get_assertions:"Asserts"},Ks=r().memo(({tool:e})=>{var a,n;const{client:s}=On(),[o,i]=(0,t.useState)(!1),[l,c]=(0,t.useState)("{}"),[u,d]=(0,t.useState)({}),[p,h]=(0,t.useState)("form"),[m,f]=(0,t.useState)(null),v=(0,t.useCallback)(e=>{d(e)},[]),g=(0,t.useCallback)(Bs(function*(){if(s){f({loading:!0});try{let t={};if("form"===p)t=u;else if(l.trim())try{t=JSON.parse(l)}catch(e){return void f({loading:!1,success:!1,error:`Invalid JSON parameters: ${e instanceof Error?e.message:"Unknown error"}`})}const r=yield s.callTool({name:e.name,arguments:t});f({loading:!1,success:!0,response:r})}catch(e){f({loading:!1,success:!1,error:e instanceof Error?e.message:"Unknown error"})}}}),[s,p,u,l,e.name]),y=(0,t.useCallback)(()=>{var t;if(!(null===(t=e.inputSchema)||void 0===t?void 0:t.properties))return"{}";const r={},a=e.inputSchema.properties;return Object.keys(a).forEach(e=>{const t=a[e];t&&"object"==typeof t&&("string"===t.type?r[e]=t.example||"example_value":"number"===t.type?r[e]=t.example||42:"boolean"===t.type?r[e]=t.example||!0:"array"===t.type?r[e]=t.example||[]:"object"===t.type?r[e]=t.example||{}:r[e]=t.example||null)}),JSON.stringify(r,null,2)},[e.inputSchema]),_=(0,t.useCallback)(()=>{c(y())},[y]);return r().createElement("div",{style:{border:"1px solid var(--border-color)",borderRadius:"8px",marginBottom:"12px",backgroundColor:"var(--background-color-primary)"}},r().createElement("div",{style:{padding:"12px 16px",borderBottom:o?"1px solid var(--border-color)":"none",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onClick:()=>i(!o)},r().createElement("div",{style:{flex:1}},r().createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"}},r().createElement("code",{style:{fontWeight:500,fontSize:"15px",backgroundColor:"var(--background-color-secondary)",padding:"2px 6px",borderRadius:"3px",border:"1px solid var(--border-color)"}},e.name),(null===(a=e.annotations)||void 0===a?void 0:a.title)&&e.annotations.title!==e.name&&r().createElement("span",{style:{fontSize:"14px",color:"var(--text-color-secondary)"}},"(",e.annotations.title,")")),e.description&&r().createElement("div",{style:{fontSize:"13px",color:"var(--text-color-secondary)",lineHeight:"1.4",marginBottom:"4px"}},e.description),r().createElement("div",{style:{display:"flex",gap:"12px",fontSize:"12px",color:"var(--text-color-secondary)"}},(()=>{var t;const a=null===(t=e.inputSchema)||void 0===t?void 0:t.properties,n=a&&"object"==typeof a&&null!==a?Object.keys(a).length:0;return n>0?r().createElement("span",null,"Parameters: ",n):null})(),(()=>{var t;const a=null===(t=e.inputSchema)||void 0===t?void 0:t.required,n=Array.isArray(a)?a.length:0;return n>0?r().createElement("span",null,"Required: ",n):null})())),r().createElement(In.Icon,{name:o?"angle-up":"angle-down"})),o&&r().createElement("div",{style:{padding:"16px"}},r().createElement("div",{style:{marginBottom:"20px"}},r().createElement("h4",{style:{margin:"0 0 8px 0",fontSize:"14px"}},"Input Schema"),r().createElement("pre",{style:{backgroundColor:"var(--background-color-secondary)",padding:"12px",borderRadius:"4px",fontSize:"12px",lineHeight:"1.4",overflow:"auto",maxHeight:"200px",border:"1px solid var(--border-color)"}},(e=>{if(!e)return"No schema available";try{return JSON.stringify(e,null,2)}catch(t){return String(e)}})(e.inputSchema))),r().createElement("div",{style:{marginBottom:"16px"}},r().createElement("div",{style:{marginBottom:"12px"}},r().createElement("h4",{style:{margin:"0 0 8px 0",fontSize:"14px"}},"Test Parameters"),r().createElement(In.TabsBar,null,r().createElement(In.Tab,{label:"Form",active:"form"===p,onChangeTab:()=>h("form")}),r().createElement(In.Tab,{label:"JSON",active:"json"===p,onChangeTab:()=>h("json")}))),"form"===p?r().createElement(Zs,{schema:e.inputSchema,onParametersChange:v,onSubmit:g,isLoading:null==m?void 0:m.loading}):r().createElement("div",null,r().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}},r().createElement("span",{style:{fontSize:"12px",color:"var(--text-color-secondary)"}},"JSON Mode"),r().createElement(In.Button,{variant:"secondary",size:"sm",onClick:_,disabled:!(null===(n=e.inputSchema)||void 0===n?void 0:n.properties)},"Fill Example")),r().createElement(In.TextArea,{value:l,onChange:e=>c(e.currentTarget.value),placeholder:"Enter JSON parameters for testing...",rows:4,style:{fontFamily:"monospace",fontSize:"12px"}}),r().createElement("div",{style:{marginTop:"12px"}},r().createElement(In.Button,{variant:"primary",size:"sm",onClick:g,disabled:(null==m?void 0:m.loading)||!s},(null==m?void 0:m.loading)?r().createElement(In.Spinner,{size:"sm"}):"Test Tool")))),m&&!m.loading&&r().createElement("div",{style:{marginTop:"16px"}},r().createElement("h4",{style:{margin:"0 0 8px 0",fontSize:"14px"}},"Result"," ",m.success?r().createElement(In.Icon,{name:"check",style:{color:"var(--success-color)",marginLeft:"8px"}}):r().createElement(In.Icon,{name:"exclamation-triangle",style:{color:"var(--error-color)",marginLeft:"8px"}})),m.error?r().createElement("div",{style:{backgroundColor:"var(--error-background)",color:"var(--error-text-color)",padding:"12px",borderRadius:"4px",fontSize:"13px"}},m.error):r().createElement("pre",{style:{backgroundColor:"var(--background-color-secondary)",padding:"12px",borderRadius:"4px",fontSize:"12px",lineHeight:"1.4",overflow:"auto",maxHeight:"300px",border:"1px solid var(--border-color)"}},JSON.stringify(m.response,null,2)))))});function Qs({tools:e}){const[a,n]=(0,t.useState)(""),s=r().useMemo(()=>{const t=a.toLowerCase();return e.filter(e=>{var r;const a=e.name.toLowerCase();var n;const s=(null!==(n=null===(r=e.annotations)||void 0===r?void 0:r.title)&&void 0!==n?n:"").toLowerCase(),o=(e.description||"").toLowerCase();return a.includes(t)||s.includes(t)||o.includes(t)})},[e,a]),{groupedTools:o,sortedCategories:i}=r().useMemo(()=>{const e=s.reduce((e,t)=>{const r=Gs[t.name]||"Ungrouped";return e[r]||(e[r]=[]),e[r].push(t),e},{});return{groupedTools:e,sortedCategories:Object.keys(e).sort((e,t)=>"Ungrouped"===e?1:"Ungrouped"===t?-1:e.localeCompare(t))}},[s]);return 0===e.length?r().createElement("div",{style:{color:"var(--text-color-secondary)",fontStyle:"italic",textAlign:"center",padding:"24px"}},"No MCP tools available"):r().createElement("div",null,r().createElement("div",{style:{marginBottom:"16px"}},r().createElement("input",{type:"text",placeholder:"Search tools...",value:a,onChange:e=>n(e.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--background-color-primary)",fontSize:"14px"}})),r().createElement("div",null,0===s.length?r().createElement("div",{style:{color:"var(--text-color-secondary)",fontStyle:"italic",textAlign:"center",padding:"24px"}},"No tools match your search"):i.map(e=>r().createElement(In.CollapsableSection,{key:e,label:`${e} (${o[e].length})`,isOpen:!0},r().createElement("div",{style:{marginTop:"8px"}},o[e].map(e=>r().createElement(Ks,{key:e.name,tool:e})))))))}function Ws(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}function Js(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var s=e.apply(t,r);function o(e){Ws(s,a,n,o,i,"next",e)}function i(e){Ws(s,a,n,o,i,"throw",e)}o(void 0)})}}function Xs(){var e;const{client:a}=On(),[n,s]=(0,t.useState)("chat"),[o,i]=(0,t.useState)(!0),[l,c]=(0,t.useState)(new Map),{loading:u,error:d,value:p}=z(Js(function*(){if(!(yield Ss()))return{enabled:!1,tools:[]};var e;const{tools:t}=null!==(e=yield null==a?void 0:a.listTools())&&void 0!==e?e:{tools:[]};return{enabled:!0,tools:t}}),[a]);return d?r().createElement("div",null,"Error: ",d.message):(null==p?void 0:p.enabled)?r().createElement(r().Fragment,null,r().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"}},r().createElement(In.TabsBar,null,r().createElement(In.Tab,{label:"Chat",active:"chat"===n,onChangeTab:()=>s("chat")}),r().createElement(In.Tab,{label:"Tool Inspector",active:"tools"===n,onChangeTab:()=>s("tools"),counter:(null==p||null===(e=p.tools)||void 0===e?void 0:e.length)||0})),"chat"===n&&r().createElement(In.Checkbox,{label:"Streaming",value:o,onChange:e=>i(e.currentTarget.checked)})),r().createElement("div",{style:{paddingTop:10,minHeight:400,display:"flex",flexDirection:"column"}},"chat"===n&&r().createElement(Ms,{useStream:o,toolCalls:l,setToolCalls:c}),"tools"===n&&r().createElement(Qs,{tools:(null==p?void 0:p.tools)||[]}))):r().createElement("div",null,"LLM plugin not enabled.")}Ks.displayName="ToolInspector";const Ys=()=>{const[e,a]=(0,t.useState)(!1),n=()=>{a(!1)};return r().createElement(In.FieldSet,{label:"Development Sandbox"},r().createElement(In.Button,{onClick:()=>a(!0)},"Open development sandbox"),r().createElement(In.Modal,{title:"Development Sandbox",isOpen:e,onDismiss:n},r().createElement(t.Suspense,{fallback:r().createElement(In.LoadingPlaceholder,{text:"Loading MCP..."})},r().createElement(Sn,{appName:"Grafana App With Model Context Protocol",appVersion:"1.0.0"},r().createElement(Xs,null))),r().createElement("div",{style:{marginTop:"16px",display:"flex",justifyContent:"flex-end"}},r().createElement(In.Button,{variant:"primary",onClick:n},"Close"))))};function eo({modelMapping:e,modelNames:t,onChange:a}){return r().createElement(r().Fragment,null,r().createElement(In.IconButton,{name:"plus","aria-label":"Add model mapping",onClick:t=>{t.preventDefault(),a([...e,["",""]])}}),e.map(([n,s],o)=>r().createElement(to,{key:o,model:n,deployment:s,modelNames:t,onChange:(t,r)=>{a([...e.slice(0,o),[t,r],...e.slice(o+1)])},onRemove:()=>a([...e.slice(0,o),...e.slice(o+1)])})))}function to({model:e,deployment:t,modelNames:a,onChange:n,onRemove:s}){return r().createElement(In.InlineFieldRow,null,r().createElement(In.InlineField,{label:"Model"},r().createElement(In.Select,{placeholder:"model label",options:a.filter(e=>e!==t&&""!==e).map(e=>({label:e,value:e})),value:e,onChange:e=>void 0!==e.value&&n(e.value,t)})),r().createElement(In.InlineField,{label:"Deployment"},r().createElement(In.Input,{width:40,name:"AzureDeployment",placeholder:"deployment name",value:t,onChange:t=>void 0!==t.currentTarget.value&&n(e,t.currentTarget.value)})),r().createElement(In.IconButton,{name:"trash-alt","aria-label":"Remove model mapping",onClick:e=>{e.preventDefault(),s()}}))}function ro(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ao(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){ro(e,t,r[t])})}return e}function no(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const so="https://api.openai.com";function oo({settings:e,secrets:a,secretsSet:l,onChange:c,onChangeSecrets:p,allowCustomPath:h=!1,parentProvider:m}){const f=(0,In.useStyles2)(Mo);var v;const g=null!==(v=e.provider)&&void 0!==v?v:"openai",y=t=>{c(no(ao({},e),{[t.currentTarget.name]:"checkbox"===t.currentTarget.type?t.currentTarget.checked:t.currentTarget.value.trim()}))},[_,b]=(0,t.useState)(void 0!==e.apiPath);var E,w,P;return(0,t.useEffect)(()=>{var t;const r=_?null!==(t=e.apiPath)&&void 0!==t?t:"":void 0;c(no(ao({},e),{apiPath:r}))},[_]),r().createElement(In.FieldSet,null,"custom"!==m&&r().createElement(In.Field,{label:"Provider"},r().createElement(In.Select,{"data-testid":n,options:[{label:"OpenAI",value:"openai"},{label:"Azure OpenAI",value:"azure"}],value:g,onChange:t=>{return r=t.value,void c(no(ao({},e),{provider:r,url:"openai"===r?so:""}));var r},width:60})),r().createElement(In.Field,{label:"azure"===g?"Azure OpenAI Language API Endpoint":"API URL",className:f.marginTop},r().createElement(In.Input,{width:60,name:"url","data-testid":d,value:"openai"===g&&"custom"!==m?so:e.url,placeholder:"azure"===g?"https://<resource-name>.openai.azure.com":"openai"===g?so:"https://llm.domain.com",onChange:y,disabled:"openai"===g&&"custom"!==m})),h&&r().createElement(In.Field,{label:"API Path",description:"Customize the API path appended to the URL. Defaults to /v1 if unchecked.",className:f.marginTop},r().createElement(In.Stack,{direction:"row",gap:1,alignItems:"center"},r().createElement(In.Checkbox,{"data-testid":o,name:"Use custom API path",value:_,onChange:e=>b(e.currentTarget.checked)}),r().createElement(In.Input,{width:57,name:"apiPath","data-testid":i,value:null!==(E=e.apiPath)&&void 0!==E?E:"",placeholder:_?"":"/v1",onChange:y,disabled:!_}))),r().createElement(In.Field,{label:"azure"===g?"Azure OpenAI Key":"API Key"},r().createElement(In.SecretInput,{width:60,"data-testid":s,name:"openAIKey",value:a.openAIKey,isConfigured:null!==(w=l.openAIKey)&&void 0!==w&&w,placeholder:"azure"===g?"":"sk-...",onChange:e=>p(no(ao({},a),{openAIKey:e.currentTarget.value})),onReset:()=>p(no(ao({},a),{openAIKey:""}))})),"openai"===g&&r().createElement(In.Field,{label:"API Organization ID"},r().createElement(In.Input,{width:60,name:"organizationId","data-testid":u,value:e.organizationId,placeholder:e.organizationId?"":"org-...",onChange:y})),"azure"===g&&r().createElement(In.Field,{label:"Azure OpenAI Model Mapping",description:"Mapping from model name to Azure deployment name."},r().createElement(eo,{modelMapping:null!==(P=e.azureModelMapping)&&void 0!==P?P:[],modelNames:Object.values(ys),onChange:t=>c(no(ao({},e),{azureModelMapping:t}))})))}function io({width:e,height:t}){const a=(0,In.useTheme2)();return r().createElement("svg",{width:e,height:t,viewBox:"0 0 320 320",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("g",{clipPath:"url(#clip0_10145_290560)"},r().createElement("path",{d:"M297.06 130.97C304.32 109.18 301.82 85.31 290.21 65.49C272.75 35.09 237.65 19.45 203.37 26.81C188.12 9.63002 166.21 -0.139981 143.24 1.93887e-05C108.2 -0.0799806 77.11 22.48 66.33 55.82C43.82 60.43 24.39 74.52 13.02 94.49C-4.57001 124.81 -0.560007 163.03 22.94 189.03C15.68 210.82 18.18 234.69 29.79 254.51C47.25 284.91 82.35 300.55 116.63 293.19C131.87 310.37 153.79 320.14 176.76 319.99C211.82 320.08 242.92 297.5 253.7 264.13C276.21 259.52 295.64 245.43 307.01 225.46C324.58 195.14 320.56 156.95 297.07 130.95L297.06 130.97ZM176.78 299.08C162.75 299.1 149.16 294.19 138.39 285.2C138.88 284.94 139.73 284.47 140.28 284.13L204 247.33C207.26 245.48 209.26 242.01 209.24 238.26V148.43L236.17 163.98C236.46 164.12 236.65 164.4 236.69 164.72V239.11C236.65 272.19 209.86 299.01 176.78 299.08ZM47.94 244.05C40.91 231.91 38.38 217.68 40.79 203.87C41.26 204.15 42.09 204.66 42.68 205L106.4 241.8C109.63 243.69 113.63 243.69 116.87 241.8L194.66 196.88V227.98C194.68 228.3 194.53 228.61 194.28 228.81L129.87 266C101.18 282.52 64.54 272.7 47.95 244.05H47.94ZM31.17 104.96C38.17 92.8 49.22 83.5 62.38 78.67C62.38 79.22 62.35 80.19 62.35 80.87V154.48C62.33 158.22 64.33 161.69 67.58 163.54L145.37 208.45L118.44 224C118.17 224.18 117.83 224.21 117.53 224.08L53.11 186.86C24.48 170.28 14.66 133.65 31.16 104.97L31.17 104.96ZM252.43 156.45L174.64 111.53L201.57 95.99C201.84 95.81 202.18 95.78 202.48 95.91L266.9 133.1C295.58 149.67 305.41 186.36 288.84 215.04C281.83 227.18 270.79 236.48 257.64 241.32V165.51C257.67 161.77 255.68 158.31 252.44 156.45H252.43ZM279.23 116.11C278.76 115.82 277.93 115.32 277.34 114.98L213.62 78.18C210.39 76.29 206.39 76.29 203.15 78.18L125.36 123.1V92C125.34 91.68 125.49 91.37 125.74 91.17L190.15 54.01C218.84 37.46 255.52 47.31 272.06 76.01C279.05 88.13 281.58 102.32 279.21 116.11H279.23ZM110.72 171.54L83.78 155.99C83.49 155.85 83.3 155.57 83.26 155.25V80.86C83.28 47.74 110.15 20.9 143.27 20.92C157.28 20.92 170.84 25.84 181.61 34.8C181.12 35.06 180.28 35.53 179.72 35.87L116 72.67C112.74 74.52 110.74 77.98 110.76 81.73L110.72 171.52V171.54ZM125.35 140L160 119.99L194.65 139.99V180L160 200L125.35 180V140Z",fill:a.colors.text.primary})),r().createElement("defs",null,r().createElement("clipPath",{id:"clip0_10145_290560"},r().createElement("rect",{width:"320",height:"320",fill:a.colors.text.primary}))))}function lo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function co(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){lo(e,t,r[t])})}return e}function uo(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const po="https://api.anthropic.com";function ho({settings:e,secrets:t,secretsSet:a,onChange:n,onChangeSecrets:s}){const o=(0,In.useStyles2)(Mo);var i;return r().createElement(In.FieldSet,null,r().createElement(In.Field,{label:"API URL",className:o.marginTop},r().createElement(In.Input,{width:60,name:"url","data-testid":h,value:po,placeholder:po,onChange:t=>{n(uo(co({},e),{[t.currentTarget.name]:"checkbox"===t.currentTarget.type?t.currentTarget.checked:t.currentTarget.value.trim()}))},disabled:!0})),r().createElement(In.Field,{label:"API Key"},r().createElement(In.SecretInput,{width:60,"data-testid":p,name:"anthropicKey",value:t.anthropicKey,isConfigured:null!==(i=a.anthropicKey)&&void 0!==i&&i,placeholder:a.anthropicKey?"sk-ant-...":"not configured",onChange:e=>s(uo(co({},t),{anthropicKey:e.currentTarget.value})),onReset:()=>s(uo(co({},t),{anthropicKey:""}))})))}function mo({width:e,height:t}){const a=(0,In.useTheme2)();return r().createElement("svg",{width:e,height:t,viewBox:"0 0 92.2 65",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M66.5,0H52.4l25.7,65h14.1L66.5,0z M25.7,0L0,65h14.4l5.3-13.6h26.9L51.8,65h14.4L40.5,0C40.5,0,25.7,0,25.7,0z M24.3,39.3l8.8-22.8l8.8,22.8H24.3z",fill:a.colors.text.primary}))}function fo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){fo(e,t,r[t])})}return e}function go(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function yo({settings:e,secrets:a,secretsSet:n,optIn:s,setOptIn:o,onChange:i,onChangeSecrets:l}){const c=(0,In.useStyles2)(_o),u=!0===e.enableGrafanaManagedLLM,d=function(e){var t;if(e.disabled||(null===(t=e.openAI)||void 0===t?void 0:t.disabled))return"disabled";switch(Do(e)){case"azure":case"openai":return"openai";case"custom":return"custom";case"test":return"test";case"grafana":return"grafana-provided";case"anthropic":return"anthropic";default:return"unconfigured"}}(e),[p,h]=(0,t.useState)(),[m,f]=(0,t.useState)(null),v=(t,r)=>{(()=>{var t;const r=null===(t=e.models)||void 0===t?void 0:t.mapping;return r&&Object.keys(r).some(e=>r[e])})()&&Do(e)!==t?f({isOpen:!0,title:"Switch LLM Provider?",message:`You have existing model configurations that may not be compatible with the new provider. Your current model mappings will be preserved, but you may need to update the model names to work with ${g(t)}.`,onConfirm:()=>{r(),f(null)},onCancel:()=>{f(null)}}):r()},g=e=>{switch(e){case"openai":return"OpenAI";case"anthropic":return"Anthropic";case"azure":return"Azure OpenAI";case"custom":return"Custom API";case"grafana":return"Grafana-provided OpenAI";case"test":return"Test Provider";default:return"the selected provider"}};var y,_,b,E,w,P,x,S,O;return r().createElement(r().Fragment,null,e.enableDevSandbox&&r().createElement(Ys,null),r().createElement(In.FieldSet,{label:"LLM Provider Configuration",className:c.sidePadding},u&&r().createElement("div",{className:c.providerSection},r().createElement("div",{className:c.sectionHeader},r().createElement("h4",null,"Grafana-Provided Service"," ","grafana-provided"===d&&r().createElement(In.Badge,{text:"Currently Active",color:"green"}))),r().createElement("div",{onClick:()=>{"grafana-provided"!==d&&(void 0===p&&h(e.provider),i(go(vo({},e),{provider:"grafana",disabled:!1,openAI:{disabled:!1}})))}},r().createElement(In.Card,{isSelected:"grafana-provided"===d,className:c.cardWithoutBottomMargin},r().createElement(In.Card.Heading,null,"Use OpenAI provided by Grafana"),r().createElement(In.Card.Description,null,r().createElement("div",null,"Enable LLM features in Grafana by using a connection to OpenAI that is provided by Grafana"),"grafana-provided"===d&&r().createElement(r().Fragment,null,r().createElement("div",{className:c.openaiTermsBox},r().createElement("h4",null,"Terms of Usage (Last updated: February 16th, 2024)"),r().createElement("div",null,"To enable OpenAI via Grafana Labs, please note that some data from your Grafana instance will be sent to OpenAI when you use the LLM-based features. Grafana Labs imposes usage limits for this service."),r().createElement("div",null,"Additionally, the following terms (\"AI Terms\") are hereby added to and become part of your licensing agreement with Grafana Labs (the \"Agreement\") as additional terms. Capitalized terms not defined in these AI Terms have the meanings given in the Agreement. These terms apply to your specific use of the OpenAI via Grafana Labs feature(s), and are separate, necessary terms regarding your use of this feature and therefore are not 'click-wrap', 'shrink-wrap', different or additional terms, or the like, to the extent your licensing agreement with Grafana Labs purports to supersede any such terms."),r().createElement("ul",null,r().createElement("li",null,"Grafana Labs uses OpenAI's API platform to provide the LLM features."),r().createElement("li",null,"OpenAI does not train aggregated models on inputs or outputs of the API platform as used in connection with Grafana Labs Product(s)."),r().createElement("li",null,"OpenAI does retain data for a short time in order to provide the services and monitor for abuse. All data sent to OpenAI is encrypted in transit and at rest."),r().createElement("li",null,"All features utilizing OpenAI are clearly marked in the Grafana Labs Product(s), and each feature sends minimal data to OpenAIand only at the request of a user (for example, when a user clicks the button to request an Incident auto-summary)."),r().createElement("li",null,"Grafana Labs will add new features regularly that utilize features connecting to OpenAI's APIs, which may include, but are not limited to:",r().createElement("ul",null,r().createElement("li",null,"Explaining Flamegraphs & offer suggestions to fix issues"),r().createElement("li",null,"Incident auto-summary"),r().createElement("li",null,"Suggesting names & descriptions for panels & dashboards, and summarize differences when saving changes"),r().createElement("li",null,"Explaining error log lines in Sift"),r().createElement("li",null,"Generating KQL queries in the Azure Data Explorer plugin"))),r().createElement("li",null,"Visit the OpenAI trust portal for more detail about OpenAI:"," ",r().createElement(In.Button,{size:"sm",variant:"secondary",onClick:e=>{window.open("https://trust.openai.com/","_blank"),e.stopPropagation()}},"https://trust.openai.com/")),r().createElement("li",null,"If you enable this feature, OpenAI will be a subprocessor of Grafana Labs for the purpose of any data processing agreement you may have in place with Grafana Labs."),r().createElement("li",null,"Disclaimer. Outputs are generated through machine learning processes and are not tested, verified, endorsed or guaranteed to be accurate, complete or current by Grafana Labs. You should independently review and verify all outputs as to appropriateness for any or all of your use cases or applications. The warranties, disclaimers, and limitations of liability in the Agreement apply to the AI Features."))),r().createElement("div",null,'By clicking the "I Accept" button, you agree to these additional AI Terms on behalf of yourself and/or your organization. Please read these terms carefully before proceeding. If you do not agree to these terms, do not click the "I Accept" button.'),r().createElement(In.Checkbox,{value:s,onClick:()=>{o(!s)},label:"I Accept"}))),r().createElement(In.Card.Figure,null,r().createElement(In.Icon,{name:"grafana",size:"lg"}))))),r().createElement("div",{className:c.providerSection},r().createElement("div",{className:c.sectionHeader},r().createElement("h4",null,"Bring Your Own Service"," ",u&&("openai"===d||"anthropic"===d||"custom"===d)&&r().createElement(In.Badge,{text:"Currently Active",color:"green"}))),r().createElement("div",{onClick:()=>{"openai"!==d&&v("openai",()=>{"openai"===p||"azure"===p?(i(go(vo({},e),{provider:p,disabled:!1,openAI:{disabled:!1}})),h(void 0)):(i(go(vo({},e),{provider:"openai",disabled:!1,openAI:{disabled:!1}})),h(void 0))})}},r().createElement(In.Card,{isSelected:"openai"===d,className:c.cardWithoutBottomMargin},r().createElement(In.Card.Heading,null,"Use OpenAI-compatible API"),r().createElement(In.Card.Description,null,"Enable LLM features in Grafana using OpenAI-compatible API","openai"===d&&r().createElement(r().Fragment,null,r().createElement(oo,{settings:null!==(y=e.openAI)&&void 0!==y?y:{},onChange:t=>i(go(vo({},e),{openAI:t})),secrets:a,secretsSet:n,onChangeSecrets:l,allowCustomPath:!1,parentProvider:e.provider}),r().createElement(As,{provider:null!==(_=e.provider)&&void 0!==_?_:"openai",settings:null!==(b=e.models)&&void 0!==b?b:{mapping:{}},onChange:t=>i(go(vo({},e),{models:t}))}))),r().createElement(In.Card.Figure,null,r().createElement(io,{width:20,height:20})))),r().createElement("div",{onClick:()=>{"anthropic"!==d&&v("anthropic",()=>{i(go(vo({},e),{provider:"anthropic",disabled:!1}))})}},r().createElement(In.Card,{isSelected:"anthropic"===d,className:c.cardWithoutBottomMargin},r().createElement(In.Card.Heading,null,"Use Anthropic API"),r().createElement(In.Card.Description,null,"Enable LLM features in Grafana using Anthropic's Claude models","anthropic"===d&&r().createElement(r().Fragment,null,r().createElement(ho,{settings:null!==(E=e.anthropic)&&void 0!==E?E:{},onChange:t=>i(go(vo({},e),{anthropic:t})),secrets:a,secretsSet:n,onChangeSecrets:l}),r().createElement(As,{provider:null!==(w=e.provider)&&void 0!==w?w:"anthropic",settings:null!==(P=e.models)&&void 0!==P?P:{mapping:{}},onChange:t=>i(go(vo({},e),{models:t}))}))),r().createElement(In.Card.Figure,null,r().createElement(mo,{width:20,height:20})))),r().createElement("div",{onClick:()=>{"custom"!==d&&v("custom",()=>{i(go(vo({},e),{provider:"custom",disabled:!1,openAI:{disabled:!1}}))})}},r().createElement(In.Card,{isSelected:"custom"===d,className:c.cardWithoutBottomMargin},r().createElement(In.Card.Heading,null,"Use a Custom API"),r().createElement(In.Card.Description,null,'Enable LLM features in Grafana using a custom API (with "OpenAI-like" signature)',"custom"===d&&r().createElement(r().Fragment,null,r().createElement(oo,{settings:null!==(x=e.openAI)&&void 0!==x?x:{},onChange:t=>i(go(vo({},e),{openAI:t})),secrets:a,secretsSet:n,onChangeSecrets:l,allowCustomPath:!0,parentProvider:e.provider}),r().createElement(As,{provider:null!==(S=e.provider)&&void 0!==S?S:"custom",settings:null!==(O=e.models)&&void 0!==O?O:{mapping:{}},onChange:t=>i(go(vo({},e),{models:t}))}))),r().createElement(In.Card.Figure,null,r().createElement(In.Icon,{name:"ai",size:"lg"})))),!1,r().createElement(In.Card,{isSelected:"disabled"===d,onClick:()=>{"disabled"!==d&&(void 0===p&&h(e.provider),i(go(vo({},e),{provider:void 0,disabled:!0,openAI:go(vo({},e.openAI),{disabled:!0})})))},className:c.cardWithoutBottomMargin},r().createElement(In.Card.Heading,null,"Disable all LLM features in Grafana"),r().createElement(In.Card.Description,null,""),r().createElement(In.Card.Figure,null,r().createElement(In.Icon,{name:"times",size:"lg"}))))),m&&r().createElement(In.ConfirmModal,{isOpen:m.isOpen,title:m.title,body:m.message,confirmText:"Switch Provider",dismissText:"Cancel",onConfirm:m.onConfirm,onDismiss:m.onCancel}))}const _o=e=>({sidePadding:jn.css`
    margin-left: ${e.spacing(1)};
    margin-right: ${e.spacing(1)};
  `,nestedList:jn.css`
    margin-left: ${e.spacing(3)};
  `,openaiTermsBox:(0,jn.css)({overflowY:"auto",height:"250px",marginRight:e.spacing(3),marginBottom:e.spacing(1),padding:`${e.spacing(1)} ${e.spacing(2)} ${e.spacing(1)} ${e.spacing(2)}`,border:`1px solid ${e.colors.border.medium}`,background:e.colors.background.primary,color:e.colors.text.primary," ul":{paddingLeft:e.spacing(2)},"> ul > li:not(:last-child)":{marginBottom:e.spacing(.5)}}),cardWithoutBottomMargin:jn.css`
    margin-bottom: 0;
    margin-top: ${e.spacing(1)};
  `,sectionHeader:jn.css`
    margin-top: ${e.spacing(3)};
    margin-bottom: ${e.spacing(2)};
    display: flex;
    align-items: center;
    gap: ${e.spacing(1)};

    h4 {
      margin: 0;
      color: ${e.colors.text.primary};
      font-weight: ${e.typography.fontWeightMedium};
      display: flex;
      align-items: center;
      gap: ${e.spacing(1)};
    }
  `,providerSection:jn.css`
    background: ${e.colors.background.secondary};
    border: 1px solid ${e.colors.border.weak};
    border-radius: ${e.shape.borderRadius()};
    padding: ${e.spacing(2)};
    margin-bottom: ${e.spacing(2)};

    &:last-child {
      margin-bottom: 0;
    }
  `});function bo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){bo(e,t,r[t])})}return e}function wo(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const Po=({settings:e,secrets:t,secretsSet:a,onChange:n,onChangeSecrets:s,secretKey:o})=>{const i=(0,In.useStyles2)(Mo);var l;return r().createElement(r().Fragment,null,r().createElement(In.InlineField,{label:"User",labelWidth:i.inlineFieldWidth},r().createElement(In.Input,{width:i.inlineFieldInputWidth,placeholder:"user","data-testid":E,value:null==e?void 0:e.basicAuthUser,onChange:t=>n(wo(Eo({},e),{basicAuthUser:t.currentTarget.value}))})),r().createElement(In.InlineField,{label:"Password",labelWidth:i.inlineFieldWidth},r().createElement(In.SecretInput,{width:i.inlineFieldInputWidth,placeholder:"password","data-testid":w,value:t[o],isConfigured:null!==(l=a[o])&&void 0!==l&&l,onReset:()=>{s(wo(Eo({},t),{[o]:""}))},onChange:e=>{s(wo(Eo({},t),{[o]:e.currentTarget.value}))}})))};function xo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function So(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){xo(e,t,r[t])})}return e}function Oo(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const ko="text-embedding-ada-002";function Co({settings:e,secrets:t,secretsSet:a,onChange:n,onChangeSecrets:s}){var o,i,l;return r().useEffect(()=>{var t,r;"openai"===(null==e||null===(t=e.embed)||void 0===t?void 0:t.type)&&(null==e?void 0:e.model)!==ko?n(Oo(So({},e),{model:ko})):"grafana/vectorapi"!==(null==e||null===(r=e.embed)||void 0===r?void 0:r.type)||void 0!==(null==e?void 0:e.model)&&(null==e?void 0:e.model)!==ko||n(Oo(So({},e),{model:"BAAI/bge-small-en-v1.5"}))},[e,null==e||null===(o=e.embed)||void 0===o?void 0:o.type,n]),r().createElement(In.FieldSet,{label:"Vector Settings"},r().createElement(In.Field,{label:"Enabled",description:"Enable vector database powered features."},r().createElement(In.Checkbox,{name:"enabled","data-testid":m,value:(null==e?void 0:e.enabled)||!1,onChange:t=>n(Oo(So({},e),{enabled:t.currentTarget.checked}))})),(null==e?void 0:e.enabled)&&r().createElement(r().Fragment,null,r().createElement(In.Field,{label:"Model",description:"The model used by the embedder and for embeddings stored in the store",disabled:"openai"===(null===(i=e.embed)||void 0===i?void 0:i.type)||void 0===(null===(l=e.embed)||void 0===l?void 0:l.type)},r().createElement(In.Input,{width:60,name:"model","data-testid":_,value:null==e?void 0:e.model,placeholder:null==e?void 0:e.model,onChange:t=>n(Oo(So({},e),{model:t.currentTarget.value}))})),r().createElement(Io,{settings:null==e?void 0:e.embed,secrets:t,secretsSet:a,onChange:t=>n(Oo(So({},e),{embed:t})),onChangeSecrets:s}),r().createElement(Ro,{settings:null==e?void 0:e.store,secrets:t,secretsSet:a,onChange:t=>n(Oo(So({},e),{store:t})),onChangeSecrets:s})))}function Io({settings:e,secrets:t,secretsSet:a,onChange:n,onChangeSecrets:s}){var o,i,l;const c=(0,In.useStyles2)(Mo);var u;return r().createElement(r().Fragment,null,r().createElement("h4",null,"Embedder"),r().createElement(In.Field,{label:"Embedder Provider",description:"Select the embedder API to use"},r().createElement(r().Fragment,null,r().createElement(In.Select,{options:[{label:"OpenAI API",value:"openai"},{label:"Grafana Vector API",value:"grafana/vectorapi"}],placeholder:"Select Embedder Provider",value:null==e?void 0:e.type,width:60,onChange:e=>n({type:e.value})}),"openai"===(null==e?void 0:e.type)&&r().createElement(In.Label,null," Using configured OpenAI as embedder provider "))),"grafana/vectorapi"===(null==e?void 0:e.type)&&r().createElement(r().Fragment,null,r().createElement(In.Field,{label:"Auth Type"},r().createElement(In.Select,{options:[{label:"No Auth",value:"no-auth"},{label:"Basic Auth",value:"basic-auth"}],value:null!==(u=null==e||null===(o=e.grafanaVectorAPI)||void 0===o?void 0:o.authType)&&void 0!==u?u:"no-auth",onChange:t=>void 0!==t.value&&n(Oo(So({},e),{grafanaVectorAPI:Oo(So({},e.grafanaVectorAPI),{authType:t.value})})),width:60})),r().createElement(In.InlineField,{label:"URL",tooltip:"Address of the Grafana Vector API",labelWidth:c.inlineFieldWidth},r().createElement(In.Input,{name:"url",value:null==e||null===(i=e.grafanaVectorAPI)||void 0===i?void 0:i.url,width:c.inlineFieldInputWidth,"data-testid":y,placeholder:"http://vectorapi:8889",onChange:t=>n(Oo(So({},e),{grafanaVectorAPI:Oo(So({},e.grafanaVectorAPI),{url:t.currentTarget.value})}))})),"basic-auth"===(null==e||null===(l=e.grafanaVectorAPI)||void 0===l?void 0:l.authType)&&r().createElement(Po,{settings:e.grafanaVectorAPI,secrets:t,secretsSet:a,onChange:t=>n(Oo(So({},e),{grafanaVectorAPI:t})),onChangeSecrets:s,secretKey:"vectorEmbedderBasicAuthPassword"})))}function $o({settings:e,secrets:t,secretsSet:a,onChange:n,onChangeSecrets:s}){const o=(0,In.useStyles2)(Mo);var i;return r().createElement(r().Fragment,null,r().createElement(In.Field,{label:"Address",description:"Address of the qdrant gRPC server"},r().createElement(In.Input,{width:o.inlineFieldInputWidth,name:"url","data-testid":f,value:null==e?void 0:e.address,placeholder:"localhost:6334",onChange:t=>n(Oo(So({},e),{address:t.currentTarget.value}))})),r().createElement(In.Field,{label:"Secure",description:"Whether to use a secure connection"},r().createElement(In.Checkbox,{name:"secure","data-testid":v,checked:null==e?void 0:e.secure,onChange:t=>n(Oo(So({},e),{secure:t.currentTarget.checked}))})),(null==e?void 0:e.secure)&&r().createElement(In.Field,{label:"API key",description:"API key for the qdrant gRPC server"},r().createElement(In.SecretInput,{name:"qdrantApiKey",width:o.inlineFieldInputWidth,"data-testid":g,onChange:e=>s(Oo(So({},t),{qdrantApiKey:e.currentTarget.value})),onReset:()=>s(Oo(So({},t),{qdrantApiKey:""})),isConfigured:null!==(i=a.qdrantApiKey)&&void 0!==i&&i,value:t.qdrantApiKey})))}function Ao({settings:e,onChange:t}){const a=(0,In.useStyles2)(Mo);return r().createElement(r().Fragment,null,r().createElement(In.InlineField,{label:"URL",tooltip:"Address of the Grafana Vector API",labelWidth:a.inlineFieldWidth},r().createElement(In.Input,{name:"url",value:null==e?void 0:e.url,width:a.inlineFieldInputWidth,"data-testid":y,placeholder:"http://vectorapi:8889",onChange:r=>t(Oo(So({},e),{url:r.currentTarget.value}))})))}function Ro({settings:e,secrets:t,secretsSet:a,onChange:n,onChangeSecrets:s}){var o,i,l;return r().createElement(r().Fragment,null,r().createElement("h4",null,"Store"),r().createElement(In.Field,{label:"Store Type",description:"The type of store"},r().createElement(In.Select,{options:[{label:"Qdrant",value:"qdrant"},{label:"Grafana Vector API",value:"grafana/vectorapi"}],value:null==e?void 0:e.type,onChange:t=>void 0!==t.value&&n(Oo(So({},e),{type:t.value,qdrant:void 0,grafanaVectorAPI:void 0})),width:60})),"qdrant"===(null==e?void 0:e.type)&&r().createElement($o,{settings:e.qdrant,secrets:t,secretsSet:a,onChange:t=>n(Oo(So({},e),{qdrant:t})),onChangeSecrets:s}),"grafana/vectorapi"===(null==e?void 0:e.type)&&r().createElement(r().Fragment,null,r().createElement(In.Field,{label:"Auth Type"},r().createElement(In.Select,{options:[{label:"No Auth",value:"no-auth"},{label:"Basic Auth",value:"basic-auth"}],value:null!==(l=null==e||null===(o=e.grafanaVectorAPI)||void 0===o?void 0:o.authType)&&void 0!==l?l:"no-auth",onChange:t=>void 0!==t.value&&n(Oo(So({},e),{grafanaVectorAPI:Oo(So({},e.grafanaVectorAPI),{authType:t.value})})),width:60})),r().createElement(Ao,{settings:e.grafanaVectorAPI,onChange:t=>n(Oo(So({},e),{grafanaVectorAPI:t}))})),"grafana/vectorapi"===(null==e?void 0:e.type)&&"basic-auth"===(null==e||null===(i=e.grafanaVectorAPI)||void 0===i?void 0:i.authType)&&r().createElement(Po,{settings:e.grafanaVectorAPI,secrets:t,secretsSet:a,onChange:t=>n(Oo(So({},e),{grafanaVectorAPI:t})),onChangeSecrets:s,secretKey:"vectorStoreBasicAuthPassword"}))}function To(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}function jo(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var s=e.apply(t,r);function o(e){To(s,a,n,o,i,"next",e)}function i(e){To(s,a,n,o,i,"throw",e)}o(void 0)})}}function Lo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){Lo(e,t,r[t])})}return e}function No(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function Do(e){var t;return e.provider?e.provider:null===(t=e.openAI)||void 0===t?void 0:t.provider}const Mo=e=>({colorWeak:jn.css`
    color: ${e.colors.text.secondary};
  `,marginTop:jn.css`
    margin-top: ${e.spacing(3)};
  `,inlineFieldWidth:15,inlineFieldInputWidth:40}),zo=(Uo=jo(function*(e,t=!1,r){const a={jsonData:r.jsonData,secureJsonData:r.secureJsonData};!0===t&&(yield(e=>{const t=(0,V.getBackendSrv)().fetch({url:"/api/plugins/grafana-llm-app/resources/save-plugin-settings",method:"POST",data:e});return(0,vn.lastValueFrom)(t)})(a).then(e=>{if(!e.ok)throw e.data})),yield((e,t)=>{const r=(0,V.getBackendSrv)().fetch({url:`/api/plugins/${e}/settings`,method:"POST",data:t});return(0,vn.lastValueFrom)(r)})(e,r).then(e=>{if(!e.ok)throw e.data})}),function(e){return Uo.apply(this,arguments)});var Uo;function qo(e){return Vo.apply(this,arguments)}function Vo(){return(Vo=jo(function*(e){return(0,vn.lastValueFrom)((0,V.getBackendSrv)().fetch({url:"api/plugins/grafana-llm-app/resources/grafana-llm-state",method:"POST",data:{allowed:e}})).then(e=>{if(!e.ok)throw e.data})})).apply(this,arguments)}function Zo(){return(Zo=jo(function*(){return(0,vn.lastValueFrom)((0,V.getBackendSrv)().fetch({url:"api/plugins/grafana-llm-app/resources/grafana-llm-state",method:"GET"})).then(e=>{var t,r,a;if(!e.ok||"success"!==(null===(t=e.data)||void 0===t?void 0:t.status))throw e.data;return null!==(a=null===(r=e.data.data)||void 0===r?void 0:r.allowed)&&void 0!==a&&a})})).apply(this,arguments)}const Ho=(new e.AppPlugin).setRootPage(function(){const e=(t=(0,In.useTheme2)(),{container:jn.css`
    display: flex;
    flex-direction: column;
    gap: ${t.spacing(4)};
    padding: ${t.spacing(2)};
    max-width: 1200px;
    margin: 0 auto;
  `,header:jn.css`
    text-align: center;
    margin-bottom: ${t.spacing(3)};
  `,title:jn.css`
    font-size: ${t.typography.h1.fontSize};
    font-weight: ${t.typography.h1.fontWeight};
    color: ${t.colors.text.primary};
    margin: 0 0 ${t.spacing(1)} 0;
  `,subtitle:jn.css`
    font-size: ${t.typography.h4.fontSize};
    color: ${t.colors.text.secondary};
    margin: 0;
    font-weight: normal;
  `,sectionsContainer:jn.css`
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: ${t.spacing(4)};

    @media (max-width: 768px) {
      grid-template-columns: 1fr;
    }
  `,section:jn.css`
    background: ${t.colors.background.secondary};
    border-radius: ${t.shape.radius.default};
    border: 1px solid ${t.colors.border.medium};
    padding: ${t.spacing(3)};
    overflow: hidden;
  `,sectionTitle:jn.css`
    font-size: ${t.typography.h3.fontSize};
    font-weight: ${t.typography.h3.fontWeight};
    color: ${t.colors.text.primary};
    margin: 0 0 ${t.spacing(2)} 0;
    padding-bottom: ${t.spacing(1)};
    border-bottom: 1px solid ${t.colors.border.weak};
  `,sectionContent:jn.css`
    // Remove default margins from child components
    h1,
    h2 {
      margin-top: 0;
      font-size: ${t.typography.h4.fontSize};
    }

    pre {
      max-height: 300px;
      overflow-y: auto;
      background: ${t.colors.background.primary};
      border: 1px solid ${t.colors.border.weak};
      border-radius: ${t.shape.radius.default};
      padding: ${t.spacing(2)};
      font-size: ${t.typography.bodySmall.fontSize};
    }

    ul {
      margin: 0;
      padding-left: ${t.spacing(3)};
    }

    li {
      margin-bottom: ${t.spacing(.5)};
      line-height: 1.5;
    }
  `,fullWidthSection:jn.css`
    grid-column: 1 / -1;
    background: ${t.colors.background.secondary};
    border-radius: ${t.shape.radius.default};
    border: 1px solid ${t.colors.border.medium};
    padding: ${t.spacing(3)};
    margin-top: ${t.spacing(2)};
  `,infoBox:jn.css`
    background: ${t.colors.info.transparent};
    border: 1px solid ${t.colors.info.border};
    border-radius: ${t.shape.radius.default};
    padding: ${t.spacing(2)};
    margin-bottom: ${t.spacing(3)};
    color: ${t.colors.info.text};
    font-size: ${t.typography.bodySmall.fontSize};
    line-height: 1.4;
  `});var t;return r().createElement(V.PluginPage,null,r().createElement("div",{"data-testid":P,className:e.container},r().createElement("header",{className:e.header},r().createElement("h1",{className:e.title},"Grafana LLM"),r().createElement("p",{className:e.subtitle},"Large Language Model integration with Model Context Protocol support")),r().createElement("div",{className:e.infoBox},r().createElement("strong",null,"About this plugin:")," This plugin provides LLM capabilities to Grafana through OpenAI-compatible APIs and extends functionality with Model Context Protocol (MCP) tools for enhanced AI workflows."),r().createElement("div",{className:e.sectionsContainer},r().createElement("section",{className:e.section},r().createElement("h2",{className:e.sectionTitle},"Language Models"),r().createElement("div",{className:e.sectionContent},r().createElement(Z,null))),r().createElement("section",{className:e.section},r().createElement("h2",{className:e.sectionTitle},"MCP Tools"),r().createElement("div",{className:e.sectionContent},r().createElement(Tn,null)))),r().createElement("section",{className:e.fullWidthSection},r().createElement("h2",{className:e.sectionTitle},"Getting Started"),r().createElement("div",{className:e.sectionContent},r().createElement("p",null,r().createElement("strong",null,"Models:")," View and manage available language models configured for this Grafana instance. Models are provided through the configured LLM provider (OpenAI, Anthropic, or custom)."),r().createElement("p",null,r().createElement("strong",null,"MCP Tools:")," Model Context Protocol tools extend LLM capabilities with access to Grafana data sources, dashboards, alerts, and other contextual information. These tools can be used by AI assistants to provide more relevant and data-driven responses.")))))}).addConfigPage({title:"Configuration",icon:"cog",body:({plugin:e})=>{const n=(0,In.useStyles2)(Mo),{enabled:s,pinned:o,jsonData:i,secureJsonFields:l}=e.meta,[c,u]=(0,t.useState)(null!=i?i:{}),[d,p]=(0,t.useState)({}),[h,m]=(0,t.useState)(function(e){var t,r,a,n,s;return{openAIKey:null!==(t=e.openAIKey)&&void 0!==t&&t,anthropicKey:null!==(r=e.anthropicKey)&&void 0!==r&&r,vectorEmbedderBasicAuthPassword:null!==(a=e.vectorEmbedderBasicAuthPassword)&&void 0!==a&&a,vectorStoreBasicAuthPassword:null!==(n=e.vectorStoreBasicAuthPassword)&&void 0!==n&&n,qdrantApiKey:null!==(s=e.qdrantApiKey)&&void 0!==s&&s}}(null!=l?l:{})),[f,v]=(0,t.useState)(!1),[g,y]=(0,t.useState)(!1),[_,E]=(0,t.useState)(!1),[w,P]=(0,t.useState)(void 0),x=(()=>{if("grafana"===(null==c?void 0:c.provider)&&!g)return'You must click the "I Accept" checkbox to use OpenAI provided by Grafana'})();(0,t.useEffect)(()=>{const e=(t=jo(function*(){const e=yield function(){return Zo.apply(this,arguments)}();y(e)}),function(){return t.apply(this,arguments)});var t;!0===c.enableGrafanaManagedLLM&&e()},[c.enableGrafanaManagedLLM]);const S=()=>{v(!0),P(void 0)},O=(k=jo(function*(){if(void 0!==x)return;E(!0),P(void 0);const t=Fo({},e.meta.jsonData);let r;const a={};for(r in h)h[r]||(a[r]=d[r]);const n=No(Fo({},c),{provider:Do(c)});try{let r;yield zo(e.meta.id,c.enableGrafanaManagedLLM,{enabled:s,pinned:o,jsonData:n,secureJsonData:a});const l=Do(c);var i;if(void 0!==l&&(r=(yield(e=>{const t=(0,V.getBackendSrv)().fetch({url:`/api/plugins/${e}/health`});return(0,vn.lastValueFrom)(t)})(e.meta.id)).data,"ok"!==(null===(i=r.status)||void 0===i?void 0:i.toLowerCase())))return yield zo(e.meta.id,c.enableGrafanaManagedLLM,{enabled:s,pinned:o,jsonData:t,secureJsonData:{}}),u(t),P(r),void E(!1);P(r),!0===c.enableGrafanaManagedLLM&&(g&&"grafana"!==l?yield qo(!1):yield qo(g)),u(n),E(!1),v(!1)}catch(r){try{yield zo(e.meta.id,c.enableGrafanaManagedLLM,{enabled:s,pinned:o,jsonData:t,secureJsonData:{}}),u(t)}catch(e){console.error("Failed to rollback settings:",e)}throw E(!1),r}}),function(){return k.apply(this,arguments)});var k;return r().createElement("div",{"data-testid":a},r().createElement(yo,{settings:c,onChange:e=>{u(e),S()},secrets:d,secretsSet:h,optIn:g,setOptIn:e=>{y(e),S()},onChangeSecrets:e=>{p(e);for(const t of Object.keys(e))m(No(Fo({},h),{[t]:!1}));S()}}),!0===c.displayVectorStoreOptions&&r().createElement(Co,{settings:c.vector,secrets:d,secretsSet:h,onChange:e=>{u(No(Fo({},c),{vector:e})),S()},onChangeSecrets:e=>{p(e);for(const t of Object.keys(e))m(No(Fo({},h),{[t]:!1}));S()}}),void 0!==x&&r().createElement(In.Alert,{title:x,severity:"error"}),_?r().createElement(In.LoadingPlaceholder,{text:"Running health check..."}):w&&r().createElement(Dn,w),r().createElement("div",{className:n.marginTop},r().createElement(In.Button,{type:"submit","data-testid":b,onClick:O,disabled:!f||_||void 0!==x},"Save & test")))},id:"configuration"})})(),c})());
//# sourceMappingURL=module.js.map